/*! BEGIN LegacyDojoUI */
(function(){"dont use strict";var t={};global.tab=global.tab||{};ss.initAssembly(t,"vqllegacydojoui");var ti=ss.mkType(t,"tab.$0",function(){spiff.Template.call(this,$("<div class='tabHorizontalSlider'>\n<\/div>'"))}),bi=ss.mkType(t,"tab.$1",function(n,t,i,r,u){this.$6=!1;this.$a=0;this.$7=null;this.$8=null;this.$9=null;this.$a=n;this.$6=t;this.$7=i;this.$8=r;this.$9=u},{$5:function(){return this.$a},$0:function(){return this.$6},$1:function(n){this.$6=n},$2:function(){return this.$7},$3:function(){return this.$8},$4:function(){return this.$9}}),o=global.tab.BaseDropdown=ss.mkType(t,"tab.BaseDropdown",function(n,t,i){this.dropdown=null;this.menuNode=null;this.glass=null;this.dropdownLabelContainer=null;this.fillListElement=null;this.searchBox=null;this.currentlySelected=0;this.multimode=!1;this.$l=null;this.$m=!1;s.call(this,n,t,i);this.searchBox=n.get_searchWidget();this.searchBox.setStyle(1);this.$l=n.categoricalSelectionBehavior;var r=ss.mkdel(this,function(){this.hideMenu()});this.searchBox.add_escapeKeyPressed(r);this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.searchBox.remove_escapeKeyPressed(r)})))},{get_scrollNode:function(){var n=null;return ss.isValue(this.menuNode)&&(n=this.menuNode.children(".CFInnerContainer").get(0)),n},instantiate:function(n,t){this.fillListElement=ss.mkdel(this,function(i){this.createListElement(i,n,t)});this.dropdown=$("<span><\/span>").addClass("tabComboBox").addClass("tab-ctrl-formatted-widget").addClass("tab-ctrl-formatted-darker-border-hover").addClass("tab-ctrl-formatted-darker-border-focus").addClass("tabComboStdTheme").addClass("tabComboBoxNoIcon").addClass("tiledContent");this.disposables.add$2([spiff.TableauClickHandler.targetAndClick(this.dropdown[0],ss.mkdel(this,this.onDropdownClicked)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.dropdown[0],ss.mkdel(this,this.onDropdownClicked))]);var i=tab.DomUtil.generateUniqueId();this.dropdown.attr("tabindex","0").attr("role","combobox").attr("aria-haspopup","true").attr("aria-expanded","false").attr("aria-live","polite").attr("aria-describedby",i);tab.MiscUtil.isNullOrEmpty$1(this.parent.get_titleDomId())?this.dropdown.removeAttr("aria-labelledby"):this.dropdown.attr("aria-labelledby",this.parent.get_titleDomId());this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.dropdown.remove()})));this.dropdownLabelContainer=$("<div><\/div>").addClass("tabComboBoxNameContainer").addClass("tab-ctrl-formatted-fixedsize").appendTo(this.dropdown);$("<span><\/span>").addClass("tabComboBoxName").text(this.getLabelText(n)).attr("id",i).attr("aria-hidden","true").appendTo(this.dropdownLabelContainer);$("<div class='tabComboBoxButtonHolder'><span class='tabComboBoxButton'>"+kt.getDropDownForColor(this.parent.get_textStyle().color.toString())+"<\/span><\/div>").appendTo(this.dropdown);this.div.appendChild(this.dropdown.get(0));ss.isValue(this.menuNode)&&(this.menuNode.children(".tiledContent").remove(),this.fillMenu(this.menuNode));this.$e(n.length);EventUtils.GlobalUIEvents.add_DismissTemporaryElements(ss.mkdel(this,this.$b))},updateContent:function(n){var t,i,r;ss.isValue(this.menuNode)&&(BrowserSupport.BrowserSupport.IsIE()&&this.menuNode.css({"box-shadow":"none"}),t=n.length>0?n.join(""):this.searchBox.get_noMatchHtml(),i=this.menuNode.children(".tiledContent"),ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null),i.html(t),this.$k(),this.$m&&(r=this.dropdown.offset(),this.menuNode.css({top:r.top-this.menuNode.outerHeight()+"px"})),BrowserSupport.BrowserSupport.IsIE()&&this.menuNode.css({"box-shadow":"2px 2px 2px #adadad"}))},resetContent:function(n,t){var u=0,f,i,r;(ss.isValue(this.menuNode)&&(f=this.menuNode.children(".tiledContent"),ss.isValue(f)&&(u=f.height(),this.shouldUseAllItem()&&(u-=this.$7()))),i=0,ss.isValue(this.tiledWidget)&&(i=Math.max(0,this.tiledWidget.get_lastScrollTop())),this.fillListElement=ss.mkdel(this,function(r){this.createListElement(r,n,t);this.tiledWidget.fetchWithinScrollRange(i,i+u,ss.mkdel(this,this.$k))}),ss.isValue(this.searchBox)&&this.searchBox.isShowingResults())||(ss.isValue(this.menuNode)&&(this.$j(this.menuNode),r=this.$8(),this.menuNode.css({top:this.$m?r.y-this.dropdown.height()-this.menuNode.outerHeight()-1+"px":r.y+"px",left:r.x+"px"})),this.dropdownLabelContainer.children().text(this.getLabelText(n)),ss.isValue(this.menuNode)&&tab.BrowserViewport.getViewport(ss.mkdel(this,function(n){ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null);ss.isValue(this.menuNode)&&(this.menuNode[0].removeEventListener("focus",this.listItemFocusHandler,!0),this.$3(),this.menuNode.children().remove(),this.$4(n,this.menuNode),this.$k())})),this.$e(n.length),this.$k())},$e:function(n){var t=this.shouldUseAllItem()?1:0;n+t<=5?this.searchBox.hideUI():this.searchBox.showUI$1()},shouldNotReinstantiate:function(){return!1},layout:function(n){this.inherited(arguments);ss.isValue(this.tiledWidget)&&this.tiledWidget.updateViewport(n.w,n.h)},destroy:function(){this.dispose();this.disposeMenu();ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=null;EventUtils.GlobalUIEvents.remove_DismissTemporaryElements(ss.mkdel(this,this.$b))},fetchAllItem:function(){return this.shouldUseAllItem()?this.menuNode.children(".CFInnerContainer").children(".FIItem").get(0):null},fetchChildNodeByIndex:function(n){return ss.isValue(this.tiledWidget)?this.tiledWidget.getElement(n):this.getNonTiledElement(n,ss.isValue(this.menuNode)?this.menuNode.children(".CFInnerContainer").get(0):null)},createListElement:null,getLabelText:function(t){var f=n.isAllOrAllChecked(this.parent),u,r,e;if(this.currentlySelected=-1,this.multimode=!1,u=t.length,u===0)return!f,tab.Strings.QuickFilterAll;for(r=0;r<u;r++)if(t[r].s&&!f){if(this.currentlySelected>-1){this.multimode=!0;break}this.currentlySelected=r}return f&&u>1?tab.Strings.QuickFilterAll:this.multimode?tab.Strings.QuickFilterMultipleValues:this.hasSummaryText()?this.getSummaryText():(e=this.currentlySelected>-1?this.currentlySelected:0,ss.isNullOrUndefined(t[e])?"":i.formatTupleDisplayName(t[e],!0,this.parent.get_oFilter().role))},onDropdownClicked:function(){tab.BrowserViewport.getViewport(ss.mkdel(this,this.$h))},$9:function(n){spiff.EventUtil.stopEvent$2(n)},$h:function(n){var i,t,f;if(!this.$a()){i=document.body;this.removeGlass();this.glass=new spiff.Glass(null,!1);this.glass.add_click(ss.mkdel(this,this.hideMenu));this.glass.set_zIndex(899);this.glass.show();t=this.$8();this.menuNode=$("<div><\/div>").attr("id",this.parent.id+"_menu").addClass("CFOuterContainer").addClass("tabMenuComboDropdownTheme").addClass("tab-ctrl-formatted-widget").attr("role","application").css({position:"absolute",top:t.y+"px",left:t.x+"px","max-height":30*this.get_lineHeight()+"px","z-index":"900",visibility:"hidden"}).appendTo(i);tab.ColorModel.fromColorCode(this.parent.get_blendedZoneContentColor()).isLuminanceAboveThreshold(.314999997615814)||this.menuNode.addClass("tab-darkBackground");nt.applyFormatting(this.menuNode.get(0),this.parent.get_textStyle(),this.parent.get_blendedZoneContentColor(),this.get_lineHeight(),!0);this.searchBox.startupNoAppend();this.$j(this.menuNode);this.$4(n,this.menuNode);this.$k();$(this.menuNode.get(0)).toggleClass("QFDropdownMenuAbove",this.$m);var e=this.menuNode.find(".tile"),r=tab.DomUtil.getIds(e).join(" "),u=this.$5();$(this.searchBox.get_queryBox()).attr("id",u).attr("aria-autocomplete","list").attr("aria-controls",r);f=u+" "+r;this.dropdown.attr("aria-owns",f);this.$f(!0)}},$5:function(){return this.parent.id+"_textbox"},$f:function(n){ss.isValue(this.dropdown)&&this.dropdown.attr("aria-expanded",n.toString())},$k:function(){if(ss.isValue(this.menuNode)){this.updateTabIndexes(this.menuNode[0],!0);$(this.get_scrollNode()).off(o.$1).on(o.$1,ss.mkdel(this,this.$c));this.menuNode.off(o.$1).on(o.$1,ss.mkdel(this,this.$d));spiff.FocusManager.trapFocus(this.menuNode);this.menuNode[0].addEventListener("focus",this.listItemFocusHandler,!0)}},$d:function(n){switch(n.which){case 27:this.hideMenu();break;default:return}n.stopPropagation();n.preventDefault()},removeGlass:function(){ss.isValue(this.glass)&&(this.glass.remove_click(ss.mkdel(this,this.hideMenu)),this.glass.dispose(),this.glass=null)},$3:function(){ss.isValue(this.apply)&&ss.isValue(this.apply.element)&&this.apply.element.detach();ss.isValue(this.cancel)&&ss.isValue(this.apply.element)&&this.cancel.element.detach()},hideMenu:function(){this.searchBox.clearSearch(!1,!1);this.disposeMenu()},disposeMenu:function(){this.$l.clearRangeAnchorAndSelection();this.removeGlass();ss.isValue(this.menuNode)&&(this.menuNode[0].removeEventListener("focus",this.listItemFocusHandler,!0),this.$3(),this.menuNode.remove(),this.menuNode=null,this.focusedId=null,this.dropdown.focus());this.$f(!1);this.dropdown.removeAttr("aria-owns")},$a:function(){return ss.isValue(this.menuNode)||ss.isValue(this.glass)},$8:function(){var n=this.dropdown.offset(),t=tab.DoubleUtil.roundToInt(this.dropdown.outerHeight());return{x:tab.DoubleUtil.roundToInt(n.left),y:tab.DoubleUtil.roundToInt(n.top)+t-1}},$4:function(n,t){ss.isNullOrUndefined(t)||(this.fillMenu(t),this.$m=this.$g(n,t),this.$m?$(this.searchBox.domNode).appendTo(t):$(this.searchBox.domNode).insertBefore(t.children().first()),this.$i(n,t),this.searchBox.get_isVisible()&&this.searchBox.showUI$1(),this.$l.refreshRangeAnchorAndSelection())},$c:function(n){if(n.which!==27)this.parent.onKeyDown(n)},$i:function(n,t){var f=this.dropdown.offset(),w=tab.DoubleUtil.roundToInt(this.dropdown.outerWidth())-2,c=document.body,r=t.find(".tile").eq(0),b=r.css("right"),k=ss.isValue(r[0])?r[0].style.width:"",u,l,e,s;r.css({right:"auto",width:""});u=tab.DoubleUtil.roundToInt(r.width())+20;r.css({right:b});r.css({width:k});u=Math.max(u,w);l=tab.DoubleUtil.roundToInt($(c).width());u=Math.min(u,l);t.width(u);var d=t.offset(),a=tab.DoubleUtil.roundToInt(d.left),g=a+tab.DoubleUtil.roundToInt(t.outerWidth()),v=$(c).find(".dashboardSpacer"),nt=v.offset(),tt=tab.DoubleUtil.roundToInt(nt.left)+tab.DoubleUtil.roundToInt(v.width()),y=g-tt;y>0&&(e=a-y,e=Math.max(e,0),t.css({left:e+"px"}));var it=30*this.get_lineHeight(),rt=3*this.get_lineHeight(),o=n.getVisibleRoom(tab.PointUtil.fromPosition(f),0),i=(this.$m?o.roomAbove:o.roomBelow-2)-20;i=i-parseInt(t.css("border-bottom-width"));i=Math.min(i,it);i=Math.max(i,rt);t.css({"max-height":i+"px"});s=spiff.FullscreenUtil.centeringContainerOffset();this.$m?o.roomAbove>i-1?t.css({top:f.top-s-t.outerHeight()+"px"}):t.css({top:f.top-s-o.roomAbove+"px"}):t.css({top:f.top-s+this.dropdown.outerHeight()+"px"});var ut=ss.isValue(this.searchBox)?this.searchBox.getHeight():0,p=0,h=t.children(".CFInnerContainer");this.parent.shouldDeferChanges()&&ss.isValue(this.apply)&&!this.menuNode.hasClass("CFDropdownNoItems")&&(p=dojo.marginBox(this.apply.element.get(0)).h,this.layoutApplyButton(h));ss.isValue(h)&&(h.css({"max-height":t.get(0).clientHeight-ut-p+"px"}),this.tiledWidget.updateViewport(tab.DoubleUtil.roundToInt(h.height()),0));t.css({visibility:"visible"})},$g:function(n,t){var r=this.dropdown.offset(),u=30*this.get_lineHeight(),i=n.getVisibleRoom(tab.PointUtil.fromPosition(r),0);return Math.min(t.outerHeight(),u)>i.roomBelow&&i.roomAbove>i.roomBelow},fillMenu:function(n){if(!ss.isNullOrUndefined(n)){var t=$("<div><\/div>").addClass("CFInnerContainer").addClass("tab-ctrl-formatted-text");BrowserSupport.BrowserSupport.IsFF()&&t.attr("tabindex","-1");n.append(t);this.fillListElement(t.get(0))}},$j:function(n){this.parent.get_oFilter().all||this.parent.get_oFilter().allNotChecked?n.addClass("CFAll"):n.removeClass("CFAll");this.parent.get_oFilter().exclude?n.addClass("CFExclusive"):n.removeClass("CFExclusive")},$b:function(){this.hideMenu()},$6:function(){return this.menuNode[0].querySelector(".all-item")},$7:function(){var n=this.$6();return ss.isValue(n)?$(n).outerHeight(!0):0},setupEventHandlers:function(){tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_CategoricalFilter")&&this.disposables.add$1(spiff.EventUtil.bindWithDispose(this.dropdown,"contextmenu",ss.mkdel(this,this.$9)))}}),cu=global.tab.BaseLegacyDojoUIModule=ss.mkType(t,"tab.BaseLegacyDojoUIModule",function(){},{createTabbedNavigation:function(n,t){return new tableau.base.widget.TabbedNavigation(n,t)},createPageViewModel:function(n){return new ut(n)},createLegacyQuickFilterDisplayViewModel:function(n,t){return new rt(n,t)},createParameterControlViewModel:function(n){return new ft(n)},createPageView:null,createLegacyQuickFilterDisplayView:null,createParameterControlView:null,createContinuousSliderViewModel:function(n){return new tt(n)},createContinuousSlider:null}),s=global.tab.BaseMode=ss.mkType(t,"tab.BaseMode",function(n,t,i){this.div=null;this.focusedId=null;this.listItemFocusHandler=null;this.parent=null;this.attributes=null;this.pendingManager=null;this.apply=null;this.cancel=null;this.disposables=new tab.DisposableHolder;this.tiledWidget=null;this.$2$1=null;this.$2$2=0;this.$2$3=null;Object.call(this);this.parent=n;this.div=t;this.listItemFocusHandler=ss.mkdel(this,this.$0);this.attributes={};ss.isValue(i)&&(this.attributes=i)},{add_applyOrCancelClicked:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_applyOrCancelClicked:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},get_lineHeight:function(){return this.parent.get_presModel().lineHeight},get_isActiveSearch:function(){return ss.isValue(this.tiledWidget)},get_isTiled:function(){return ss.isValue(this.tiledWidget)&&this.tiledWidget.get_tileCount()>1},get_width:function(){return this.$2$2},set_width:function(n){this.$2$2=n},get_itemFormatter:function(){return this.$2$3},set_itemFormatter:function(n){this.$2$3=n},get_scrollNode:function(){return null},instantiate:function(){},shouldNotReinstantiate:function(){return!1},updateContent:function(){},resetContent:function(){},updateTabIndexes:function(n,t){var u=$(n).find(".FIItem[tabindex=0]"),i;u.attr("tabindex","-1");i=document.getElementById(this.focusedId)||r.findFirstDesirableFocusable(n);ss.isValue(i)&&(i.classList.contains("FIItem")?i.setAttribute("tabindex","0"):$(n).find(".FIItem").first().attr("tabindex","0"),t&&i.focus())},$0:function(n){var t=$(n.target),i=t.closest(".FIItem");i.length>0?(this.focusedId=i[0].id,this.updateTabIndexes(n.currentTarget,!ss.referenceEquals(t[0],i[0]))):t.hasClass("QueryBox")&&(this.focusedId=null)},setUpForPendingChanges:function(){this.parent.shouldDeferChanges()&&(this.pendingManager=this.parent.makePendingChangesManager(),this.pendingManager.add_onPendingChanges(ss.mkdel(this,this.handlePendingChanges)),this.pendingManager.add_onNoPendingChanges(ss.mkdel(this,this.handleNoPendingChanges)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.pendingManager.remove_onPendingChanges(ss.mkdel(this,this.handlePendingChanges));this.pendingManager.remove_onNoPendingChanges(ss.mkdel(this,this.handleNoPendingChanges))}))),this.$1())},$1:function(){this.apply=spiff.LabelButton.newNativeButton();this.apply.addClass("apply");this.apply.set_label(tab.Strings.QuickFilterApply);this.apply.set_hoverTooltipText(tab.Strings.QuickFilterApply);this.apply.onClick(ss.mkdel(this,function(){this.resetPendingVisuals(!1);this.parent.applyPendingChangesByChangelist();this.$2()}));this.disposables.add$1(this.apply);this.cancel=spiff.LabelButton.newNativeButton();this.cancel.addClass("cancel");this.cancel.set_label(tab.Strings.QuickFilterCancel);this.cancel.set_hoverTooltipText(tab.Strings.QuickFilterCancel);this.cancel.onClick(ss.mkdel(this,function(){this.resetPendingVisuals(!0);this.parent.cancelPendingChangesByChangelist();this.$2()}));this.disposables.add$1(this.cancel);var n=ss.mkdel(this,function(){this.updateTabIndexes(this.div,!0)});this.add_applyOrCancelClicked(n);this.disposables.add(ss.mkdel(this,function(){this.remove_applyOrCancelClicked(n)}));this.initApplyAndCancelButtonStates()},initApplyAndCancelButtonStates:function(){this.apply.set_disabled(!0);this.cancel.set_disabled(!0)},appendApplyCancelButtons:function(n){var t=n.children(".CFApplyButtonContainer").first();this.parent.get_filterTable().actual_size>0&&this.parent.shouldDeferChanges()?(t.length<1&&(t=$("<div><\/div>").addClass("CFApplyButtonContainer"),n.append(t)),(ss.isNullOrUndefined(this.cancel)||ss.isNullOrUndefined(this.apply))&&this.setUpForPendingChanges(),t.append(this.cancel.element).append(this.apply.element).height(this.apply.element.outerHeight(!0)+"px")):t.detach()},layoutApplyButton:function(n){if(ss.isValue(n)){var r=tab.DoubleUtil.roundToInt(n.width()),u=parseInt(this.apply.element.css("margin-right")),t=Math.floor(r/2-u),i="max-width";this.apply.element.css(i,t+"px");this.cancel.element.css(i,t+"px")}},handlePendingChanges:function(){this.apply.set_disabled(!1);this.cancel.set_disabled(!1)},handleNoPendingChanges:function(){this.apply.set_disabled(!0);this.cancel.set_disabled(!0)},resetPendingVisuals:function(){},$2:function(){ss.staticEquals(this.$2$1,null)||this.$2$1()},applyChanges:function(){},layout:function(n){tsConfig.is_mobile?(d.setMarginBoxWidth(this.div,n.w),this.div.style.maxHeight=n.h+"px"):dojo.marginBox(this.div,n)},fetchChildNodeByIndex:function(t){return ss.isNullOrUndefined(t)||t<0?null:(n.filterItem.isAllItem(this.div.firstChild)&&(t+=1),this.div.childNodes[t])},fetchAllItem:function(){return this.div.childNodes[0]},getNonTiledElement:function(t,i){var u,r,f;if(tab.FeatureFlags.isEnabled("WebCategoricalSelectionSearchResults")&&t>=0&&ss.isValue(i))for(u=i.children,r=0,f=u.length;r<f;r++)if(n.filterItem.getIndex(u[r])===t)return u[r];return null},shouldUseAllItem:function(){return this.attributes["show-all"]!=="false"},countIfAll:function(n){for(var i=this.parent.get_mode()==="checklist"?1:0,t=0;t<n.length;t++)n[t].s&&(i+=1);return i===n.length},getSummaryText:function(){return this.hasSummaryText()?this.parent.get_oFilter().summary:""},formatTuple:function(n){return i.formatTupleDisplayName(n,!0,this.parent.get_oFilter().role)},onSmallSearchUI:function(){},hasSummaryText:function(){var t=this.parent.get_mode()==="slider",i=this.parent.get_mode()==="dropdown"||this.parent.get_mode()==="checkdropdown",n=this.parent.get_oFilter().summary,r=!ss.referenceEquals(n,tab.Strings.QuickFilterAll);return ss.isValue(n)&&(t||i&&r)},applyChangesByChangelist:function(n,t){var e=ss.coalesce(this.attributes.values,""),s=[],h=[],c=[],o="filter-delta",i,r,u,f,l;if(t==="checklist"||t==="checkdropdown"||t==="typeinlist"){for(i=n.compileForChecklist(e),e==="relevant"&&ss.isValue(this.apply)&&this.apply.get_disabled()!==!0&&this.pendingManager.isDeSelectAll(!0)&&(o="filter-replace"),u=0;u<i.select.length;u++)r=i.select[u],s.push(r);if(o==="filter-delta")for(f=0;f<i.deselect.length;f++)r=i.deselect[f],h.push(r);tab.FilterClientCommands.modifyCategoricalFilterValuesByIndices(new tab.CancelDialog(null,null,null,!0),this.parent.get_session().get_visualId(),this.parent.get_identifier(),s,h,o)}else t==="radiolist"&&(l=n.compileForRadiolist(e),c.push(l.index),tab.FilterClientCommands.setCategoricalFilterValuesByIndex(new tab.CancelDialog(null,null,null,!0),this.parent.get_session().get_visualId(),this.parent.get_identifier(),c))},setupEventHandlers:function(){},destroy:null,dispose:function(){this.disposables.dispose()}}),ii=global.tab.CategoricalSelection=ss.mkType(t,"tab.CategoricalSelection",function(n){this.$3=null;this._anchorIndex=-1;this._selectedIndexes=[];this._lastRangeSelectionIndex=-1;this.changelist=null;this._applyTimer=null;this.$3=n},{get_selectedIndexes:function(){return this._selectedIndexes},clearRangeAnchor:function(){var t,i;this._anchorIndex>=0&&(t=this.$3.fetchChildNodeByIndex(this._anchorIndex),!t||(i=n.filterItem.getCssNode(t),!i||this._deselectItem(this._anchorIndex)));this._anchorIndex=this._lastRangeSelectionIndex=-1},clearRangeAnchorAndSelection:function(){this.clearRangeAnchor();this._clearSelection()},refreshRangeAnchorAndSelection:function(){var i,n,t,r;for(this._anchorIndex>=0&&(i=this.$3.fetchChildNodeByIndex(this._anchorIndex),!!i||(this._anchorIndex=-1)),n=this._selectedIndexes.length-1;n>=0;--n)t=this._selectedIndexes[n],r=this.$3.fetchChildNodeByIndex(t),r?this._selectItem(t):this._selectedIndexes.splice(n,1)},onListItemClick:function(t){var i=n.filterItem.getNodeFromEvent(t),f,r,u;!i||(f=$(t.target).is("input[type=checkbox]"),r=$(t.target).is("input[type=radio]"),r&&(t.target.checked=!0),(f||r)&&(n.filterItem.syncCssToCheckState(i),this.$3.handleItemClick(i)),u=n.filterItem.getIndex(i),ss.isNullOrUndefined(u)||u<0)||n.filterItem.isTypeInListItem(i)||this.$1(t,u,f||r)},onListItemRightClick:function(t){var r=n.filterItem.getNodeFromEvent(t),i;ss.isNullOrUndefined(r)||(i=n.filterItem.getIndex(r),i<0)||this.handleSelection(t,i,!1)},$1:function(n,t,i){!!this.changelist||(this.changelist=new st);i?this.$0(n,t):this.handleSelection(n,t,!1)},$0:function(t,i){var h=n.filterItem.getNodeFromEvent(t),e,r,o,s,u,c,l,a,f,v;if(tab.ApplicationModel.get_instance().get_isLocalRenderMode()&&!this.$3.shouldDeferChanges()&&this.$3.get_quickFilter().get_identifier().get_membershipTarget()==="filter"&&(e=[],r=this.$3.get_filterTable(),!!r&&r.actual_size===r.tuples.length)){for(o=r.tuples,s=this._getCheckedIndexes(o,h,this.changelist),u=0,c=s.length;u<c;u++)l=s[u],a=n.getAliasForTuple(o[l]),e.push(a);f=this.$3.get_quickFilter();v=new tab.LegacyCategoricalQuickFilterData(f.get_oFilter().targetSheets,f.get_identifier(),f.get_oFilter().exclude,e);tab.FilterClientCommands.updateCategoricalFilter(v)}this.handleSelection(t,i,!0);this.$2(h,t,i);this.$3.shouldDeferChanges()?(this.$3.applyChangesByChangelist(this.changelist),this.changelist.reset()):this.notifyChange(this.getDoChangeFunc())},$2:function(t,i,r){var f=new lt,e=n.filterItem.isChecked(t),u,o;if(this._selectedIndexes.indexOf(r)===-1){f.setSingle(r,e);this.changelist.addChange(f);return}for(u=0,o=this._selectedIndexes.length;u<o;u++)t=this.$3.fetchChildNodeByIndex(this._selectedIndexes[u]),!t||(this._selectedIndexes[u]!==r&&this.$3.handleClickIfPending(t),n.filterItem.setChecked(t,e)),f=new lt,f.setSingle(this._selectedIndexes[u],e),this.changelist.addChange(f)},handleSelection:function(n,t,i){n.shiftKey&&this._anchorIndex>=0?this._selectRangeFromAnchor(t):(BrowserSupport.BrowserSupport.IsMac()?n.metaKey:n.ctrlKey)&&!this.$3.isSingleSelect()?(this._toggleItemSelection(t),this._updateRangeAnchor(t)):!i&&this._selectedIndexes.length===1&&this._anchorIndex===t&&this._anchorIndex>=0?this._toggleItemSelection(t):(i&&this._selectedIndexes.indexOf(t)!==-1||this._clearSelection(),this._updateRangeAnchor(t),this._selectItem(t))},handleSimpleSelection:function(n,t){n.shiftKey&&this._anchorIndex>=0?this._selectRangeFromAnchor(t):(this._clearSelection(),this._updateRangeAnchor(t),this._selectItem(t))},getDoChangeFunc:function(){return ss.mkdel(this,function(){this.$3.applyChangesByChangelist(this.changelist);this.changelist.reset()})},notifyChange:function(n){this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);this.$3.updateStateIfNeeded();this._applyTimer=tab.WindowHelper.setTimeout(n,this.$3.get_applyDelay())},cancelPendingChange:function(){tab.MiscUtil.clearTimeout(this._applyTimer);this._applyTimer=null},_getCheckedIndexes:function(t,i,r){var f=[],e=this.$3.get_quickFilter(),o=e.get_mode()==="checklist"||e.get_mode()==="checkdropdown",a=o||e.get_mode()==="radiolist"||e.get_mode()==="dropdown",s=null,u,c,h,l;for(o&&(s=r.compileForChecklist(null)),u=0,c=t.length;u<c;u++)h=this.$3.fetchChildNodeByIndex(u),h?n.filterItem.isChecked(h)&&f.push(u):a&&(l=t[u].s,n.filterItem.getIndex(i)===u?n.filterItem.isChecked(i)&&f.push(u):o&&(ss.contains(s.select,u)?f.push(u):!ss.contains(s.deselect,u)&&l&&f.push(u)));return f},forEachSelected:function(n){var t,r,i,u;if(!ss.isNullOrUndefined(n)&&typeof n=="function")for(t=0,r=this._selectedIndexes.length;t<r;t++)i=this._selectedIndexes[t],u=this.$3.fetchChildNodeByIndex(i),n(i,u)},_selectRangeFromAnchor:function(n){for(var r,t=this._anchorIndex,u,f,e=this._lastRangeSelectionIndex>=0?this._lastRangeSelectionIndex:t,o=Math.min(t,n),s=Math.max(t,n),i=n;i<=Math.min(t,e);i++)this._selectItem(i);for(u=e;u<o;u++)this._deselectItem(u);for(r=Math.max(t,e);r<=n;r++)this._selectItem(r);for(f=s+1;f<=e;f++)this._deselectItem(f);this._lastRangeSelectionIndex=n},_toggleItemSelection:function(t){var i=this.$3.fetchChildNodeByIndex(t);n.filterItem.isSelected(i)?this._deselectItem(t):this._selectItem(t)},_selectItem:function(t){var r=this.$3.fetchChildNodeByIndex(t),i;ss.isNullOrUndefined(r)||(n.filterItem.setSelected(r,!0),i=tableau.util.binarySearch(ss.Int32).call(null,t,this._selectedIndexes),i.found||this._selectedIndexes.splice(i.index,0,t))},_deselectItem:function(t){var r=this.$3.fetchChildNodeByIndex(t),i;n.filterItem.setSelected(r,!1);i=tableau.util.binarySearch(ss.Int32).call(null,t,this._selectedIndexes);i.found&&this._selectedIndexes.splice(i.index,1)},_clearSelection:function(){for(var n=this._selectedIndexes.length-1;n>=0;--n)this._deselectItem(this._selectedIndexes[n]);this._selectedIndexes=[]},reselectValidFilterItems:function(){for(var t,n=this._selectedIndexes.length-1;n>=0;n--)t=this.$3.fetchChildNodeByIndex(this._selectedIndexes[n]),ss.isValue(t)?this._selectItem(this._selectedIndexes[n]):this._deselectItem(this._selectedIndexes[n])},_updateRangeAnchor:function(n){if(!this.$3.isSingleSelect()&&(this._lastRangeSelectionIndex=-1,this._anchorIndex!==n||!(n>=0))){var t;this._anchorIndex=n;t=this.$3.fetchChildNodeByIndex(n);!!t||(this._anchorIndex=-1)}},isSelected:function(t){var i=t.classList.contains("FISelected"),r=this.get_selectedIndexes().indexOf(n.filterItem.getIndex(t))!==-1;return i&&r}}),st=global.tab.Changelist=ss.mkType(t,"tab.Changelist",function(){this.$0=null;this.$0=[]},{addChange:function(n){this.$0.push(n)},compileForChecklist:function(n){for(var t,u,i,f={},e=0;e<this.$0.length;++e){t=this.$0[e];switch(t.type){case 0:f[t.index]=t.checkState;break;case 1:var r=t.range,a=t.checkState,v=Math.min(r.get_from(),r.get_to()),y=Math.max(r.get_from(),r.get_to());for(u=v;u<=y;++u)f[u]=a}}var s=[],h=[],o=new ss.ObjectEnumerator(f);try{while(o.moveNext()){var c=o.current(),l=parseInt(c.key,10),p=c.value;p?s.push(l):h.push(l)}}finally{o.dispose()}return i=new di,i.select=s,i.deselect=h,i.domain=n,i},compileForRadiolist:function(n){var i=this.$0.length-1,r=this.$0[i],t=new gi;return t.index=r.index,t.domain=n,t},reset:function(){ss.clear(this.$0)},appendChangelist:function(n){for(var t=0;t<n.$0.length;t++)this.$0.push(n.$0[t])}}),pu=global.tab.ChangeType=ss.mkEnum(t,"tab.ChangeType",{single:0,range:1}),ki=global.tab.CheckDropdown=ss.mkType(t,"tab.CheckDropdown",function(t,i,r){o.call(this,t,i,r);this.set_itemFormatter(ss.mkdel(n.filterItem,n.filterItem.formatChecklistFilterItemHtml))},{instantiate:function(){this.setUpForPendingChanges();this.inherited(arguments)},fillMenu:function(n){this.inherited(arguments);this.appendApplyCancelButtons(n)},createListElement:function(t,i,r){var u=$(t),f,e;this.shouldUseAllItem()&&i.length>0&&a.addAllItem(u,this.parent,r,a.shouldCheckAllItem(this.parent.get_oFilter(),this.pendingManager),ss.mkdel(n.filterItem,n.filterItem.formatChecklistFilterItemHtml));ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=it.createChecklist(this.parent,i,t,r,this.get_lineHeight());f=spiff.EventUtil.bindWithDispose(u,"click",ss.mkdel(this.parent,this.parent.onListItemClick));this.disposables.add$1(f);e=spiff.EventUtil.bindWithDispose(u,"touchend",ss.mkdel(this.parent,this.parent.onListItemClick));this.disposables.add$1(e);tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_RightClickDropdownItem")&&this.disposables.add$1(spiff.EventUtil.bindWithDispose(u,"contextmenu",ss.mkdel(this.parent,this.parent.onListItemClick)));u.parent().toggleClass("CFDropdownNoItems",i.length===0);i.length===0&&u.text(tab.Strings.QuickFilterNoItems)},$n:function(n){switch(n.which){case 13:case 32:this.parent.onListItemClick(n);break;default:return}n.stopPropagation();n.preventDefault()},resetPendingVisuals:function(t){var u,f,r,i;if(u=ss.isValue(this.searchBox)&&this.searchBox.isShowingResults()?this.menuNode.children(".tiledContent"):this.menuNode.find(".tile"),!ss.isNullOrUndefined(u))for(f=u.children().get(),r=0;r<f.length;r++)i=f[r],n.filterItem.isPending(i)&&(n.filterItem.togglePendingState(i),t&&n.filterItem.setChecked(i,!n.filterItem.isChecked(i)))}}),a=global.tab.Checklist=ss.mkType(t,"tab.Checklist",function(n,t,i){this.checkListContainer=null;this.$3=null;s.call(this,n,t,i);this.set_itemFormatter(a.getFilterItemHtml)},{get_scrollNode:function(){return this.checkListContainer},instantiate:function(n,t){var i,r,u;this.setUpForPendingChanges();this.div.innerHTML="";this.$3=this.parent.get_searchWidget();this.$3.setStyle(2);i=$(this.div);this.$3.startupAndAppendTo(i);this.$3.hideUI();i.addClass("CFOuterContainer");r=$("<div><\/div>").addClass("CFInnerContainer").addClass("tab-ctrl-formatted-text");BrowserSupport.BrowserSupport.IsFF()&&r.attr("tabindex","-1");i.append(r);this.checkListContainer=r.get(0);this.createChecklist(this.get_scrollNode(),n,t);this.div.addEventListener("focus",this.listItemFocusHandler,!0);this.disposables.add(ss.mkdel(this,function(){this.div.removeEventListener("focus",this.listItemFocusHandler,!0)}));this.disposables.add$1(spiff.EventUtil.bindWithDispose($(this.div),"click",ss.mkdel(this.parent,this.parent.onListItemClick)));this.appendApplyCancelButtons($(this.div));u=this.get_scrollNode().querySelector("[role=listbox]");ss.isValue(u)&&u.setAttribute("aria-labelledby",this.parent.get_titleDomId())},resetContent:function(n,t){var i=$(this.get_scrollNode());i.empty();ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null);this.createChecklist(this.get_scrollNode(),n,t);this.appendApplyCancelButtons($(this.div))},updateContent:function(n){var t=$.contains(this.div,document.activeElement),i=n.length>0?n.join(""):this.$3.get_noMatchHtml(),r=$(this.get_scrollNode());ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null);r.html(i);this.updateTabIndexes(this.div,t)},shouldNotReinstantiate:function(){return ss.isValue(this.$3)&&this.$3.isShowingResults()},layout:function(n){this.inherited(arguments);ss.isValue(this.tiledWidget)&&this.tiledWidget.updateViewport(n.w,n.h);var i=ss.isValue(this.$3)&&this.$3.get_isVisible()?dojo.marginBox(this.$3.domNode).h:0,t=0;this.parent.shouldDeferChanges()&&(t=dojo.marginBox(this.apply.element.get(0)).h,this.layoutApplyButton($(this.get_scrollNode())));ss.isValue(this.get_scrollNode())&&(this.get_scrollNode().style.height=this.div.clientHeight-i-t+"px")},destroy:function(){this.dispose();ss.isValue(this.$3)&&this.$3.destroy();ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=null},fetchChildNodeByIndex:function(n){return ss.isValue(this.tiledWidget)?this.tiledWidget.getElement(n):this.getNonTiledElement(n,this.get_scrollNode())},createChecklist:function(t,i,r){this.shouldUseAllItem()&&i.length>0&&a.addAllItem($(t),this.parent,r,a.shouldCheckAllItem(this.parent.get_oFilter(),this.pendingManager),ss.mkdel(n.filterItem,n.filterItem.formatChecklistFilterItemHtml));ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=it.createChecklist(this.parent,i,t,r,this.get_lineHeight())},fetchAllItem:function(){return ss.isValue(this.get_scrollNode())?this.get_scrollNode().firstChild:null},resetPendingVisuals:function(t){var u,f,r,i;if(u=ss.isValue(this.$3)&&this.$3.isShowingResults()?$(this.get_scrollNode()):$(this.get_scrollNode()).find(".tile"),!ss.isNullOrUndefined(u))for(f=u.children().get(),r=0;r<f.length;r++)i=f[r],n.filterItem.isPending(i)&&(n.filterItem.togglePendingState(i),t&&n.filterItem.setChecked(i,!n.filterItem.isChecked(i)))},setupEventHandlers:function(){if(tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_CategoricalFilter")){var n=$(this.get_scrollNode());this.disposables.add$1(spiff.EventUtil.bindWithDispose(n,"contextmenu",ss.mkdel(this.parent,this.parent.handleContextMenuForList)))}}},{addAllItem:function(t,i,r,u,f){var e=n.getAllItemHtml(i,r,u,f),o=t.append($(e).addClass("tab-ctrl-formatted-text").addClass("all-item"));n.filterItem.setChecked(o.children().get(0),u)},shouldCheckAllItem:function(n,t){return ss.isValue(t)&&ss.isValue(t.get_allItemCheckState())?ss.unbox(t.get_allItemCheckState()):n.all||n.allChecked&&!n.exclude||n.allNotChecked&&n.exclude}}),at=global.tab.ChecklistContentFormatter=ss.mkType(t,"tab.ChecklistContentFormatter",function(n,t,i){gt.call(this,n,t,i);this.tileHtml="<div id='{1}' role='listbox' aria-multiselectable='true' class=\"tile tab-ctrl-formatted-text\" style=\"top: {0}px; position: absolute; width: 100%;\">"},{isValid:function(n){var t=ss.safeCast(n,Array);return ss.isValue(t)&&t.length!==0}}),di=global.tab.CompiledChecklistChangelist=ss.mkType(t,"tab.CompiledChecklistChangelist",function(){this.select=null;this.deselect=null;this.domain=null;this.select=[];this.deselect=[]}),gi=global.tab.CompiledRadiolistChangelist=ss.mkType(t,"tab.CompiledRadiolistChangelist",function(){this.index=0;this.domain=null}),nr=global.tab.ContentFetchedEventArgs=ss.mkType(t,"tab.ContentFetchedEventArgs",function(n,t,i){this.$2=0;this.$1=null;this.$0=null;ss.EventArgs.call(this);this.$2=n;this.$1=t;this.$0=i},{get_data:function(){return this.$0},get_tileIndex:function(){return this.$2},get_itemRange:function(){return this.$1}}),ri=global.tab.ContinuousSlider=ss.mkType(t,"tab.ContinuousSlider",function(n){this.viewModel=null;ss.makeGenericType(spiff.BaseView$1,[tt]).call(this,n,new ti);this.viewModel=n;this.get_template().domRoot.addClass(this.viewModel.get_sliderClassName())},{get_widgetNode:function(){return this.element},applyChanges:function(n){this.viewModel.set_sliderCurrentValue(n)},dispose:function(){ss.makeGenericType(spiff.BaseView$1,[tt]).prototype.dispose.call(this);this.viewModel=null},onAddedToDomShim:function(){this.onAddedToDom()}}),tt=global.tab.ContinuousSliderViewModel=ss.mkType(t,"tab.ContinuousSliderViewModel",function(n){this.$4=null;this.$0=0;this.$2=0;this.$3=0;this.$5=0;this.$6="";this.$1=!1;this.$2$1=null;this.$2$2=null;this.$2$3=null;spiff.BaseViewModel.call(this);this.$4=n;this.$0=n.get_currentFraction();this.$4.add_sliderFractionUpdated(ss.mkdel(this,this.currentFractionUpdated));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$4.remove_sliderFractionUpdated(ss.mkdel(this,this.currentFractionUpdated))})));this.$3=200;this.$1=!0},{add_intermediateChange:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_intermediateChange:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},add_sliderValueChange:function(n){this.$2$2=ss.delegateCombine(this.$2$2,n)},remove_sliderValueChange:function(n){this.$2$2=ss.delegateRemove(this.$2$2,n)},add_enabledChanged:function(n){this.$2$3=ss.delegateCombine(this.$2$3,n)},remove_enabledChanged:function(n){this.$2$3=ss.delegateRemove(this.$2$3,n)},get_sliderClassName:function(){return this.$6},set_sliderClassName:function(n){this.$6=n},get_pixelWidth:function(){return this.$3},set_pixelWidth:function(n){this.$3=n},get_ruleTickCount:function(){return this.$5},set_ruleTickCount:function(n){this.$5=n},get_currentFraction:function(){return this.$0},set_currentFraction:function(n){this.$0=n;this.$2$2(this.$0)},get_sliderIntermediateValue:function(){return this.$2*1e3},get_sliderCurrentValue:function(){return this.get_currentFraction()*1e3},set_sliderCurrentValue:function(n){this.currentFractionUpdated(n/1e3)},get_sliderMinimumValue:function(){return 0},get_sliderMaximumValue:function(){return 1e3},get_rangeModel:function(){return this.$4},get_enabled:function(){return this.$1},set_enabled:function(n){this.$1!==n&&(this.$1=n,this.raiseActionEvent(this.$2$3))},applyIntermediateChange:function(n){this.$2=n/1e3;ss.isValue(this.$2$1)&&this.$2$1(this.$2)},currentFractionUpdated:function(n){var i=tab.DoubleUtil.truncateTwoDecimalPlaces(this.$0),t=tab.DoubleUtil.truncateTwoDecimalPlaces(n);i!==t&&this.set_currentFraction(t)}}),ui=global.tab.CurrentPagePanel=ss.mkType(t,"tab.CurrentPagePanel",function(){this.baseClass="currentPagePanel";this.templateString="<div dojoAttachPoint='containerNode' baseClass='currentPagePanel'><div><div dojoAttachPoint='_titlePane' style='border:0; overflow:hidden;'><\/div><div dojoAttachEvent='onClick:showMenu' dojoType='dijit.form.Button' class='PageTitleButton' name='type' dojoAttachPoint='_menuButton' style='right: 0; visibility: hidden;'iconClass='wcIconContextMenu' ><\/div> <\/div><div dojoType='dijit.layout.SplitContainer' persist='false' dojoAttachPoint='innerWrapper' orientation='${cpOrientation}' sizerWidth='0' dragRestriction='true' activeSizing='false' style='float:left; overflow: hidden;'><div dojoType='dijit.layout.LayoutContainer' sizeShare='24' sizeMin='24' style='display:${display_dropdown};' dojoAttachPoint='buttonsContainer' ><button dojoAttachEvent='onClick:prevPage' dojoType='dijit.form.Button' layoutAlign='left' style='margin:0; margin-right:2px;' iconClass='dijitIcon cpLeftArrowBlack' showLabel='false' dojoAttachPoint='_leftBtn'><\/button><select dojoAttachEvent='onChange:onSelection' dojoType='tableau.base.widget.ui.iDropDownSelect' dojoAttachPoint='_dropdown' layoutAlign='client' autoWidth='true' minSize='100' hasDownArrow='true' popupExtraClass='${popupClass}'><\/select><button dojoAttachEvent='onClick:nextPage' dojoType='dijit.form.Button' layoutAlign='right' style='clear: left; margin:0; margin-left:2px;' iconClass='dijitIcon cpRightArrowBlack' showLabel='false' dojoAttachPoint='_rightBtn'><\/button><\/div><div dojoType='dijit.layout.ContentPane' sizeShare='24' sizeMin='24' style='display:${display_slider}; padding:6px 0 0 0; border:0; overflow: visible;' dojoAttachPoint='sliderPane'><div dojoAttachEvent='onChange:onSliderChange' dojoType='dijit.form.HorizontalSlider' slideDuration='0'pageIncrement='1' minimum='0' maximum='${maximum}' discreteValues='${discrete_values}' intermediateChanges='false' showButtons='false'dojoAttachPoint='_slider'><\/div><div dojoAttachPoint='_horizontalRuleNode'><\/div><\/div><\/div><div dojoType='dijit.layout.ContentPane' dojoAttachPoint='_playButtonPane' style='padding:0; height:24px; display:${display_toggle}; border:0; position:relative; float:left;overflow:hidden;'><button dojoAttachEvent='onClick:reversePlay' dojoType='dijit.form.Button' layoutAlign='left'  style='float: left; margin:0; margin-left:0px;' iconClass='dijitIcon tab-img-triangle-left-inactive'  showLabel='false' dojoAttachPoint='_reversePlayBtn'><\/button><button dojoAttachEvent='onClick:stopPlay'    dojoType='dijit.form.Button' layoutAlign='left'  style='float: left; margin:0; margin-left:2px;' iconClass='dijitIcon tab-img-square-active' showLabel='false' dojoAttachPoint='_stopPlayBtn'><\/button><button dojoAttachEvent='onClick:forwardPlay' dojoType='dijit.form.Button' layoutAlign='left'  style='float: left; margin:0; margin-left:2px;' iconClass='dijitIcon tab-img-triangle-right-inactive' showLabel='false' dojoAttachPoint='_forwardPlayBtn'><\/button><\/div><div dojoType='dijit.layout.ContentPane' dojoAttachPoint='_checkboxPane' style='padding:0; height:16px; top:2px; display:${display_toggle}; border:0; position:relative; float:left;'><input dojoAttachEvent='onChange:onCheckboxChange' dojoType='dijit.form.CheckBox' dojoAttachPoint='_showHistoryCb'/><\/div><\/div>";this.widgetsInTemplate=!0;this.playState=2;this.sliderPane=null;this.$m=!1;this.$l=-1;this.$i=-1;this.$k=-1;this.show_toggle=!1;this.show_dropdown=!1;this.show_slider=!1;this.sheetid=null;this.session=null;this.lTitle=null;this.titleHtml=null;this.isDashboard=!1;this.pageViewModel=null;this.innerWrapper=null;this.cpHeight=0;this.buttonsContainer=null;this._started=!1;this._slider=null;this._showHistoryCb=null;this._rightBtn=null;this._leftBtn=null;this._horizontalRuleNode=null;this._dropdown=null;this._reversePlayBtn=null;this._stopPlayBtn=null;this._forwardPlayBtn=null;this._playButtonPane=null;this._checkboxPane=null;this.rid=0;this.timestamp=0;this._horizontalRule=null;this.containerNode=null;this.titleSize=null;this.zoneTitleHeight=0;this.zoneTitleWidth=0;this.updating=!1;this._titlePane=null;this._menuButton=null;this.blockContextMenu=!1;this.pages=null;this.current_page=0;this.refreshed=!1;this.enable=!1;this.cpOrientation=null;this.display_dropdown=null;this.display_slider=null;this.display_toggle=null;this.maximum=0;this.discrete_values=0;this.show_ruler=null;this.ruler_count=0;this.popupClass=null;this.requestTimeout=null;this.rebuildLayoutTimeout=null;this.BUTTONS_HEIGHT=26;this.ONLY_BUTTONS=24;this.SLIDER_HEIGHT=22;this.PLAY_SHELF_HEIGHT=30;this.ONLY_SLIDER=16;this.TOGGLE_HEIGHT=16;this.TOGGLE_WIDTH_OFFSET=90;this.RULE_OFFSET=5;this.DOM_OFFSET=4;this.WIDGET_SPACE=8;this.SCROLL_PAGES=14;this.backgroundColor=null;this.$j=new tab.DisposableHolder;Object.call(this);tab.CommandController.add_stopPagesPlayShelf(ss.mkdel(this,this.stopPlay));tab.AnimationUtil.get_clock().add_animationEnded(ss.mkdel(this,this.$0))},{enablePlayShelfIfNotMobile:function(){tsConfig.is_mobile||(this.pageViewModel.get_pageModel().pm.showPagePlayback?(this._playButtonPane.domNode.style.display="block",this._forwardPlayBtn.attr("label",tab.Strings.CurrentPagePanelPlayForward),this._stopPlayBtn.attr("label",tab.Strings.CurrentPagePanelStop),this._reversePlayBtn.attr("label",tab.Strings.CurrentPagePanelPlayReverse)):this._playButtonPane.domNode.style.display="none")},get_showTitle:function(){return ss.isValue(this.lTitle)&&this.lTitle.length!==0},get_shouldLayoutTitleOnSeparateLine:function(){return this.zoneTitleWidth===0},$h:function(){return Math.max(this.pages.length-1,0)},hasNextPage:function(n){return this.pages.length!==0&&n!==this.pages.length-1},getDomNode:function(){return this.domNode},destroyRecursiveShim:function(n){this.destroyRecursive(n)},startupShim:function(){this.startup()},startup:function(){var t,n;this.containerNode=this.domNode;!tab.FeatureFlags.isEnabled("MttwPageTitles")||tsConfig.current_sheet_type!=="worksheet"||tsConfig.is_mobile||tsConfig.is_mobile_app||!tsConfig.is_authoring||(this.containerNode.addEventListener("mouseenter",ss.mkdel(this,this.$c)),this.containerNode.addEventListener("touchenter",ss.mkdel(this,this.$c)),this.containerNode.addEventListener("mouseleave",ss.mkdel(this,this.$6)),this.containerNode.addEventListener("touchleave",ss.mkdel(this,this.$6)),this.$j.add(ss.mkdel(this,function(){this.containerNode.removeEventListener("touchleave",ss.mkdel(this,this.$6));this.containerNode.removeEventListener("mouseenter",ss.mkdel(this,this.$c));this.containerNode.removeEventListener("touchenter",ss.mkdel(this,this.$c));this.containerNode.removeEventListener("mouseleave",ss.mkdel(this,this.$6))})));this.titleSize={w:0,h:0};this.inherited(arguments);this.innerWrapper.startup();this.innerWrapper.domNode.style.overflow="visible";this.buttonsContainer.startup();this.refreshLayout();this.show_toggle&&(t=document.createElement("div"),t.className="fakeCheckBox",ss.isValue(this._showHistoryCb.domNode)&&this._showHistoryCb.domNode.appendChild(t),n=document.createElement("label"),n.innerHTML=tab.EscapingUtil.escapeHtml(tab.Strings.CurrentPagePanelShowHistory),n.style.color=this.pageViewModel.get_pageModel().pm.contrastingTextColor,n.setAttribute("for",this._showHistoryCb.id),ss.isValue(this._checkboxPane.domNode)&&(this._checkboxPane.attr("title",tab.Strings.CurrentPagePanelShowHistory),this._checkboxPane.domNode.appendChild(n)));this._rightBtn.setAttribute("_scroll",!1);this._leftBtn.setAttribute("_scroll",!1);this._slider.setAttribute("_scroll",!1);this._rightBtn.attr("label",tab.Strings.CurrentPagePanelNextPage);this._leftBtn.attr("label",tab.Strings.CurrentPagePanelPreviousPage);this.enablePlayShelfIfNotMobile()},layout:function(){var u=0,s=0,h=0,i,e,r,c,o,l;if(!ss.isNullOrUndefined(this.titleSize)&&(!ss.isValue(this.lTitle)||this.titleSize.w!==0)){var t=dojo.marginBox(this.containerNode),f=t.w-this.DOM_OFFSET,n=0;this.get_showTitle()&&(this.get_shouldLayoutTitleOnSeparateLine()?(this.cpOrientation=t.h-this.titleSize.h<this.getWidgetOffset()?"horizontal":"vertical",s=ss.idiv(this.titleSize.h,2)):(this.cpOrientation=t.h<this.getWidgetOffset()?"horizontal":"vertical",f-=this.titleSize.w,u=this.titleSize.w));this.cpOrientation==="horizontal"?(this.show_toggle&&(f-=this.TOGGLE_WIDTH_OFFSET),n=this.show_dropdown?this.BUTTONS_HEIGHT:this.SLIDER_HEIGHT):(n=this.show_slider?this.SLIDER_HEIGHT:0,n+=this.show_dropdown?this.BUTTONS_HEIGHT:0,h=this.show_toggle?ss.idiv(this.TOGGLE_HEIGHT,2):0);this.innerWrapper.isHorizontal=this.cpOrientation==="horizontal";dojo.marginBox(this.innerWrapper.domNode,ss.mkdict(["w",f,"h",n]));this.innerWrapper.resize();i=dojo.marginBox(this.sliderPane.domNode);ss.isValue(this._horizontalRule)&&i.w>0&&(dojo.marginBox(this._horizontalRule.domNode,ss.mkdict(["w",i.w])),this._horizontalRule.domNode.style.display=this.pages.length*2>i.w?"none":"");e=Math.min(ss.idiv(t.h-n,2)-s-h,3);r=e+2*s;$(this.innerWrapper.domNode).css(ss.mkdict(["top",Math.max(r,0)+"px","position","absolute","left",u+ss.idiv(this.DOM_OFFSET,2)+"px"]));this.cpOrientation==="vertical"?($(this.buttonsContainer.domNode).css(ss.mkdict(["height",this.ONLY_BUTTONS+"px","position","relative","top","","left","","padding","0 0 2px 0"])),this.buttonsContainer.resize(),$(this.sliderPane.domNode).css(ss.mkdict(["height",this.SLIDER_HEIGHT+"px","position","relative","top","","left",""])),$(this._playButtonPane.domNode).css(ss.mkdict(["width",Math.max(t.w-1,0)+"px","position","absolute","top",Math.max(r,0)+n+e+"px","left",u+"px"])),c=this.BUTTONS_HEIGHT,$(this._checkboxPane.domNode).css(ss.mkdict(["width",Math.max(t.w-1,0)+"px","top",Math.max(r,0)+n+e+c+2+"px","position","absolute","left",u+"px"]))):(dojo.marginBox(this.sliderPane.domNode,ss.mkdict(["w",i.w-this.WIDGET_SPACE])),ss.isValue(this._horizontalRule)&&dojo.marginBox(this._horizontalRule.domNode,ss.mkdict(["w",i.w-this.WIDGET_SPACE-this.RULE_OFFSET])),o=dojo.marginBox(this._dropdown.domNode),dojo.marginBox(this._dropdown.domNode,ss.mkdict(["w",o.w-this.WIDGET_SPACE])),dojo.marginBox(this._rightBtn.domNode,ss.mkdict(["l",o.l+o.w-this.WIDGET_SPACE])),$(this.buttonsContainer.domNode).css(ss.mkdict(["height",this.ONLY_BUTTONS+"px","position","","top","","left","","padding","0 0 2px 0"])),this.buttonsContainer.resize(),$(this.sliderPane.domNode).css(ss.mkdict(["height",this.SLIDER_HEIGHT+"px","position","","top","","left",ss.idiv(f+this.DOM_OFFSET,2)+"px"])),$(this._playButtonPane.domNode).css(ss.mkdict(["position","absolute","top",Math.max(r,0)+n+e+"px","left",""])),$(this._checkboxPane.domNode).css(ss.mkdict(["top",Math.max(r,0)+2+"px","position","absolute","left",u+f+ss.idiv(this.DOM_OFFSET,2)+"px"])));l=parseInt($(this._dropdown.domNode).css("width"))-24;dojo.marginBox(this._dropdown.containerNode,ss.mkdict(["w",l]))}},getWidgetOffset:function(){var n=this.show_dropdown?this.BUTTONS_HEIGHT:0;return n+=this.show_slider?this.SLIDER_HEIGHT:0,n+(this.show_toggle?this.TOGGLE_HEIGHT:0)},postMixInProperties:function(){this.display_dropdown=this.show_dropdown?"block":"none";this.display_slider=this.show_slider?"block":"none";this.display_toggle=this.show_toggle?"block":"none";var n=this.pages.length;this.maximum=this.$h();this.discrete_values=n;this.show_ruler=this.show_slider?"block":"none";this.ruler_count=n;this.popupClass=n>this.SCROLL_PAGES?"cpPopupEx":"cpPopup";this.cpOrientation=this.cpHeight<this.getWidgetOffset()?"horizontal":"vertical"},postCreate:function(){this.inherited(arguments);this.timestamp=(new Date).getTime();this.show_dropdown||this.innerWrapper.removeChild(this.buttonsContainer);this.show_slider||this.innerWrapper.removeChild(this.sliderPane);this.show_toggle&&"attr"in this._showHistoryCb&&this._showHistoryCb.attr("checked",this.enable)},$b:function(n){this.$2();this.requestTimeout=window.setTimeout(ss.mkdel(this,function(){this.$3(n)}),500)},$2:function(){this.requestTimeout=tab.MiscUtil.clearTimeout(this.requestTimeout)},$1:function(){this.rebuildLayoutTimeout=tab.MiscUtil.clearTimeout(this.rebuildLayoutTimeout)},$3:function(n){this.$2();this.$k=n;try{ss.isNullOrUndefined(this.pageViewModel.get_visualId())?this.stopPlay():this.isDashboard?tab.PageServerCommands.syncedChangePageNonblocking(this.pageViewModel.get_pageModel(),this.pageViewModel.get_visualId(),this.pageViewModel.get_pageModel().get_zoneModel().get_zoneId(),n):tab.PageServerCommands.changePageNonblocking(n,this.pageViewModel.get_visualId())}catch(t){var i=ss.Exception.wrap(t);tab.ErrorTrace.report(i,!1)}},destroy:function(){this.$2();this.$1();this.inherited(arguments);window.clearInterval(this.$l);tab.AnimationUtil.get_clock().remove_animationEnded(ss.mkdel(this,this.$0));tab.CommandController.remove_stopPagesPlayShelf(ss.mkdel(this,this.stopPlay));this.$j.dispose()},$0:function(){if(this.isStopped()){this.playState=2;return}this.playState===0?this.forwardPlay():this.reversePlay()},updateProperties:function(n){this.sheetid=n.sheetid;this.enable=n.enable;this.show_slider=n.show_slider;this.show_toggle=n.show_toggle;this.show_dropdown=n.show_dropdown;this.current_page=n.current_page;this.pages=n.pages;this.session=n.session;this.lTitle=n.lTitle;this.titleHtml=n.titleHtml;this.zoneTitleHeight=n.zoneTitleHeight;this.zoneTitleWidth=n.zoneTitleWidth;this.isDashboard=n.isDashboard;this.pageViewModel=n.pageViewModel},setTitle:function(){this._titlePane.innerHTML=this.titleHtml;this.setTitleSize()},setTitleSize:function(){var n=dojo.marginBox(this._titlePane);this.get_shouldLayoutTitleOnSeparateLine()?n.w=dojo.marginBox(this.containerNode).w:(n.w=this.zoneTitleWidth,dojo.marginBox(this._titlePane,n));n.h=this.zoneTitleHeight===0&&this.get_showTitle()?dojo.marginBox(this.containerNode).h:this.zoneTitleHeight;this.titleSize=n;$(this._titlePane).parent().css(ss.mkdict(["height",this.titleSize.h+"px"]));this.layout(null);tableau.util.setupTitleEllipsis($(this._titlePane))},refreshLayout:function(){var i,r,u,t,n,f,e;if(this.refreshed=!1,i=!1,r=ss.mkdel(this,function(){this.refreshed=!0;this.refreshWidget(this.current_page)}),this.show_dropdown){if(u=this.pages.length,t=!1,u!==this._dropdown.options.length)t=!0;else for(n=0;n<u;n++)if(f=this._dropdown.options[n].label,!ss.referenceEquals(this.pages[n],f)){t=!0;break}t?(this.$1(),i=!0,this._dropdown.options=[],this.rebuildLayoutTimeout=window.setTimeout(ss.mkdel(this,function(){for(var t=[],n=0,i=this.pages.length;n<i;n++)t.push(ss.mkdict(["label",this.pages[n],"value",n.toString(10),"selected",n===this.current_page]));this._dropdown.addOption(t);this._dropdown.startup();r()}),1),this._dropdown.popupExtraClass=this.pages.length>this.SCROLL_PAGES?"cpPopupEx":"cpPopup"):this._dropdown.setValue(this.current_page)}this.show_slider&&(ss.isValue(this._horizontalRule)&&(this._horizontalRule.destroy(!1),this._horizontalRule=null),this._slider.maximum=this.$h(),this._slider.discreteValues=this.pages.length,dijit.setWaiState(this._slider.focusNode,"valuemax",this.pages.length),this.pages.length<1200&&(e=ss.mkdict(["style","width:100%; height:3px; margin-left:4px; margin-right:4px;","count",this.pages.length]),this._horizontalRule=new dijit.form.HorizontalRule(e,this._horizontalRuleNode),this._horizontalRule.placeAt(this.sliderPane.domNode,2),this._horizontalRule.startup()),this._slider.startup());this._showHistoryCb.attr("value",this.enable);this.setTitle();i||r()},refreshWidget:function(n){var t,i,r;this.updating=!0;this.show_dropdown&&ss.isValue(this._dropdown)&&(this._dropdown.setValue(n),t=!this.hasNextPage(n),i=n===0,this._rightBtn.setAttribute("disabled",t),this._rightBtn.attr("iconClass","dijitIcon cpRightArrow"+(t?"Grey":"Black")),this._leftBtn.setAttribute("disabled",i),this._leftBtn.attr("iconClass","dijitIcon cpLeftArrow"+(i?"Grey":"Black")));this.show_slider&&ss.isValue(this._slider)&&this._slider.setValue(n);"attr"in this._showHistoryCb&&(r=this.pageViewModel.get_isHistoryToggleInteractionDisabled()||this.pages.length===0,this._showHistoryCb.attr("disabled",r));this.updating=!1},$c:function(){this._menuButton.domNode.style.visibility="visible"},$6:function(){this._menuButton.domNode.style.visibility="hidden"},showMenu:function(){if(!this.blockContextMenu){this.blockContextMenu=!0;var n=new tab.GetPageCardMenuCmd;n.c.visualIdPresModel={worksheet:tsConfig.current_sheet_name};n.invoke().done(ss.mkdel(this,function(n){var i=n.commands,t;(tsConfig.is_mobile||tsConfig.is_mobile_app)&&tab.RichTextClientCommands.removeRichTextCommands(i);t=tab.WidgetUtil.menuViewModelFromCommands(i,function(n){tab.WidgetUtil.commandMenuItemClicked(n)},null,null,null);ss.isValue(t)&&t.show(new spiff.ShowMenuOptions($(this._menuButton.domNode),!1))})).always(ss.mkdel(this,function(){this.blockContextMenu=!1}))}},prevPage:function(){tsConfig.is_mobile?this.$a():this.$e(ss.mkdel(this,this.$a))},nextPage:function(){tsConfig.is_mobile?this.$7():this.$e(ss.mkdel(this,this.$7))},$e:function(n){this.playState===1?(window.clearTimeout(this.$l),n(),this.$l=window.setTimeout(ss.mkdel(this,this.$9),400)):this.playState===0?(window.clearTimeout(this.$l),n(),this.$l=window.setTimeout(ss.mkdel(this,this.$8),400)):n()},$7:function(){this.hasNextPage(this.current_page)?(this.$b(this.current_page+1),this.refreshWidget(this.current_page+1)):tsConfig.is_mobile||this.stopPlay()},$a:function(){this.current_page===0?tsConfig.is_mobile||this.stopPlay():(this.$b(this.current_page-1),this.refreshWidget(this.current_page-1))},reversePlay:function(){this.playState=1;this.$m=!0;window.clearInterval(this.$l);this.$l=tab.AnimationUtil.animationIsEnabledFor(this.pageViewModel.get_visualId())?window.setTimeout(ss.mkdel(this,this.$9),400):window.setInterval(ss.mkdel(this,this.$9),400);this.disablePlayControlButtons(!0,!1,!1)},stopPlay:function(){this.playState=2;window.clearInterval(this.$l);this.$i=-1;this.disablePlayControlButtons(!1,!0,!1)},isStopped:function(){return this.$i===-1},forwardPlay:function(){this.playState=0;this.$m=!0;window.clearInterval(this.$l);this.$l=tab.AnimationUtil.animationIsEnabledFor(this.pageViewModel.get_visualId())?window.setTimeout(ss.mkdel(this,this.$8),400):window.setInterval(ss.mkdel(this,this.$8),400);this.disablePlayControlButtons(!1,!1,!0)},disablePlayControlButtons:function(n,t,i){this._reversePlayBtn.setAttribute("disabled",n);this._reversePlayBtn.attr("iconClass","dijitIcon tab-img-triangle-left"+(n?"-active":"-inactive"));this._stopPlayBtn.setAttribute("disabled",t);this._stopPlayBtn.attr("iconClass","dijitIcon tab-img-square"+(t?"-active":"-inactive"));this._forwardPlayBtn.setAttribute("disabled",i);this._forwardPlayBtn.attr("iconClass","dijitIcon tab-img-triangle-right"+(i?"-active":"-inactive"))},$8:function(){tab.AnimationUtil.animationIsEnabledFor(this.pageViewModel.get_visualId())&&window.clearInterval(this.$l);this.$f()?(this.$4(),this.$m=!1):(this.$m||this.$d())&&(this.$i=this.current_page,this.$k=this.$i+1,this.$m=!1,this.$7())},$9:function(){tab.AnimationUtil.animationIsEnabledFor(this.pageViewModel.get_visualId())&&window.clearInterval(this.$l);this.$g()?(this.$5(),this.$m=!1):(this.$m||this.$d())&&(this.$i=this.current_page,this.$k=this.$i-1,this.$m=!1,this.$a())},$d:function(){return this.$k===this.current_page},$g:function(){return this.$m&&this.current_page===0&&!this.$d()},$f:function(){return this.$m&&this.current_page===this.$h()&&!this.$d()},$5:function(){this.$b(this.$h());this.refreshWidget(this.$h());this.$k=this.$h()},$4:function(){this.$b(0);this.refreshWidget(0);this.$k=0},onCheckboxChange:function(){this.refreshed&&(this.enable=!this.enable,tab.PageServerCommands.toggleTrails(this.pageViewModel.get_visualId()))},onSelection:function(n){var t,i;this.updating||(t=parseInt(n.toString()),t=isNaN(t)?0:t,t!==this.current_page&&this._started&&this.refreshed)&&(i=ss.mkdel(this,function(){this.$3(t);this.refreshWidget(t)}),this.$e(i))},onSliderChange:function(n){if(!this.updating){var t=parseInt(n);t!==this.current_page&&this.refreshed&&(this.$b(t),this.refreshWidget(t))}},destroyRecursiveShim$1:function(){this.destroyRecursive()},updatePropertiesShim:function(n){this.updateProperties(n)},refreshLayoutShim:function(){this.refreshLayout()}}),wu=global.tab.CurrentPagePanel$PlayState=ss.mkEnum(t,"tab.CurrentPagePanel$PlayState",{forward:0,reverse:1,stopped:2}),vt=global.tab.DateFilterWidget=ss.mkType(t,"tab.DateFilterWidget",function(){this.firstPeriod=0;this.lastPeriod=0;this.isFutureIncluded=!0;this.periodType=null;this.anchorDateTime=null;this.fy=0;this.startOfWeek=1;this._applyTimer=null;this.domPreview=null;this.textLast=null;this.textCurr=null;this.textNext=null;this.textLastn1=null;this.textLastn2=null;this.textNextn1=null;this.textNextn2=null;this.textTodate=null;this.rangeType=null;this.radioTodate=null;this.rangeN=0;this.UPDATE_DELAY=800;this.inputLastn=null;this.inputNextn=null;this.lowestAllowedDate=new Date(1753,0,1);this.highestAllowedDate=new Date(9999,11,31);h.call(this)},{setRangeType:function(n,t){var i,r,u;switch(n){case"curr":i=0;r=0;u=!0;break;case"todate":i=0;r=0;u=!1;break;case"last":i=-1;r=-1;u=!0;break;case"next":i=1;r=1;u=!0;break;case"lastn":i=1-t;r=0;u=!0;break;case"nextn":i=0;r=t-1;u=!0;break;default:return}this.firstPeriod=i;this.lastPeriod=r;this.isFutureIncluded=u},getRangeType:function(){var i=this.isFutureIncluded,n=this.firstPeriod,t=this.lastPeriod;return n===0&&t===0&&i?"curr":n!==0||t!==0||i?n===-1&&t===-1&&i?"last":n===1&&t===1&&i?"next":n<0&&t===0&&i?"lastn":n===0&&t>0&&i?"nextn":n>0&&t>0&&!i?"invalid":n>t?"invalid":n===t?"other":"othern":"todate"},adjustLastDate:function(n){var t=null;switch(this.periodType){case"year":case"quarter":case"month":case"week":case"day":t=new Date(n.getFullYear(),n.getMonth(),n.getDate());t=new Date(t.getTime()-tab.DateUtil.oneSecond);break;case"hour":case"minute":case"second":t=new Date(n.getTime()-tab.DateUtil.oneSecond)}return t},getPeriods:function(){return this.lastPeriod-this.firstPeriod+1},roundToPeriod:function(n,t,i){var r=n.getMonth(),u=n.getFullYear(),e,f,o,s;switch(this.periodType){case"year":return r<t&&(u-=1),new Date(u,t,1);case"quarter":return r>=t?(e=Math.floor((r-t)/3),r=t+e*3):(e=Math.floor((r+12-t)/3),f=ss.imod(t+e*3,12),f===0&&(f=12),f>r&&--u,r=f),new Date(u,r,1);case"month":return new Date(u,r,1);case"week":return o=ss.imod(7+(1+n.getDay())-i,7),s=new Date(u,r,n.getDate(),12),new Date(s.getTime()-o*tab.DateUtil.oneDay);case"day":return new Date(u,r,n.getDate());case"hour":return new Date(u,r,n.getDate(),n.getHours());case"minute":return new Date(u,r,n.getDate(),n.getHours(),n.getMinutes());case"second":return new Date(u,r,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())}return null},getEffectiveAnchor:function(){return ss.staticEquals(this.anchorDateTime,null)?new Date:this.anchorDateTime},getAnchorPeriod:function(n){return this.roundToPeriod(n,this.fy,this.startOfWeek)},evaluateFirstDate:function(n){return tab.DateUtil.adjustDateByPeriod(n,this.periodType,this.firstPeriod)},evaluateLastDate:function(n,t){var r=tab.DateUtil.adjustDateByPeriod(t,this.periodType,this.lastPeriod+1),i=this.adjustLastDate(r);return this.isFutureIncluded||(i=new Date(Math.min(n.getTime(),i.getTime()))),i},setPYear:function(){this.setPeriod("year")},setPQuarter:function(){this.setPeriod("quarter")},setPMonth:function(){this.setPeriod("month")},setPWeek:function(){this.setPeriod("week")},setPDay:function(){this.setPeriod("day")},setPHour:function(){this.setPeriod("hour")},setPMinute:function(){this.setPeriod("minute")},setPSecond:function(){this.setPeriod("second")},onTypingLast:function(){this.onTyping(this.inputLastn)},onTypingNext:function(){this.onTyping(this.inputNextn)},setRLast:function(){this.setRange("last")},setRCurr:function(){this.setRange("curr")},setRNext:function(){this.setRange("next")},setRLastn:function(){this.setRange("lastn",parseInt(this.inputLastn.value))},setRNextn:function(){this.setRange("nextn",parseInt(this.inputNextn.value))},setRTodate:function(){this.setRange("todate")},setRange:function(n,t){t=t||0;n!==this.rangeType&&(this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer),this.rangeType=n,this.setRangeType(n,t),this._applyTimer=window.setTimeout(ss.mkdel(this,this.applyChanges),this.UPDATE_DELAY));this.setRangeUI(n,t);this.setPreviewUI()},applyChanges:null,setRangeUI:null,setPeriod:function(n){this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);this.setPeriodUI(n);n!==this.periodType&&(this.periodType=n,this.updateVisibilityOfDayToAnchor(),this.setPreviewUI(),this._applyTimer=window.setTimeout(ss.mkdel(this,this.applyChanges),this.UPDATE_DELAY*2))},updateVisibilityOfDayToAnchor:function(){this.oFilter.noTime&&this.periodType==="day"?(this.radioTodate.style.display="none",this.textTodate.style.display="none",$(this.textTodate).parent().find(".fakeRadio").css("display","none"),this.rangeType==="todate"&&this.setRCurr()):(this.radioTodate.style.display="",this.textTodate.style.display="",$(this.textTodate).parent().find(".fakeRadio").css("display",""))},onTyping:function(n){this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);n.value=n.value.replace(new RegExp("/[^0-9]/g"),"");n.value.length>0&&parseInt(n.value)!==this.oFilter.rangeN&&(this.rangeN=parseInt(n.value),this.rangeType=ss.referenceEquals(n,this.inputLastn)?"lastn":"nextn",this.setRangeType(this.rangeType,this.rangeN),this._applyTimer=window.setTimeout(ss.mkdel(this,this.applyChanges),this.UPDATE_DELAY));this.setPreviewUI()},updateRangeButtons:null,setPeriodUI:function(n){var i,r,t,f,e;this.updateRangeButtons(n);t=ss.staticEquals(this.anchorDateTime,null)?u.get_nonAnchoredDescriptions()[n]:u.get_anchoredDescriptions()[n];this.textLast.innerHTML=t.last;this.textCurr.innerHTML=t.curr;this.textNext.innerHTML=t.next;f=t.lastn.split("%");this.textLastn1.innerHTML=f[0];this.textLastn2.innerHTML=f[1];e=t.nextn.split("%");this.textNextn1.innerHTML=e[0];this.textNextn2.innerHTML=e[1];this.textTodate.innerHTML=t.todate;i=parseFloat($(this.textLastn1).css("width"));r=parseFloat($(this.textNextn1).css("width"));i>r?this.textNextn1.style.width=i+"px":i<r&&(this.textLastn1.style.width=r+"px")},$1:function(){var n=null;return ss.isValue(this.oFilter)&&ss.isValue(this.oFilter.default_format)&&(n=this.oFilter.default_format),ss.isValue(n)&&n.length===3?n[0]:"*M/d/yyyy"},$2:function(){var n=null;return ss.isValue(this.oFilter)&&ss.isValue(this.oFilter.default_format)&&(n=this.oFilter.default_format),ss.isValue(n)&&n.length===3?n[1].substr(1):"hh:nn:ss ampm"},setPreviewUI:function(){this.domPreview.innerHTML=this.getPreviewMessage()},getPreviewMessage:function(){var f=this.getEffectiveAnchor(),e=this.$1(),o=this.$2(),i,s=this.getAnchorPeriod(f),n=this.evaluateFirstDate(s),h=e+" "+o,t=this.evaluateLastDate(f,s);if(this.isRangeValid(n,t)){var c=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())),l=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())),a={format:e},r=tableau.format.formatCustomJsDateTime(c,a,0,null),u=tableau.format.formatCustomJsDateTime(l,a,0,null);if(this.periodType==="hour"||this.periodType==="minute"||this.periodType==="second"||this.periodType==="day"&&!this.isFutureIncluded){var v=h,y=ss.referenceEquals(r,u)?o:h,p={format:v},w={format:y};r=tableau.format.formatCustomJsDateTime(c,p,0,null);u=tableau.format.formatCustomJsDateTime(l,w,0,null)}i=tab.Strings.RelDateFilterPreview(r,u)}else i="Invalid relative date",this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);return i},isRangeValid:function(n,t){var i=!0;return isNaN(n.getTime())||isNaN(t.getTime())?i=!1:this.firstPeriod>this.lastPeriod||this.firstPeriod>0&&!this.isFutureIncluded?i=!1:!!n&&!!t?(n<this.lowestAllowedDate||t>this.highestAllowedDate)&&(i=!1):i=!1,i}}),d=global.tab.DojoUtils=ss.mkType(t,"tab.DojoUtils",null,null,{localizeDojoLabeledControls:function(n){for(var r,u,i=n,f=i.length,t=0;t<f;t++)r=i[t].item1,u=i[t].item2,ss.isValue(r)&&r.attr("label",tab.Strings.getString(u))},disableTextSelection:function(n){if(typeof n.onselectstart=="function"){var t=function(n){spiff.EventUtil.stopEvent(n)};n.onselectstart=t}else"MozUserSelect"in n.style&&(n.style.MozUserSelect="none");n.style.cursor="default"},setMarginBoxWidth:function(n,t){dojo.marginBox(n,ss.mkdict(["w",t]))}}),ht=global.tab.DojoWidgets=ss.mkType(t,"tab.DojoWidgets",null,null,{$0:function(){dojo.require("tableau.base.BaseClient");var n=null;n=[dijit._Widget];dojo.declare("tableau.base.widget.LegacyQuickFilterWidget",n,h.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget];dojo.declare("tableau.base.widget.DateFilterWidget",n,vt.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget,dijit._Contained,dijit._Templated];r.prototype.templateString="<div class='CategoricalFilter' role='application'><div class='CategoricalFilterBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='CFButton CFResetButton' showlabel='false'dojoAttachPoint='resetButton'iconClass='wcIconNonfiltered'>Showing all values<\/div><div dojoType='dijit.form.Button' class='CFButton CFSearchButton' showlabel='false'dojoAttachPoint='searchButton'iconClass='wcIconSearch'>Search<\/div><div dojoType='dijit.form.Button' class='CFButton CFDomainButton' showlabel='false'dojoAttachPoint='domainButton'iconClass='wcIconDomainAll'>Show Fewer Values<\/div><div dojoType='dijit.form.Button' iconClass='wcIconContextMenu'class='CFButton CFMenuButton' dojoAttachPoint='menuButton' name='type'><\/div><\/div><div dojoAttachPoint='searchDiv'><\/div><div class='CFContent' dojoAttachPoint='domContent'><\/div><div class='CFHorizScroll' dojoAttachPoint='domHorizScroll' dojoAttachEvent='onscroll:doscrollHoriz'><div dojoAttachPoint='domHorizScrollContent'><\/div><\/div><\/div>";dojo.declare("tableau.base.widget.LegacyCategoricalQuickFilter",n,r.prototype);n=[dijit.layout._LayoutWidget,dijit._Templated];dojo.declare("tableau.base.widget.TabbedNavigation",n,b.prototype);n=[dijit.layout._LayoutWidget,dijit._Templated];dojo.declare("tableau.base.widget.CurrentPagePanel",n,ui.prototype);dojo.declare("tableau.base.widget.catmode.BaseMode",[dijit._Contained],s.prototype);dojo.declare("tableau.base.widget.catmode.Checklist",[tableau.base.widget.catmode.BaseMode],a.prototype);dojo.declare("tableau.base.widget.catmode.BaseDropdown",[tableau.base.widget.catmode.BaseMode],o.prototype);dojo.declare("tableau.base.widget.catmode.SimpleDropdown",[tableau.base.widget.catmode.BaseDropdown],nu.prototype);dojo.declare("tableau.base.widget.catmode.CheckDropdown",[tableau.base.widget.catmode.BaseDropdown],ki.prototype);dojo.declare("tableau.base.widget.catmode.Pattern",[tableau.base.widget.catmode.BaseMode],pr.prototype);dojo.declare("tableau.base.widget.catmode.Slider",[tableau.base.widget.catmode.BaseMode],tu.prototype);dojo.declare("tableau.base.widget.catmode.TypeIn",[tableau.base.widget.catmode.BaseMode],ou.prototype);dojo.declare("tableau.base.widget.catmode.Radiolist",[tableau.base.widget.catmode.BaseMode],br.prototype);dojo.declare("tableau.base.widget.ui.iDropDownSelect",[dojox.form.DropDownSelect],er.prototype);dojo.declare("tableau.base.widget.ui.Slider",[],ot.prototype);dojo.declare("tableau.base.widget.ui.TypeIn",[],l.prototype);dojo.declare("tableau.base.widget.ui.TypeInDateField",[l],k.prototype);dojo.declare("tableau.base.widget.ui.onClickOverride",null,g.prototype);dojo.declare("tableau.base.widget.ui.iMenuItem",[dijit.MenuItem,g],ni.prototype);dojo.declare("tableau.base.widget.ui.iCheckedMenuItem",[dijit.CheckedMenuItem,g],hu.prototype);dojo.declare("tableau.base.widget.hsm.TreeModel",null,eu.prototype);dojo.declare("tableau.base.widget.hsm.Tree",[dijit.Tree],uu.prototype);dojo.declare("tableau.base.widget.hsm._TreeNode",[dijit._TreeNode],fu.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.LegacyHierarchicalQuickFilter",n,e.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.LegacyQuantitativeQuickFilter",n,v.prototype);n=[tableau.base.widget.DateFilterWidget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.LegacyRelativeDateQuickFilter",n,u.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.RelativeDatePickFilter",n,w.prototype);n=[tableau.base.widget.LegacyQuantitativeQuickFilter];dojo.declare("tableau.base.widget.LegacyQuantitativeDateQuickFilter",n,ei.prototype);n=[dijit._Widget,dijit._Templated];li.prototype.templateString="<div class='ParameterControl' role='form'><div class='ParameterControlBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='ParamTitle' dojoAttachPoint='domTitleBar'><\/h3><div class='PCMenuButton' dojoAttachPoint='paramMenuButton'><\/div><\/div><div class='PCContent' dojoAttachPoint='domContent'><\/div><\/div><\/div>";dojo.declare("tableau.base.widget.ParameterControl",n,li.prototype);dojo.declare("tableau.base.widget.paramui.Base",[dijit._Contained],y.prototype);dojo.declare("tableau.base.widget.paramui.TypeIn",[tableau.base.widget.paramui.Base],et.prototype);dojo.declare("tableau.base.widget.paramui.TypeInDateField",[tableau.base.widget.paramui.Base],yr.prototype);dojo.declare("tableau.base.widget.paramui.Compact",[tableau.base.widget.paramui.Base],ar.prototype);dojo.declare("tableau.base.widget.paramui.List",[tableau.base.widget.paramui.Base],vr.prototype);dojo.declare("tableau.base.widget.paramui.Slider",[tableau.base.widget.paramui.Base],dt.prototype);n=[dijit._Widget,dijit._Templated,dijit._Contained];dojo.declare("tableau.base.widget.SearchWidgetBase",n,f.prototype);n=[tableau.base.widget.SearchWidgetBase];wi.prototype.templateString="<div class='Search' role='form'><div class='SearchBox' dojoAttachPoint='domQuerySection'><textarea rows='1' class='QueryBox' spellcheck='false'dojoAttachPoint='domQueryBox'dojoAttachEvent='onkeydown:onQueryBoxKeyDown,onpaste:onQueryBoxPaste'><\/textarea><span class='wcSearchX' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><img class='searchBusyImg' title='${CANCEL_SEARCH_TOOLTIP}' src='${busy_gif_url}'dojoAttachPoint='domSearchBusyImg'dojoAttachEvent='onclick:onSearchBusyImgClick'><\/img><span class='wcIconSearch' title='${SEARCH_TOOLTIP}'dojoAttachPoint='domSearchButton'dojoAttachEvent='onclick:onSearchButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><span class='wcIconSearchAdd' title='${ADD_ITEM_CTRL_ENTER}'dojoAttachPoint='domSearchAddButton'dojoAttachEvent='onclick:onSearchAddButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><\/div><div class='SearchResults' dojoAttachPoint='domResults' dojoAttachEvent='onclick:onListItemClick'><\/div><\/div>";dojo.declare("tableau.base.widget.SearchWidget",n,wi.prototype);dojo.declare("tableau.base.widget.SmallSearchWidget",[tableau.base.widget.SearchWidgetBase],iu.prototype);dojo.declare("tableau.base.widget.FilteringSearchWidget",[tableau.base.widget.SearchWidgetBase],yt.prototype);n=[dijit._Widget,dijit._Templated,dijit._Contained];dojo.declare("tableau.base.widget.TypeInFilterContents",n,su.prototype);n=[dijit.layout._LayoutWidget,dijit._Templated];dojo.declare("tableau.base.widget.QuickFilterPanel",n,pi.prototype)}}),tr=global.tab.FetchInfo=ss.mkType(t,"tab.FetchInfo",function(n,t,i){this.$2=0;this.$0=null;this.$1=null;this.$2=n;this.$0=t;this.$1=i},{get_tileIndex:function(){return this.$2},get_range:function(){return this.$0},get_rangeType:function(){return this.$1}}),ir=global.tab.FilterContentFetcher=ss.mkType(t,"tab.FilterContentFetcher",function(n,t,i){this.$4=null;this.$9=null;this.$3=null;this.$7=null;this.$8=null;this.$6=5;this.$5=!1;this.$1$1=null;this.$4=t;this.$9=n;this.$3=i;this.$7=[];this.$8=[]},{add_contentFetched:function(n){this.$1$1=ss.delegateCombine(this.$1$1,n)},remove_contentFetched:function(n){this.$1$1=ss.delegateRemove(this.$1$1,n)},destroy:function(){},fetch:function(n){for(var i,r,t=0;t<n.length;++t)(i=n[t],ss.contains(this.$7,i.get_tileIndex()))||(this.$7.push(i.get_tileIndex()),this.$8.push(i));while(this.$8.length>this.$6)r=this.$8[0],ss.remove(this.$7,r.get_tileIndex()),ss.remove(this.$8,r);this.$2()},isTilePending:function(n){return ss.contains(this.$7,n)},getQueueLength:function(){return this.$8.length},$0:function(n){return ss.mkdel(this,function(){this.$1(n)})},$1:function(n){var t=ss.mkdel(this,function(t){this.$5=!1;ss.remove(this.$7,n.get_tileIndex());var i=new nr(n.get_tileIndex(),n.get_range(),t);ss.staticEquals(this.$1$1,null)||this.$1$1(this,i);this.$2()}),i=ss.mkdel(this,function(){this.$5=!1;ss.clear(this.$7);ss.clear(this.$8)});this.$9.getFilterItems(this.$4,this.$3,n.get_range(),t,i)},$2:function(){var n,t,i;this.$8.length>0&&!this.$5&&(this.$5=!0,n=this.$8.length-1,t=this.$8[n],ss.removeAt(this.$8,n),i=this.$0(t),window.setTimeout(i,0))}}),i=global.tab.FilterFormat=ss.mkType(t,"tab.FilterFormat",null,null,{formatColumnDisplayName:function(n,t,i){var f=n.caption,r,u;return typeof f=="undefined"?(u=n.name,r=t?ss.arrayExtract(u,1).join("."):tableau.format.formatQualifiedName(u)):r=f,i?r:tab.EscapingUtil.escapeHtml(r)},formatTupleDisplayName:function(n,t,r){if(ss.isNullOrUndefined(n))return" ";var u=n.d,f=ss.isValue(u)?u:i.formatTupleUniqueName(n,r),e=t?f:tab.EscapingUtil.escapeHtml(f);return ss.coalesce(e," ")},formatTupleUniqueName:function(n,t){var i="",r,u,f;if(ss.isValue(n)&&(r=n.t,ss.isValue(r)))for(u=0;u<r.length;u++)f=r[u],i.length!==0&&(i+=","),i+=tableau.format.formatDataValue(f,t);return i}}),yt=global.tab.FilteringSearchWidget=ss.mkType(t,"tab.FilteringSearchWidget",function(){this.templateString="<div class='Search FilteringSearch'><div class='SearchBox' dojoAttachPoint='domQuerySection'><textarea rows='1' class='QueryBox' aria-multiline='false' spellcheck='false'dojoAttachPoint='domQueryBox'dojoAttachEvent='onkeydown:onQueryBoxKeyDown,onclick:focusQueryBox,onfocus:focusQueryBox' title='${SEARCH_TOOLTIP}'><\/textarea><span class='wcSearchX' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><span dojoAttachPoint='domScreenReaderStatus' class='sr-only' role='status' aria-live='polite'><\/span><\/div><\/div>";this.domQueryBox=null;this.domSearchButton=null;this.domSearchBusyImg=null;this.domScreenReaderStatus=null;this.$6=100;this.$7=null;this.$8=0;f.call(this)},{get_noMatchHtml:function(){return this.NO_MATCHES},get_queryBox:function(){return this.domQueryBox},get_quickFilter:function(){return this.get_qf()},$5:function(){return this.get_qf()},setStyle:function(n){this.$8=n;var t=$(this.domNode);this.$8===1?(t.addClass("FilteringDropdown"),t.addClass("SearchCleared")):this.$8===2&&t.addClass("FilteringInline")},get_applyDelay:function(){return 0},startupAndAppendTo:function(n){n.append(this.domNode);this.startupNoAppend()},startupNoAppend:function(){this.startup()},layout:function(){},hideUI:function(){this.domNode.style.display="none";f.prototype.hideUI.call(this)},showUI:function(n){f.prototype.showUI.call(this,n)},getHeight:function(){var n=$(this.domNode);return this.get_isVisible()?n.outerHeight(!0):0},focusQueryBox:function(){this.domQueryBox.focus()},getQuery:function(){return this.domQueryBox.value},setQuery:function(n){this.domQueryBox.value=n},onXButtonClick:function(n){this.$8===1?(this.clearSearch(!1,!1),$(this.get_domXButton()).removeClass("Hover")):f.prototype.onXButtonClick.call(this,n)},updateSearch:function(){this.get_isVisible()&&this.searchWithQuery(this.getQuery())},searchWithQuery:function(n){n.length<=0?this.clearSearch(!1,!1):this.get_qf().get_oFilter().isTiled?this.doRemoteSearch(n,!0):this.handleSearchResults(this.doCategoricalSearch(n))},doRemoteSearch:function(n,t){this.doAjaxRemoteSearch(n,this.$6,t,ss.mkdel(this,this.handleSearchResults),ss.mkdel(this,this.$2))},getOnQueryBoxKeyDownBehavior:function(n){var t,i;t=this.inherited(arguments);switch(n.keyCode){case 37:case 39:case 38:t.functionToCall=null;t.stopEvent=!1;break;case 40:i=$(this.domNode.parentElement);i.find(".FIItem").eq(0).focus();tab.FeatureFlags.isEnabled("WebCategoricalSelectionSearchResults")&&this.$3(i.children(".CFInnerContainer").children(".FIItem").get(0));t.functionToCall=null;t.stopEvent=!0;break;case 13:t.stopEvent=!0;t.functionToCall=ss.mkdel(this,this.$1)}return t},clearSearch:function(n,t){$(this.domNode).addClass("SearchCleared");$(this.domScreenReaderStatus).empty();this.resultCount===-1?t||this.focusQueryBox():(f.prototype.clearSearch.call(this,n,t),this.$5().filterBySearchResults(null),this.resultCount=-1)},$3:function(t){var i=0;this.get_quickFilter().hasAllItem()&&(i=-1);this.resultCount!==0&&(this.resultCount>0&&(i=n.filterItem.getIndex(t)),this.get_quickFilter().categoricalSelectionBehavior.handleSimpleSelection(ss.mkdict(["ShiftKey",!1]),i))},handleQueryTextChanged:function(n){var t=500;$(this.domNode).removeClass("SearchCleared");f.prototype.handleQueryTextChanged.call(this,n);switch(this.domQueryBox.value.length){case 1:t=Math.round(t*1.5);break;case 2:t=Math.round(t*1.25)}this.$7=tab.MiscUtil.clearTimeout(this.$7);this.$7=window.setTimeout(ss.mkdel(this,this.updateSearch),t)},$1:function(){this.updateSearch()},handleSearchResults:function(n){ss.isValue(n.length)?this.resultCount=n.length:ss.isValue(n.tuples)&&(this.resultCount=n.tuples.length,n=this.$4(n));this.$5().filterBySearchResults(n);$(this.domScreenReaderStatus).text(this.resultCount>0?tab.Strings.QuickFilterSearchFoundMatches(this.resultCount):tab.Strings.QuickFilterSearchNoMatches)},$4:function(t){for(var f=this.makeUniqueSearchItemIdPrefix(),r=t.tuples,e=t.indices,u=[],i=0;i<r.length;i++)u.push(n.filterItem.getSearchResultHtml(this.get_qf(),r[i],f,e[i]));return u},$2:function(){}}),bu=global.tab.FilteringSearchWidgetStyle=ss.mkEnum(t,"tab.FilteringSearchWidgetStyle",{invalid:0,dropdown:1,inline:2}),ct=global.tab.FilterItemBase=ss.mkType(t,"tab.FilterItemBase",function(){},{getSearchResultHtml:null,formatChecklistFilterItemHtml:null,getCheckHtml:null,formatRadiolistFilterItemHtml:null,getRadioHtml:null,formatDropdownListFilterItemHtml:null,getDropdownHtml:null,getDropdownNoneHtml:null,getTypeInHtml:null,getSelectHtml:function(n,t,i,r){var u=['<option value="',"",'" ',"",">","","<\/option>"];return u[1]=tab.EscapingUtil.escapeHtml(n),u[3]=i&&!r?"SELECTED":"",u[5]=tab.EscapingUtil.escapeHtml(t),u.join("")},getCssNode:null,isPending:null,togglePendingState:null,setChecked:null,isChecked:null,syncCssToCheckState:null,setSelected:null,isSelected:null,isTiled:function(n){var t=n.parentNode;return ss.isValue(t)?$(t).hasClass("tile"):!1},getNodeFromEvent:null,getIndex:null,isTypeInListItem:null,isAllItem:null,getCheckboxOrRadio:function(n){var t=tableau.util.findElementByTagName(n,"input",ss.mkdict(["type","checkbox"]));return ss.isValue(t)?t:tableau.util.findElementByTagName(n,"input",ss.mkdict(["type","radio"]))}}),rr=global.tab.FilterItemDesktop=ss.mkType(t,"tab.FilterItemDesktop",function(){ct.call(this)},{$1:function(n,t,i){var r="FIItem FISimpleDropdownItem"+(i?" FINone":"");return["<div tabindex='-1' role='option' class=\"",r,'" id="',n,'"><div class="facet">',"",'<\/div><div class="facetOverflow"><a title="',t,'">',t===""?"&nbsp;":t,"<\/a><\/div><\/div>"].join("")},getSearchResultHtml:function(n,t,i,r){switch(n.get_mode()){case"checklist":case"checkdropdown":case"typeinlist":return this.formatChecklistFilterItemHtml(n,t,i,r);case"radiolist":return this.formatRadiolistFilterItemHtml(n,t,i,r);case"dropdown":return this.formatDropdownListFilterItemHtml(n,t,i,r)}return""},formatChecklistFilterItemHtml:function(t,r,u,f){var s=n.getItemId(u,f),h=n.shouldCheckFilterItemMultiValue(r,t),c=i.formatTupleDisplayName(r,!0,t.get_oFilter().role),e=t.get_viewModel().get_filterType()==="Hierarchical",l=!e&&ss.isValue(t.get_modeContents().pendingManager)&&t.get_modeContents().pendingManager.isPending(r,f),o=null;return!e&&ss.isValue(t.get_modeContents())&&(o=t.get_modeContents().get_lineHeight()),this.getCheckHtml(s,c,h,l,o)},getCheckHtml:function(n,t,i,r,u){var c=ss.isNullOrUndefined(u)?"":tab.EscapingUtil.escapeHtml("height: "+u+"px;"),e=r?"FIItem FIPending":"FIItem",o=tab.EscapingUtil.escapeHtml(n),s=tab.EscapingUtil.escapeHtml(t),h="",f="";return i&&!r||!i&&r?(f=' aria-checked="true" ',e+=" FIChecked",h=' checked="checked" '):f=' aria-checked="false" ',['<div role="checkbox" tabindex="-1"'+f,' style="'+c,'" class="'+e,'" id="',o,'"><div class="facet">',"",'<\/div><div class="facetOverflow"><input tabindex="-1" type="checkbox" class="FICheckRadio" name="',o,'" ',h,'><div class="fakeCheckBox"><\/div><a class="FIText" title="',s,'">',s,"<\/a><\/div><\/div>"].join("")},formatRadiolistFilterItemHtml:function(t,r,u,f){var o=n.getItemId(u,f),s=n.shouldCheckFilterItemSingleValue(r,t),h=i.formatTupleDisplayName(r,!0,t.get_oFilter().role),c=t.get_viewModel().get_filterType()==="Hierarchical",e=null;return!c&&ss.isValue(t.get_modeContents())&&(e=t.get_modeContents().get_lineHeight()),this.getRadioHtml(o,u,h,s,e)},getRadioHtml:function(n,t,i,r,u){var c=ss.isNullOrUndefined(u)?"":tab.EscapingUtil.escapeHtml("height: "+u+"px;"),f="FIItem",l=tab.EscapingUtil.escapeHtml(n),a=tab.EscapingUtil.escapeHtml(t),e="",o=tab.EscapingUtil.escapeHtml(i),s=' aria-checked="false" ',h=' tabindex ="-1" ';return r&&(s=' aria-checked="true" ',f+=" FIChecked",e=' checked="checked" ',h=' tabindex ="0" '),['<div role="radio"'+h+s,' style="'+c,'" class="'+f,'" id="',l,'"><div class="facet">',"",'<\/div><div class="facetOverflow"><input tabindex="-1" type="radio" class="FICheckRadio" name="',a,'" ',e,'><div class="fakeRadio"><\/div><a class="FIText" title="',o,'">',o,"<\/a><\/div><\/div>"].join("")},formatDropdownListFilterItemHtml:function(t,r,u,f){var e=n.getItemId(u,f),o=i.formatTupleDisplayName(r,!1,t.get_oFilter().role);return this.getDropdownHtml(e,o)},getDropdownNoneHtml:function(n,t){return this.$1(n,t,!0)},getDropdownHtml:function(n,t){return this.$1(n,t,!1)},getTypeInHtml:function(n,t){var i=['<div tabindex="0" class="FIItem FITypeInItem FIChecked" id="',"",'" title="',"",'">',"","<\/div>"];return i[1]=tab.EscapingUtil.escapeHtml(n),i[3]=i[5]=tab.EscapingUtil.escapeHtml(t),i.join("")},getCssNode:function(t){return n.getClassElement(t,"FIItem")},isPending:function(n){var t=this.getCssNode(n);return ss.isValue(t)&&$(t).hasClass("FIPending")},togglePendingState:function(n){var t=this.getCssNode(n);$(t).toggleClass("FIPending")},setChecked:function(n,t,i){var u=this.getCssNode(n),r;return $(u).toggleClass("FIChecked",t).filter("[aria-checked]").attr("aria-checked",t),r=this.getCheckboxOrRadio(n),ss.isValue(r)&&(r.checked=t),ss.isValue(i)&&(i.s=t),$(r).is("input[type=radio]:checked")&&this.$0(u),i},$0:function(n){var t=$(n).siblings(".FIChecked").toArray();t.map(ss.mkdel(this,function(n){return this.setChecked(n,!1)}))},isChecked:function(n){var t=this.getCssNode(n);return ss.isValue(t)&&$(t).hasClass("FIChecked")},syncCssToCheckState:function(n){var t=this.getCheckboxOrRadio(n);ss.isValue(t)&&this.setChecked(n,t.checked,null)},setSelected:function(n,t){var i=this.getCssNode(n);$(i).toggleClass("FISelected",t)},isSelected:function(n){var t=this.getCssNode(n);return ss.isValue(t)&&$(t).hasClass("FISelected")},getNodeFromEvent:function(n){if(ss.isNullOrUndefined(n)||ss.isNullOrUndefined(n.target))return null;for(var t=n.target;ss.isValue(t)&&t.tagName!=="OPTION"&&!$(t).hasClass("FIItem");)t=t.parentNode;return t},getIndex:function(t){return n.getIndexFromId(t.id)},isTypeInListItem:function(n){var t=this.getCssNode(n);return ss.isValue(t)&&$(t).hasClass("FITypeInItem")},isAllItem:function(t){return ss.isNullOrUndefined(t)||this.isTypeInListItem(t)?!1:n.isAllItemId(t.id)}}),pt=global.tab.FilterItemMobile=ss.mkType(t,"tab.FilterItemMobile",function(){ct.call(this)},{$0:function(n,t,i){return['<div class="FIMContainer FIMDropdown'+(i?" FINone":"")+'" id="',n,'"><div class="facet">',"",'<\/div><span class="FIMCheckLabel tab-ctrl-formatted-fixedsize">',t,"<\/span><\/div>"].join("")},getSearchResultHtml:function(n,t,i,r){switch(n.get_mode()){case"checklist":case"checkdropdown":case"typeinlist":return this.formatChecklistFilterItemHtml(n,t,i,r);case"radiolist":return this.formatRadiolistFilterItemHtml(n,t,i,r);case"dropdown":return this.formatDropdownListFilterItemHtml(n,t,i,r)}return""},formatChecklistFilterItemHtml:function(t,r,u,f){var e=n.getItemId(u,f),o=n.shouldCheckFilterItemMultiValue(r,t),s=i.formatTupleDisplayName(r,!1,t.get_oFilter().role),h=ss.isValue(t.get_modeContents().pendingManager)&&t.get_modeContents().pendingManager.isPending(r,f);return this.getCheckHtml(e,s,o,h,null)},getCheckHtml:function(n,t,i,r){var u="",f=r?"FIMPending":"";return(i&&!r||!i&&r)&&(u=" FIMChecked"),['<div class="FIMContainer '+f+' facetOverflow" id="',n,'"><div class="facet">',"",'<\/div><span class="FIMCheckMark',u,'"><\/span><span class="FIMCheckLabel tab-ctrl-formatted-text',u,'">',t,"<\/span><\/div>"].join("")},formatRadiolistFilterItemHtml:function(t,r,u,f){var e=n.getItemId(u,f),o=n.shouldCheckFilterItemSingleValue(r,t),s=i.formatTupleDisplayName(r,!1,t.get_oFilter().role);return this.getRadioHtml(e,null,s,o,null)},getRadioHtml:function(n,t,i,r){var u="";return r&&(u=" FIMRadiolist FIMChecked"),['<div class="FIMContainer facetOverflow" id="',n,'"><div class="facet">',"",'<\/div><span class="FIMCheckMark',u,'"><\/span><span class="FIMCheckLabel tab-ctrl-formatted-text',u,'">',i,"<\/span><\/div>"].join("")},formatDropdownListFilterItemHtml:function(t,r,u,f){var e=n.getItemId(u,f),o=i.formatTupleDisplayName(r,!1,t.get_oFilter().role);return this.getDropdownHtml(e,o)},getDropdownNoneHtml:function(n,t){return this.$0(n,t,!0)},getDropdownHtml:function(n,t){return this.$0(n,t,!1)},getTypeInHtml:function(n,t){return['<div class="FIMContainer FIMTypeIn" id="',n,'"><span class="FIMCheckLabel tab-ctrl-formatted-text">',t,"<\/span><\/div>"].join("")},getCssNode:function(t){return n.getClassElement(t,"FIMContainer")},setChecked:function(n,t,i){var r=$(n).find(".FIMCheckMark"),u=$(n).find(".FIMCheckLabel");return ss.isValue(r)&&ss.isValue(u)&&(t?(r.addClass("FIMChecked"),u.addClass("FIMChecked")):(r.removeClass("FIMChecked"),u.removeClass("FIMChecked"))),ss.isValue(i)&&(i.s=t===!0),i},isChecked:function(n){if(ss.isValue(n)&&$(n).hasClass("FIMContainer")){var t=$(n).find(".FIMCheckMark");return ss.isValue(t)?t.hasClass("FIMChecked"):!1}return!1},isPending:function(n){return ss.isValue(n)?$(n).hasClass("FIMPending"):!1},togglePendingState:function(n){$(n).toggleClass("FIMPending")},syncCssToCheckState:function(n){var t=this.getCheckboxOrRadio(n);ss.isValue(t)&&this.setChecked(n,t.checked)},setSelected:function(n,t){var i=this.getCssNode(n);t?$(i).addClass("FIMSelected"):$(i).removeClass("FIMSelected")},isSelected:function(n){var t=this.getCssNode(n);return $(t).hasClass("FIMSelected")},getNodeFromEvent:function(n){if(ss.isNullOrUndefined(n)||ss.isNullOrUndefined(n.target))return null;for(var t=n.target;ss.isValue(t)&&t.tagName!=="OPTION"&&!$(t).hasClass("FIMContainer");)t=t.parentNode;return t},getIndex:function(t){return n.getIndexFromId(t.id)},isTypeInListItem:function(n){var t=this.getCssNode(n);return $(t).hasClass("FIMTypeIn")},isAllItem:function(t){return this.isTypeInListItem(t)?!1:n.isAllItemId(t.id)}},{formatListRowFilterItemHtml:function(t,r,u,f){var l=n.getItemId(u,f),e=f===n.allItemIndex,o,c;o=e?r.s:t.isSingleSelect()?n.shouldCheckFilterItemSingleValue(r,t):n.shouldCheckFilterItemMultiValue(r,t);var v=i.formatTupleDisplayName(r,!1,t.get_oFilter().role),s=ss.isValue(t.get_modeContents())&&ss.isValue(t.get_modeContents().pendingManager)&&t.get_modeContents().pendingManager.isPending(r,f),h=!1;return e?(c=ss.isValue(t.get_modeContents())?t.get_modeContents().pendingManager:null,h=a.shouldCheckAllItem(t.get_oFilter(),c)):(o&&!s||!o&&s)&&(h=!0),pt.getScrollingListRowHtml(l,v,e,h,!1,s)},getScrollingListRowHtml:function(n,t,i,r,u,f){return['<div class="ListRow',i?" rowAll":"",r?" checked":"",u?" Wide":"",f?" pending":"",'" id="_popup_',n,'">','<div class="facet">',"","<\/div>",'<div class="checkArea">&nbsp;<\/div>','<div class="labelArea" style="margin-left: 28px;">',t,"<\/div><\/div>"].join("")},formatRemovableListRowFilterItemHtml:function(t,r,u,f){var e=n.getItemId(u,f),o=i.formatTupleDisplayName(r,!1,t.get_oFilter().role);return pt.getScrollingListRemovableRowHtml(e,o)},getScrollingListRemovableRowHtml:function(n,t){return['<div class="ListRow" id="_popup_',n,'" style="min-width: 270px; white-space: nowrap;"><div class="wcIconSearchRemoveContainer" style="margin-right:10px"><div class="wcIconSearchRemove" style="margin-right:10px">&nbsp;<\/div><\/div><div class="xRowlabelArea">',t,'<\/div><div style="clear:both;"><\/div><\/div>'].join("")}}),n=global.tab.FilterItemUtil=ss.mkType(t,"tab.FilterItemUtil",null,null,{getBaseItemName:function(n,t){var i=t+"_"+n.get_oFilter().name;return ss.isValue(n.get_session())&&(i+=n.get_session().get_viewId()),i},getAliasForTuple:function(n){return n.d||n.t[0].v},getItemId:function(t,i){return tab.EscapingUtil.escapeHtml(t+"_"+(i===n.allItemIndex?n.$2:i.toString()))},getIndexFromId:function(t){var i=n.$0(t),r=parseInt(i,10);return isNaN(r)?ss.referenceEquals(i,n.$2)?n.allItemIndex:n.unknownItemIndex:r},isAllItemId:function(t){return ss.referenceEquals(n.$0(t),n.$2)},getAllItemTuple:function(t){return{d:n.$2,s:t,t:null}},getAllItemHtml:function(t,i,r,u){return u(t,n.getAllItemTuple(r),i,n.allItemIndex)},isAllOrAllChecked:function(n){return n.get_oFilter().all||n.get_oFilter().allChecked},isAllMode:function(n){return n.get_oFilter().all},addAllItemToTuples:function(n,t){var i=[];return i.push({d:tab.Strings.QuickFilterAll,s:t,t:[{t:"i",v:"",s:null}]}),$.merge(i,n)},shouldCheckFilterItemSingleValue:function(t,i){return t.s&&!(i.get_oFilter().exclude&&n.isAllOrAllChecked(i))},shouldCheckFilterItemMultiValue:function(t,i){return t.s||!i.get_oFilter().exclude&&n.isAllMode(i)},resetPendingFilterItems:function(t,i){for(var r,u=0;u<t.length;u++)r=t[u],n.filterItem.isPending(r)&&(n.filterItem.togglePendingState(r),i&&n.filterItem.setChecked(r,!n.filterItem.isChecked(r)))},toggleClassState:function(n,t){var i=$(n),r=!i.hasClass(t);return i.toggleClass(t,r),r},getClassElement:function(n,t){for(var i=0;ss.isValue(n)&&i<5;i++,n=n.parentNode)if($(n).hasClass(t))return n;return null},$0:function(n){var t=n.split(String.fromCharCode(95));return t[t.length-1]}}),wt=global.tab.FilterListUI=ss.mkType(t,"tab.FilterListUI",function(n,t,i){this.$6=null;this.$4=null;this.$5=null;this.$3=null;this.$1=0;this.$2=0;this.$1$1=null;this.$6=$(n);this.$6.addClass("tiledContent");var r=document.createElement("div");this.$4=$(r);this.$4.css("left","0px");this.$4.css("position","relative");this.$4.css("height",t+"px");this.$4.css("width",this.$6.css("width")+"px");this.$4.addClass("tileContainer");this.$6.append(this.$4);this.$6.scroll(ss.mkdel(this,this.$0));this.$5=new Array(i)},{add_scrolled:function(n){this.$1$1=ss.delegateCombine(this.$1$1,n)},remove_scrolled:function(n){this.$1$1=ss.delegateRemove(this.$1$1,n)},get_windowNode:function(){return this.$6},get_tileContainerNode:function(){return this.$4},get_lastScrollTop:function(){return this.$2},destroy:function(){this.$6.off("scroll");this.$4.remove()},setContent:function(n,t){var i=$(t);i.addClass("hide-tail");this.$4.append(i);this.$5[n]=i;window.setTimeout(function(){i.removeClass("hide-tail")},0)},getTileElement:function(n){return n<0||n>=this.$5.length?null:this.$5[n].get(0)},getItemElement:function(n,t){var r=this.getTileElement(n),i;return ss.isNullOrUndefined(r)?null:(i=r.children,i.length<t||t<0)?null:i[t]},$0:function(){var r=(new Date).getTime(),t=tab.DoubleUtil.roundToInt(this.$6.parent().offset().top)-tab.DoubleUtil.roundToInt(this.$4.offset().top),u=0,f,e,n,i;ss.isValue(this.$3)&&(f=Math.abs(this.$2-t),e=r-this.$1,u=f/Math.min(e,1e3));n=new gr({x:0,y:t});this.$2=t;this.$1=r;this.$3=n;i=ss.mkdel(this,function(){ss.referenceEquals(n,this.$3)&&!ss.isNullOrUndefined(this.$1$1)&&this.$1$1(this,n)});u>wt.$1?window.setTimeout(i,100):i()}}),ur=global.tab.FormattingStyleInfo=ss.mkType(t,"tab.FormattingStyleInfo",function(n,t,i){this.$2=null;this.$0=null;this.$1=null;this.$2=n;this.$0=t;this.$1=i},{get_textStyleModel:function(){return this.$2},get_backgroundColor:function(){return this.$0},get_lineHeight:function(){return this.$1}}),fi=global.tab.ICategoricalSelectionWidget=ss.mkType(t,"tab.ICategoricalSelectionWidget"),fr=global.tab.IContentFetcher=ss.mkType(t,"tab.IContentFetcher"),bt=global.tab.IContentFormatter=ss.mkType(t,"tab.IContentFormatter"),er=global.tab.IDropDownSelect=ss.mkType(t,"tab.IDropDownSelect",function(){Object.call(this);this._stopClickEvents=!1},{_getMenuItemForOption:function(n){if(ss.isNullOrEmptyString(n.value))return new dijit.MenuSeparator;var i=ss.mkdel(this,function(){this._setValueAttr(n)}),t={};return t.option=n,t.label=n.label,t.onClick=i,t.disabled=n.disabled||!1,new tableau.base.widget.ui.iMenuItem(t)}}),lu=global.tab.IMenuItem=ss.mkType(t,"tab.IMenuItem",function(){ni.call(this)}),or=global.tab.ITiledGridModel=ss.mkType(t,"tab.ITiledGridModel"),sr=global.tab.ITiledWidgetUI=ss.mkType(t,"tab.ITiledWidgetUI"),r=global.tab.LegacyCategoricalQuickFilter=ss.mkType(t,"tab.LegacyCategoricalQuickFilter",function(){this.widgetsInTemplate=!0;this.categoricalSelectionBehavior=null;this.getContextMenuCommands=null;this.requestSetAttributes=null;this.session=null;this.field="";this.membershipTarget="filter";this.filterViewModel=null;this.presModel=null;this.attributes={};this.isTypeInList=!1;this.$x=null;this.domContent=null;this.domBox=null;this.searchDiv=null;this.resetButton=null;this.domainButton=null;this.menuButton=null;this.stateId=0;this.singleSelectMenuItem=null;this.multiSelectMenuItem=null;this.inclusiveMenuItem=null;this.exclusiveMenuItem=null;this.getStateID=null;this.mode=null;this.metricsOnly=!1;this.searchButton=null;this.domControls=null;this.width=0;this.modeContents=null;this.domHorizScroll=null;this.showContextMenu=null;this.showDomainMenu=null;this.$4$1=null;this.$4$2=null;this.$4$3=null;h.call(this);this.$x=new tab.DisposableHolder;this.categoricalSelectionBehavior=new ii(this);this.set_titleDomId(tab.DomUtil.generateUniqueId())},{get_domBox:function(){return this.domBox},get_resetButton:function(){return this.resetButton},get_shouldDisableResetButton:function(){return ss.isValue(this.get_oFilter().all)&&this.get_oFilter().all},get_applyDelay:function(){return tsConfig.is_desktop?0:1e3},get_isTypeInList:function(){return this.isTypeInList},get_oFilter:function(){return this.oFilter},get_quickFilterViewModel:function(){return this.filterViewModel},get_viewModel:function(){return this.filterViewModel},get_dijitDeclaredClass:function(){return this.declaredClass},get_mode:function(){return this.mode},set_mode:function(n){this.mode=n},get_session:function(){return this.session},set_session:function(n){this.session=n},get_attributes:function(){return this.attributes},set_attributes:function(n){this.attributes=n},get_field:function(){return this.field},get_identifier:function(){return new tab.QuickFilterIdentifier.$ctor1(this.field,this.membershipTarget)},get_stateId:function(){return this.stateId},set_stateId:function(n){this.stateId=n},get_modeContents:function(){return this.modeContents},get_domContent:function(){return this.domContent},set_DomContent:function(n){this.domContent=n},get_dijitDomNode:function(){return this.domNode},set_DijitDomNode:function(n){this.domNode=n},get_domain:function(){var n=null;return!this.get_attributes().values||(n=this.get_attributes().values),n},get_searchWidget:function(){return this.$4$1},$1:function(n){this.$4$1=n},get_presModel:function(){return this.presModel},get_backgroundColor:function(){return this.backgroundColor},get_blendedZoneContentColor:function(){return this.blendedZoneContentColor},get_textStyle:function(){return this.textStyle},$v:function(){return this.$4$2},$w:function(n){this.$4$2=n},get_quickFilter:function(){return this},get_filterTable:function(){return this.get_quickFilterViewModel().get_catFilterTable()},get_canShowApplyAndCancelButtons:function(){return this.get_attributes()["show-apply"]==="true"},isSetControlUI:function(){return this.get_identifier().get_membershipTarget()==="set"},hasAllItem:function(){return this.get_attributes()["show-all"]!=="false"},get_titleDomId:function(){return this.$4$3},set_titleDomId:function(n){this.$4$3=n},get_isInAllState:function(){var t=ss.isValue(this.modeContents)&&ss.isValue(this.get_modeContents().pendingManager),i=t?this.get_modeContents().pendingManager.get_allItemCheckState():null,n=i;return ss.isNullOrUndefined(n)&&(n=this.get_oFilter().all||this.get_oFilter().allNotChecked),n},getCheckDropdownCatmodeClass:function(){return tableau.base.widget.catmode.CheckDropdown},getChecklistCatmodeClass:function(){return tableau.base.widget.catmode.Checklist},getRadiolistCatmodeClass:function(){return tableau.base.widget.catmode.Radiolist},getSliderCatmodeClass:function(){return tableau.base.widget.catmode.Slider},getDropdownCatmodeClass:function(){return tableau.base.widget.catmode.SimpleDropdown},getPatternCatmodeClass:function(){return tableau.base.widget.catmode.Pattern},getTypeInListCatmodeClass:function(){return tableau.base.widget.catmode.TypeIn},makeSmallSearchWidget:function(n,t){return new tableau.base.widget.SmallSearchWidget(n,t)},makeSearchWidget:function(n,t){return new tableau.base.widget.SearchWidget(n,t)},makeFilteringSearchWidget:function(n){return new tableau.base.widget.FilteringSearchWidget(n)},makePendingChangesManager:function(){return new wr(this.get_modeContents(),this.oFilter.table.actual_size,this.oFilter.exclude,this.oFilter.all)},postCreate:function(){var n,t;this.getStateID=ss.mkdel(this,function(){return this.get_stateId()});this.$a();this.$g();this.mode!=="pattern"&&d.disableTextSelection(this.get_domContent());this.filterViewModel.get_filterType()!=="Categorical";n={qf:this};this.mode==="slider"?this.$1(this.makeSmallSearchWidget(n,this.searchDiv)):this.$u()?(this.$1(this.makeFilteringSearchWidget(n)),this.get_searchWidget().add_hidden(ss.mkdel(this,this.$8))):this.$1(this.makeSearchWidget(n,this.searchDiv));this.get_searchWidget().startup();tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_CategoricalFilter")&&(t=$(this.get_searchWidget().get_dijitDomNode()),this.$x.add$1(spiff.EventUtil.bindWithDispose(t,"contextmenu",ss.mkdel(this,this.handleContextMenuForSearchWidget))));this.initFromState(!0,!1);this.$m()},$m:function(){tsConfig.is_mobile||this.$x.add$2([spiff.TableauClickHandler.targetAndClick(this.menuButton.domNode,ss.mkdel(this,this.doMenu)),spiff.TableauClickHandler.targetAndClick(this.resetButton.domNode,ss.mkdel(this,this.toggleReset)),spiff.TableauClickHandler.targetAndClick(this.searchButton.domNode,ss.mkdel(this,this.toggleSearchUI)),spiff.TableauClickHandler.targetAndClick(this.domainButton.domNode,ss.mkdel(this,this.doDomainMenu)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.menuButton.domNode,ss.mkdel(this,this.doMenu)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.resetButton.domNode,ss.mkdel(this,this.toggleReset)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.searchButton.domNode,ss.mkdel(this,this.toggleSearchUI)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.domainButton.domNode,ss.mkdel(this,this.doDomainMenu))]);this.get_modeContents().setupEventHandlers();this.get_quickFilterViewModel().add_propertyChanged(ss.mkdel(this,this.$i));this.$x.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.get_quickFilterViewModel().remove_propertyChanged(ss.mkdel(this,this.$i))})))},processControlButtons:function(){if(!this.metricsOnly){var i=this.mode==="checkdropdown"||this.mode==="dropdown"||this.mode==="pattern"||this.mode==="typeinlist"||this.shouldHideSearchButton(),r=this.mode==="pattern"||this.mode==="typeinlist"||this.shouldHideDomainButton(),u=this.shouldHideContextMenu(),f=this.mode==="pattern"||this.mode==="typeinlist"||this.shouldHideResetButton(),t=0,n=ss.mkdel(this,function(n,i){ss.isNullOrUndefined(n)||ss.isNullOrUndefined(n.domNode)||($(n.domNode).removeClass("CFButtonR1 CFButtonR2 CFButtonR3 CFButtonR4"),i?n.domNode.classList.add("CFButtonHide"):(t+=1,n.domNode.classList.remove("CFButtonHide"),n.domNode.classList.add("CFButtonR"+t)),$(n.domNode).css("background-color",this.backgroundColor))});n(this.menuButton,u);n(this.domainButton,r);n(this.searchButton,i);n(this.resetButton,f);this.domControls.classList.add("CF"+t+"Button")}},updateStateIfNeeded:function(){this.set_stateId(this.get_stateId()+1)},handleClickIfPending:function(t){this.shouldDeferChanges()&&this.get_modeContents().pendingManager.handleItemClicked(n.filterItem.getIndex(t),t)},shouldDeferChanges:function(){var n=this.get_mode()==="checklist"||this.get_mode()==="checkdropdown";return this.get_canShowApplyAndCancelButtons()&&n},shouldHideResetButton:function(){return this.hideEmptyTitlebar()||this.get_attributes()["show-all"]==="false"||this.get_attributes()["show-filter-state"]==="false"},shouldHideSearchButton:function(){return this.hideEmptyTitlebar()||this.get_attributes()["show-search"]==="false"},shouldHideIncludeExclude:function(){return tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring||this.hideEmptyTitlebar()||this.get_attributes()["show-exclude"]==="false"},shouldHideDomainButton:function(){return this.hideEmptyTitlebar()||this.get_attributes()["show-morefewerbutton"]!=="true"},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},$d:function(){return $(this.domNode).hasClass("CFInlineTitle")},resize$1:function(n){dojo.marginBox(this.domNode,n);this.layout(null)},destroy:function(){$(this.domNode).off(r.$6);this.$5();ss.isValue(this.get_searchWidget())&&(this.get_searchWidget().remove_hidden(ss.mkdel(this,this.$8)),this.get_searchWidget().destroy(),this.$1(null));ss.isValue(this.categoricalSelectionBehavior)&&this.categoricalSelectionBehavior.cancelPendingChange();this.$x.dispose();this.requestSetAttributes=null;this.getContextMenuCommands=null;this.showContextMenu=null;this.showDomainMenu=null;this.get_domContent().innerHTML="";this.domContent=null;this.inherited(arguments)},handleItemClick:function(t){ss.isValue(this.get_modeContents().pendingManager)&&this.get_modeContents().pendingManager.handleItemClicked(n.filterItem.getIndex(t),t);n.filterItem.isAllItem(t)&&(this.doSelectAll(this.isSingleSelect()||n.filterItem.isChecked(t)),this.categoricalSelectionBehavior.clearRangeAnchorAndSelection())},$a:function(){this.mode=ss.coalesce(this.get_oFilter().mode,"checklist");ss.isNullOrEmptyString(this.get_oFilter().pattern)||(this.mode="pattern");this.isTypeInList=this.mode==="typeinlist"},initFromState:function(t,u,f){var e=i.formatColumnDisplayName(this.get_oFilter(),!1,!0),o=0,a=$.contains(this.domNode,document.activeElement),l,s,h,c;if(this.processControlButtons(),l=ss.isValue(this.get_modeContents()),ss.isValue(this.get_modeContents())&&ss.isValue(this.get_modeContents().get_scrollNode())&&this.get_modeContents().get_scrollNode().scrollTop>0&&(o=this.get_modeContents().get_scrollNode().scrollTop),this.$o(),this.$q(),this.updateResetButtonState(),this.updateDomainButton(),!this.$j()){this.$w(this.get_oFilter());this.$a();this.get_oFilter().exclude&&(e=tab.Strings.QuickFilterTitleBarExclusive(e));this.domTitleBar.setAttribute("title",e);this.domTitleBar.setAttribute("id",this.get_titleDomId());this.updateTitleBar();s=n.getBaseItemName(this,"FI");h=this.mode==="pattern"?this.get_oFilter().pattern:this.get_oFilter().table.tuples;l?this.$k(f,h,s):this.$4(h,s);this.categoricalSelectionBehavior.refreshRangeAnchorAndSelection();t||this.layout(null);!(!u&!this.$u())||this.updateSearch();ss.isValue(this.get_modeContents())&&ss.isValue(this.get_modeContents().get_scrollNode())&&(this.get_modeContents().updateTabIndexes(this.domNode,a),c=this.get_modeContents().get_scrollNode().scrollHeight-this.get_modeContents().get_scrollNode().clientHeight,this.get_modeContents().get_isTiled()&&BrowserSupport.BrowserSupport.IsChrome()&&(this.get_modeContents().get_scrollNode().scrollTop=Math.min(o+1,c)),this.get_modeContents().get_scrollNode().scrollTop=Math.min(o,c));$(this.domNode).off(r.$6).on(r.$6,ss.mkdel(this,this.onKeyDown))}},$4:function(n,t){this.$5();this.get_domContent().innerHTML="";this.$b();this.get_modeContents().set_width(this.width);this.get_modeContents().instantiate(n,t)},$k:function(n,t,i){!n&&ss.isValue(this.modeContents.pendingManager)&&(this.get_modeContents().pendingManager.resetFilterInfo(this.get_oFilter().table.actual_size,this.get_oFilter().exclude,this.get_oFilter().all),this.get_modeContents().pendingManager.resetPendingChanges());this.get_modeContents().resetContent(t,i)},$j:function(){if(ss.isValue(this.get_modeContents())&&this.get_modeContents().shouldNotReinstantiate()){var n=r.$0(this.$v(),this.get_oFilter()),t=this.$v().exclude!==this.get_oFilter().exclude,i=r.$4(this.$v(),this.get_oFilter());return this.$w(this.get_oFilter()),ss.isValue(this.get_oFilter().domains)&&ss.contains(this.get_oFilter().domains,"relevant")&&n||t?this.updateSearch():i&&this.get_searchWidget().get_isVisible()&&this.get_searchWidget().toggleUI(),!0}return!1},$5:function(){ss.isValue(this.get_modeContents())&&typeof this.get_modeContents().destroy=="function"&&(this.get_modeContents().destroy(),this.modeContents=null)},onKeyDown:function(n){var i=r.$1();if(!i.is("input, textarea, button")){var u=r.$3(i),f=u.length>0,t=r.$2(n.currentTarget,f);switch(n.which){case 37:case 38:this.$h(n,t,-1);break;case 39:case 40:this.$h(n,t,1);break;case 36:t.first().focus();break;case 35:t.last().focus();break;case 32:u.find("input:first").click();break;case 27:if(this.get_shouldDisableResetButton())return;this.toggleReset();break;case 13:if(this.get_canShowApplyAndCancelButtons()){this.applyPendingChangesByChangelist();break}else return;default:return}n.preventDefault();n.stopPropagation()}},$9:function(){var i=this.modeContents.get_scrollNode(),n=r.$1(),t;return n.is("input, textarea, button")?$([]):(t=r.$3(n).length>0,r.$2(i,t))},$h:function(n,t,i){if(t.length!==0){this.$r(t,i);var r=this.get_quickFilterViewModel().get_currentFocusIndex();r>=0&&this.$s(n,r,t)}},$r:function(n,t){var i=r.$1(),u=r.$3(i),f=n.index(u[0]);this.get_quickFilterViewModel().set_isAllButtonVisible(this.get_modeContents().shouldUseAllItem());this.get_quickFilterViewModel().set_currentFocusIndex(f);this.get_quickFilterViewModel().changeFocusIndexByDelta(t)},$s:function(t,i,r){var f=n.filterItem.getNodeFromEvent(t),u=i;n.filterItem.isTypeInListItem(f)||(this.hasAllItem()&&this.get_modeContents().get_isActiveSearch()&&u--,this.handleKeyboardSelection(t,u,r))},handleKeyboardSelection:function(t,i,r){var u=r.length,f=-1;if(this.hasAllItem()&&this.isActiveSearch()){if(u--,i>=u||i===-1){this.clearRangeAnchorAndSelection();return}}else f=0,i>=u&&(i=f);i<f&&(i=u-1);!this.isActiveSearch()&&tab.FeatureFlags.isEnabled("WebCategoricalSelectionSearchResults")&&(i=n.filterItem.getIndex(r[i]));this.categoricalSelectionBehavior.handleSimpleSelection(t,i)},isActiveSearch:function(){return this.get_modeContents().get_isActiveSearch()},$o:function(){var n=this.get_isInAllState(),t=$(this.domNode);t.toggleClass("CFAll",n);t.toggleClass("CFValue",!n)},$q:function(){this.get_oFilter().exclude?this.domNode.classList.add("CFExclusive"):this.domNode.classList.remove("CFExclusive")},updateResetButtonState:function(){var n=this.isSetControlUI();this.get_shouldDisableResetButton()?p.disableResetButton(this.get_resetButton(),n):p.enableResetButton(this.get_resetButton(),n)},$3:function(){var n=null;(this.mode==="checkdropdown"?n=this.getCheckDropdownCatmodeClass():this.mode==="checklist"?n=this.getChecklistCatmodeClass():this.mode==="radiolist"?n=this.getRadiolistCatmodeClass():this.mode==="slider"?n=this.getSliderCatmodeClass():this.mode==="dropdown"?n=this.getDropdownCatmodeClass():this.mode==="pattern"?n=this.getPatternCatmodeClass():this.mode==="typeinlist"&&(n=this.getTypeInListCatmodeClass()),ss.isNullOrUndefined(n))||(this.modeContents=new n(this,this.get_domContent(),this.get_attributes()))},$b:function(){this.$3()},updateSearch:function(){this.get_searchWidget().updateSearch()},applyChanges:function(){this.get_modeContents().applyChanges()},applyChangesByChangelist:function(n){if(this.shouldDeferChanges()){if(this.get_modeContents().pendingManager.processChanges(n),ss.isValue(this.get_modeContents().pendingManager.get_allItemCheckState())){var t=this.get_modeContents().pendingManager.get_allItemCheckState();ss.isValue(t)&&ss.unbox(t)?this.domNode.classList.add("CFAll"):this.domNode.classList.remove("CFAll")}}else this.get_modeContents().applyChangesByChangelist(n,this.mode)},applyPendingChangesByChangelist:function(){if(!ss.isNullOrUndefined(this.get_modeContents().pendingManager)){if(this.get_modeContents().pendingManager.isSelectAll())this.$2(!0);else if(this.get_modeContents().pendingManager.isDeSelectAll(!1))this.$2(!1);else{var n=this.get_modeContents().pendingManager.get_pendingChangelist();this.get_modeContents().applyChangesByChangelist(n,this.mode)}this.get_modeContents().pendingManager.resetPendingChanges()}},cancelPendingChangesByChangelist:function(){this.get_modeContents().pendingManager.resetPendingChanges();this.initFromState(!1,!0,!0)},$u:function(){return this.mode==="checklist"||this.mode==="radiolist"||this.mode==="checkdropdown"||this.mode==="dropdown"},filterBySearchResults:function(n){ss.isNullOrUndefined(n)?this.initFromState(!1,!0,!0):this.$u()&&(this.modeContents.updateContent(n),tab.FeatureFlags.isEnabled("WebCategoricalSelectionSearchResults")?this.categoricalSelectionBehavior.reselectValidFilterItems():this.categoricalSelectionBehavior.clearRangeAnchor())},updateStateFromSearch:function(n){var t=this.get_isTypeInList();this.get_isTypeInList()&&this.$t(n);this.initFromState(!1,t)},$t:function(t){for(var o={},r=this.get_oFilter().table.tuples,s,u,f,e,i=0;i<r.length;i++)s={node:this.fetchChildNodeByIndex(i),tuple:r[i]},o[n.getAliasForTuple(r[i])]=s;for(i=0;i<t.tuples.length;i++)u=t.tuples[i],f=o[n.getAliasForTuple(u)],ss.isValue(f)&&ss.isValue(f.node)?n.filterItem.setChecked(f.node,u.s,f.tuple):(e=tableau.util.binarySearch(Object).call(null,u,r,0,null,ss.mkdel(this,this.$n)),e.found||r.splice(e.index,0,u))},$n:function(n,t){var r=i.formatTupleDisplayName(n),u=i.formatTupleDisplayName(t);return ss.referenceEquals(r,u)?0:ss.compareStrings(r,u)<0?-1:1},fetchChildNodeByIndex:function(n){return this.get_modeContents().fetchChildNodeByIndex(n)},isSingleSelect:function(){return this.mode!=="checklist"&&this.mode!=="checkdropdown"&&this.mode!=="typeinlist"},updateDomainButton:function(){if(ss.isNullOrUndefined(this.get_oFilter().domains)||this.get_oFilter().domains.length<=1){this.domainButton.domNode.style.display="none";return}this.domainButton.attr("label",this.get_quickFilterViewModel().get_domainButtonTooltipText());this.$p()},$p:function(){var n=this.domainButton.iconNode.classList;n.add("wcIconDomainAll")},doMenu:function(){this.showContextMenu(this.menuButton)},doDomainMenu:function(){this.showDomainMenu(this.domainButton)},toggleReset:function(){p.disableResetButton(this.resetButton,this.isSetControlUI());this.doSelectAll(!0,!0);this.categoricalSelectionBehavior.clearRangeAnchorAndSelection()},toggleDomain:function(){var n=function(n){return n===tableau.types.QFDomain.QFD_CONTEXT};this.get_attributes().values===tableau.types.QFDomain.QFD_RELEVANT?this.$6(ss.mkdict(["values",tableau.types.QFDomain.QFD_ALL]),!1):this.get_attributes().values===tableau.types.QFDomain.QFD_CONTEXT?this.$6(ss.mkdict(["values",tableau.types.QFDomain.QFD_RELEVANT]),!1):_.any(this.get_oFilter().domains,n)?this.$6(ss.mkdict(["values",tableau.types.QFDomain.QFD_CONTEXT]),!1):this.$6(ss.mkdict(["values",tableau.types.QFDomain.QFD_RELEVANT]),!1)},getTheAllItemNode:function(){return this.get_modeContents().fetchAllItem()},doSelectAll:function(n,t){this.shouldDeferChanges()?(this.get_modeContents().pendingManager.processAll(n),n?this.domNode.classList.add("CFAll"):this.domNode.classList.remove("CFAll"),t&&this.applyPendingChangesByChangelist()):this.$2(n)},$e:function(){return this.isSingleSelect()&&!this.hasAllItem()},$f:function(){return $(this.get_domContent()).find(".tiledContent").length>0},$l:function(t){var u,i,r;if(this.$f())for(u=this.get_oFilter().table.actual_size,i=0;i<u;++i)r=this.fetchChildNodeByIndex(i),ss.isValue(r)&&n.filterItem.setChecked(r,t)},$2:function(n){if(!this.$e()){if((this.mode==="checklist"||this.mode==="checkdropdown")&&this.$l(this.get_oFilter().exclude?!n:n),tab.ApplicationModel.get_instance().get_isLocalRenderMode()){var t=new tab.LegacyCategoricalQuickFilterData(this.get_oFilter().targetSheets,this.get_identifier(),this.get_oFilter().exclude,null);n&&t.set_includeAll(!0);tab.FilterClientCommands.updateCategoricalFilter(t)}n?tab.FilterClientCommands.setCategoricalQuickFilterToAll(new tab.CancelDialog(null,null,null,!0),this.get_session().get_visualId(),this.get_identifier()):(this.mode==="checklist"||this.mode==="checkdropdown")&&(p.enableResetButton(this.resetButton,this.isSetControlUI()),this.get_oFilter().exclude?this.$7():tab.FilterClientCommands.setCategoricalQuickFilterToNothing(new tab.CancelDialog(null,null,null,!0),this.get_session().get_visualId(),this.get_identifier()))}},$7:function(){var i=this.get_oFilter().table.actual_size-1,n=new st,t=new lt;this.$l(!0);t.setRange(new tab.IntegerRange(0,i),!0);n.addChange(t);this.get_modeContents().applyChangesByChangelist(n,this.mode)},toggleSearchUI:function(){this.get_searchWidget().toggleUI()},$6:function(n,t){this.requestSetAttributes(n,t)},doscrollHoriz:function(){this.get_domContent().scrollLeft=this.domHorizScroll.scrollLeft},$c:function(){return this.mode==="slider"||this.mode==="dropdown"||this.mode==="checkdropdown"||this.mode==="pattern"},getDomTitleBar:function(){return this.domTitleBar},getTitleOffset:function(){return $(this.domNode).hasClass("CFInlineTitle")?0:dojo.marginBox(this.domTitleBar).h},_getSearchWidgetDim:function(){var n=this.get_searchWidget().get_dijitDomNode();return $(n).css("display")==="none"||this.$u()?{h:0,l:0,t:0,w:0}:dojo.marginBox(n)},layoutVertical:function(n){this._layoutSearchWidget(n);var t=this._getSearchWidgetDim(),i=n.h-t.h;this.get_modeContents().layout({w:n.w,h:i},!1)},_getContentFloatingElement:function(){return this.get_isTypeInList()?this.get_searchWidget().get_dijitDomNode():this.get_domContent()},_layoutSearchWidget:function(n){if(this.get_searchWidget().get_isVisible()){var t=n.h;this.get_searchWidget().layout(t)}},_layoutTypeInList:function(n){this.$d()?dojo.marginBox(this.get_searchWidget().get_dijitDomNode(),n):$(this.get_searchWidget().get_dijitDomNode()).css({height:"auto",width:"auto"});this.layoutVertical(n)},_layoutCompactFilter:function(n){this.domNode.classList.add("CFHorizontal");this._layoutSearchWidget(n);this.get_modeContents().layout({w:n.w,h:n.h},!1)},updateTitleBar:function(){this.inherited(arguments);var n=this.get_oFilter().exclude?tab.Strings.QuickFilterExclusive:tab.Strings.QuickFilterInclusive;$("<span><\/span>").addClass("sr-only").text(tab.Strings.Filter+" ").prependTo(this.domTitleBar);$("<span><\/span>").addClass("sr-only").text(" "+n).appendTo(this.domTitleBar)},layout:function(){var i;if(this.updateTitleBar(),!ss.isNullOrUndefined(this.domNode.parentNode)){this.domNode.classList.remove("CFHorizontal");this.domNode.classList.remove("CFInlineTitle");this.domHorizScroll.style.display="none";var r=this.layoutTitleBar(),t=dojo.contentBox(this.domNode),n={w:t.w,h:t.h};this.metricsOnly||(i=this._getContentFloatingElement(),this.hideEmptyTitlebar()?i.style.cssFloat="none":this.titleW>0?(n.w=t.w-r.w,this.domTitleBar.style.cssFloat="left",i.style.cssFloat="left",this.domNode.classList.add("CFInlineTitle")):(n.h=t.h-r.h,this.domTitleBar.style.cssFloat="none",i.style.cssFloat="none"));this.$c()?this._layoutCompactFilter(n):this.get_isTypeInList()?this._layoutTypeInList(n):this.layoutVertical(n)}},$g:function(){d.localizeDojoLabeledControls([{item1:this.searchButton,item2:"QuickFilterSearch"},{item1:this.domainButton,item2:"QuickFilterDomainShowFewerValues"},{item1:this.menuButton,item2:"QuickFilterShowContextMenu"}])},$i:function(n,t){switch(t.get_propertyName()){case"QuickFilterFocusIndexChanged":var i=this.$9();i.eq(this.get_quickFilterViewModel().get_currentFocusIndex()).focus()}},clearRangeAnchorAndSelection:function(){this.categoricalSelectionBehavior.clearRangeAnchorAndSelection()},forEachSelected:function(n){var i,t,u,r,f;if(!ss.isNullOrUndefined(n)&&$.isFunction(n))for(i=this.categoricalSelectionBehavior.get_selectedIndexes(),t=0,u=i.length;t<u;t++)r=i[t],f=this.fetchChildNodeByIndex(r),n(r,f)},onListItemClick:function(n){this.categoricalSelectionBehavior.onListItemClick(n)},handleContextMenuForSearchWidget:function(n){spiff.EventUtil.stopEvent$2(n)},handleContextMenuForList:function(n){var t,i;spiff.EventUtil.stopEvent$2(n);tsConfig.current_sheet_type!=="story"&&(t=new spiff.ShowMenuOptions($(n.target),!1),t.cursorPosition={left:n.clientX,top:n.clientY},i=t,tab.WidgetUtil.showMenu(this.getContextMenuCommands(),i));this.categoricalSelectionBehavior.onListItemRightClick(n)},notifyChange:function(n){this.categoricalSelectionBehavior.notifyChange(n)},$8:function(){p.focusQfButton(this.searchButton)}},{$0:function(n,t){var r,u,i,f;if(ss.isNullOrUndefined(n)||(r=n.table.tuples,u=t.table.tuples,r.length!==u.length))return!0;for(i=0,f=r.length;i<f;i++)if(!ss.referenceEquals(r[i].t[0].v,u[i].t[0].v))return!0;return!1},$4:function(n,t){if(ss.isNullOrUndefined(n))return!0;var r=ss.isValue(n.all)&&n.all,i=ss.isValue(t.all)&&t.all;return r!==i&&i},$1:function(){return $(document.activeElement)},$3:function(n){return n.filter(".FIItem")},$2:function(n,t){return t?$(n).find(".FIItem"):$([])},findFirstDesirableFocusable:function(n){var t,r,i,u;if(ss.isNullOrUndefined(n))return null;for(t=null,r=[".QueryBox",".FIItem[tabindex]",".CFContent [tabindex]","[tabindex]"],i=0;i<r.length;i++){if(u=r[i],ss.isValue(t)&&$(t).is(":focusable"))break;t=n.querySelector(u)}return t}}),hr=global.tab.LegacyCategoricalQuickFilterViewModel=ss.mkType(t,"tab.LegacyCategoricalQuickFilterViewModel",function(n){this.$1=null;this.$0=0;spiff.BaseViewModel.call(this);this.$1=n;this.$1.add_filterUpdated(ss.mkdel(this,this.handleUpdateFilterContent));this.$0=-1},{get_filterType:function(){return this.$1.get_filterType()},get_legacyCategoricalQuickFilterModel:function(){return this.$1},get_mode:function(){return this.$1.get_mode()},get_pattern:function(){return this.$1.get_pattern()},get_isAllMode:function(){return this.$1.get_isAllMode()},get_isAllButtonVisible:function(){return this.$1.get_isAllButtonVisible()},set_isAllButtonVisible:function(n){this.$1.set_isAllButtonVisible(n)},get_allItemsAreChecked:function(){return this.$1.get_allItemsAreChecked()},get_noItemsAreChecked:function(){return this.$1.get_noItemsAreChecked()},get_exclude:function(){return this.$1.get_exclude()},get_isTiled:function(){return this.$1.get_isTiled()},get_isSearchable:function(){return this.$1.get_isSearchable()},get_summary:function(){return this.$1.get_summary()},get_underlyingDataSourceIsCube:function(){return this.$1.get_underlyingDataSourceIsCube()},get_condition:function(){return this.$1.get_condition()},get_limit:function(){return this.$1.get_limit()},get_rangeType:function(){return this.$1.get_rangeType()},get_catFilterTable:function(){return this.$1.get_catFilterTable()},get_domainActualSize:function(){return this.$1.get_domainActualSize()},get_tuples:function(){return this.$1.get_tuples()},get_domainType:function(){return this.$1.get_domainType()},get_currentFocusIndex:function(){return this.$0},set_currentFocusIndex:function(n){this.$0=n;this.notifyPropertyChanged("QuickFilterFocusIndexChanged")},get_domainButtonTooltipText:function(){var n=this.get_domainType();return n===tableau.types.QFDomain.QFD_RELEVANT?tab.Strings.QuickFilterDomainRelevant:n===tableau.types.QFDomain.QFD_CONTEXT?tab.Strings.QuickFilterDomainContext:n===tableau.types.QFDomain.QFD_CASCADING?tab.Strings.QuickFilterDomainCascading:n===tableau.types.QFDomain.QFD_CASCADING_CONTEXT?tab.Strings.QuickFilterDomainCascadingContext:tab.Strings.QuickFilterDomainDatabase},handleUpdateFilterContent:function(){},changeFocusIndexByDelta:function(n){var t=this.get_domainActualSize(),i;this.get_legacyCategoricalQuickFilterModel().get_isAllButtonVisible()&&(t+=1);t===0?this.set_currentFocusIndex(-1):(i=ss.imod(this.get_currentFocusIndex()+n,t),i<0&&(i+=t),this.set_currentFocusIndex(i))},dispose:function(){this.$1.remove_filterUpdated(ss.mkdel(this,this.handleUpdateFilterContent));this.$1=null;spiff.BaseViewModel.prototype.dispose.call(this)}}),kt=global.tab.LegacyFilterDropDownArrowTemplate=ss.mkType(t,"tab.LegacyFilterDropDownArrowTemplate",null,null,{getDropDownForColor:function(n){return"<svg focusable='false' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='12px' height='12px' viewBox='0 0 12 12' style='enable-background:new 0 0 12 12;' xml:space='preserve'><path style='fill:"+n+";' d='M4.9,6.9L2.1,3.3C2,3.2,2.1,3,2.2,3h5.6C8,3,8.1,3.2,8,3.3L5.2,6.9C5.1,7,4.9,7,4.9,6.9z'/><\/svg>"}}),e=global.tab.LegacyHierarchicalQuickFilter=ss.mkType(t,"tab.LegacyHierarchicalQuickFilter",function(){this.templateString="<div class='HierarchicalFilter'><div dojoAttachPoint='domBox' class='HierarchicalFilterBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='HFButton HFSearchButton' showlabel='false'dojoAttachPoint='searchButton' dojoAttachEvent='onClick:toggleSearchUI'iconClass='wcIconSearch'>Search<\/div><div dojoType='dijit.form.Button' class='HFButton HFMenuButton' dojoAttachPoint='menuButton'name='type' dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'><\/div><\/div><div dojoAttachPoint='searchDiv'><\/div><div class='HFLevels tab-ctrl-formatted-coloronly' dojoAttachPoint='domLevelBox'><table cellspacing='2'><tr dojoAttachPoint='domLevelContainer'><\/tr><\/table><\/div><div class='HFSelection tab-ctrl-formatted-text' dojoAttachPoint='domContent'><\/div><\/div><\/div>";this.widgetsInTemplate=!0;this.$d=[];this.session=null;this.field="";this.membershipTarget="filter";this.filterViewModel=null;this.$b=500;this.attributes={};this.stateId=0;this.domBox=null;this.domLevelBox=null;this.domContent=null;this.domControls=null;this.searchDiv=null;this.searchButton=null;this.RANGE_START="minValue";this.RANGE_END="maxValue";this.$c=null;this.$e=null;this.tree=null;this._applyTimer=null;this.searchWidget=null;this.menuButton=null;this.domLevelContainer=null;this.metricsOnly=!1;this.getContextMenuCommands=null;this.showContextMenu=null;this.requestSetAttributes=null;h.call(this)},{get_applyDelay:function(){throw new ss.NotSupportedException;},get_isTypeInList:function(){return!1},get_oFilter:function(){return this.oFilter},get_quickFilterViewModel:function(){return this.filterViewModel},get_viewModel:function(){return this.filterViewModel},get_dijitDeclaredClass:function(){return this.declaredClass},get_mode:function(){return this.$e},set_mode:function(){window.alert(tab.Strings.noLoc("Bad interface call to set LegacyHierarchicalQuickFilter.Mode"))},get_session:function(){return this.session},set_session:function(n){this.session=n},get_domain:function(){var n=null;return!this.get_attributes().values||(n=this.get_attributes().values),n},get_attributes:function(){return this.attributes},set_attributes:function(n){this.attributes=n},get_field:function(){return this.field},get_membershipTarget:function(){return this.membershipTarget},get_identifier:function(){return new tab.QuickFilterIdentifier.$ctor1(this.get_field(),this.get_membershipTarget())},get_stateId:function(){return this.stateId},set_stateId:function(n){this.stateId=n},get_modeContents:function(){return null},get_domContent:function(){return this.domContent},set_DomContent:function(n){this.domContent=n},get_dijitDomNode:function(){return this.domNode},set_DijitDomNode:function(n){this.domNode=n},get_searchWidget:function(){return this.searchWidget},$1:function(n){this.searchWidget=n},destroy:function(){this.tree.remove_notifyChangeCalled(ss.mkdel(this,this.$a));this.searchWidget.destroy();this.searchWidget=null;this.tree.destroy();this.tree=null;this.inherited(arguments)},applyChangesByChangelist:function(){window.alert(tab.Strings.noLoc("Bad interface call on LegacyHierarchicalQuickFilter.ApplyChangesByChangelist"))},postCreate:function(){var n,t;this.filterViewModel.get_filterType()!=="Hierarchical";this.$c=ss.mkdel(this,function(){return this.stateId});n={qf:this};this.searchWidget=new tableau.base.widget.SearchWidget(n,this.searchDiv);this.searchWidget.startup();this.initFromState(!0);this.$9();t=this.tree;_.each(this.tree.rootNode.getChildren(),function(n){n.isExpandable&&t._expandNode(n)});e.$0(this.textStyle,this.backgroundColor)},$4:function(){if(!!BrowserSupport.BrowserSupport.IsIE()){var n=$(this.domContent);n.css("zoom","1");tab.WindowHelper.requestAnimationFrame(function(){tab.RenderUtil.manualFadeAnimation(n,96,100,8,3875,!0)})}},shouldHideLevelButtons:function(){return this.attributes["show-levels"]==="false"},shouldHideSearchButton:function(){return this.hideEmptyTitlebar()||this.attributes["show-search"]==="false"},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},resize:function(n){dojo.marginBox(this.domNode,n);this.layout(null)},isSingleSelect:function(){return this.$e!=="checklist"},initMode:function(){this.$e=this.$7()},$7:function(){var n="checklist";return ss.keyExists(this.attributes,"mode")&&(n=this.attributes.mode),n},createTreeDom:function(){var n=new tableau.base.widget.hsm.TreeModel(this.session,this.get_identifier(),this.oFilter.levels.length,this.isSingleSelect()),t,i;n.onChildrenChange(n.root,n.itemsFromTable(this.oFilter.table[0],0));t={};t.model=n;t.showRoot=!1;i=t;this.tree=new tableau.base.widget.hsm.Tree(i);this.tree.add_notifyChangeCalled(ss.mkdel(this,this.$a));this.connect(this.tree,"_onTreeFocus",ss.mkdel(this,this.updateRangeAnchor));this.domContent.appendChild(this.tree.domNode)},initFromState:function(n){var u,t,r;ss.referenceEquals(this.$7(),this.$e)||$(this.domContent).empty();this.domContent.hasChildNodes()||(this.initMode(),this.createTreeDom());u=i.formatColumnDisplayName(this.oFilter,!1,!0);this.domTitleBar.setAttribute("title",u);this.updateTitleBar();ss.isValue(this.domLevelContainer)&&$(this.domLevelContainer).empty();this.shouldHideLevelButtons()?ss.isValue(this.domLevelBox)&&this.domLevelBox.setAttribute("display","none"):this.$5();n||this.tree.model.refresh(this.oFilter.table);ss.isValue(this.tree.anchor)?(this.tree.anchor.labelNode.classList.add("anchorSelection"),this.tree.anchor.domNode.classList.add("anchorSelectionNode")):this.tree.anchor=null;this.layout(null);ss.isValue(this.searchWidget)&&this.searchWidget.updateSearch();t=0;this.metricsOnly||(r=ss.mkdel(this,function(n,i){this._hasDomNode(n)&&(i?($(n.domNode).removeClass("HFButtonR1 HFButtonR2"),n.domNode.classList.add("HFButtonHide")):(t+=1,n.domNode.classList.remove("HFButtonHide"),n.domNode.classList.add("HFButtonR"+t)),$(n.domNode).css("background-color",this.backgroundColor))}),r(this.menuButton,this.shouldHideContextMenu()),r(this.searchButton,this.shouldHideSearchButton()),this.domControls.classList.add("HF"+t+"Button"))},$5:function(){var n,t;if(!ss.isNullOrUndefined(this.domLevelBox))for(n=document.createElement("td"),n.appendChild(document.createTextNode(" ")),n.classList.add("HFLevelSpacer"),t=0;t<this.oFilter.levels.length;t++)n=document.createElement("td"),n.appendChild(document.createTextNode(t.toString())),this.domLevelContainer.appendChild(n),this.$e!=="radiolist"&&(this.oFilter.levels[t]===0?n.classList.add("HFLevelAllSelected"):this.oFilter.levels[t]===1?n.classList.add("HFLevelNoneSelected"):n.classList.add("HFLevelSomeSelected")),t===0?n.classList.add("HFLevelFirst"):t<this.oFilter.levels.length-1?n.classList.add("HFLevelNonLeaf"):n.classList.add("HFLevelLast"),this.connect(n,"onclick",ss.mkdel(this,this.onLevelClick))},doMenu:function(){this.showContextMenu(this.menuButton)},$2:function(){var o=[],f=[],i=[].concat.apply([],this.tree.rootNode.getChildren()),s="filter-delta",h=[],c=[],n,t,r,u,l,e;if(i.length!==0){do{if(n=i.shift(),t=n.item.tuple,n.item.schema.length>o.length&&(o=n.item.schema),n.isChecked&&!t.s){if(t.s=!0,f.push(t),this.isSingleSelect()){s="filter-replace";break}}else!n.isChecked&&t.s&&(delete t.s,f.push(t));i=i.concat.apply(i,n.getChildren())}while(i.length!==0);if(r=f,r.length!==0){for(u=0;u<r.length;u++)l=r[u].t.length-1,e=r[u].t[l].v,r[u].s?h.push(e):c.push(e);tab.FilterClientCommands.doMemberHierarchialFilter(this.session.get_visualId(),this.field,h,c,s)}}},$3:function(n,t){if(!ss.isNullOrUndefined(n)&&!ss.isNullOrUndefined(t)){var h=this.tree.getDepth(t),u=this.tree.findEarlierNode(t,n,h),c=ss.referenceEquals(u,t)?n:t,f=u.item.tuple.t,e=c.item.tuple.t,o=f[f.length-1].v,s=e[e.length-1].v,i={},r={};n.isChecked?(i[this.RANGE_START]=o,i[this.RANGE_END]=s):(r[this.RANGE_START]=o,r[this.RANGE_END]=s);tab.FilterClientCommands.doRangeHierarchialFilter(this.session.get_visualId(),this.field,i,r,"filter-delta")}},updateStateFromSearch:function(n){for(var i,o={},f=n.tuples,u=0;u<f.length;u++)o[f[u].d]=f[u].s===!0;for(i=[].concat.apply([],this.tree.rootNode.getChildren());i.length!==0;){var t=i.shift(),r=t.item.tuple,e=o[r.d];ss.isValue(e)?e!==r.s&&(e?(t.isChecked=!0,t.labelNode.firstChild.checked=!0,r.s=!0):(t.isChecked=!1,t.labelNode.firstChild.checked=!1,delete r.s)):this.isSingleSelect()&&r.s&&(t.isChecked=!1,t.labelNode.firstChild.checked=!1,delete r.s);i=i.concat.apply(i,t.getChildren())}},updateRangeAnchor:function(n){this.isSingleSelect()||ss.referenceEquals(this.tree.anchor,n)||(ss.isValue(this.tree.anchor)&&(this.tree.anchor.labelNode.classList.remove("anchorSelection"),this.tree.anchor.domNode.classList.remove("anchorSelectionNode"),this.tree.anchor.labelNode.classList.remove("dijitTreeLabelFocused"),this.tree.prev_anchor=this.tree.anchor),this.tree.anchor=n,this.tree.anchor.labelNode.classList.add("anchorSelection"),this.tree.anchor.domNode.classList.add("anchorSelectionNode"))},$a:function(n){if(n.target.tagName.toLowerCase()==="input"){this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);this.stateId++;var t=dijit.getEnclosingWidget(n.target.parentNode);ss.referenceEquals(this.tree.anchor,t)||this.updateRangeAnchor(t);n.shiftKey===!0&&ss.isValue(this.tree.prev_anchor)&&this.tree.getDepth(this.tree.prev_anchor)===this.tree.getDepth(this.tree.anchor)&&!this.isSingleSelect()?(this.updateCheckboxRange(this.tree.anchor,this.tree.prev_anchor),this.$3(this.tree.anchor,this.tree.prev_anchor)):this._applyTimer=window.setTimeout(ss.mkdel(this,this.$2),this.$b)}},updateCheckboxRange:function(n,t){var e=this.tree.getDepth(t),u=this.tree.findEarlierNode(t,n,e),f=ss.referenceEquals(u,t)?n:t,r=n.isChecked,i=u;for(this.tree.anchorIsStart=!ss.referenceEquals(u,t);ss.isValue(i)&&i.isTreeNode&&!ss.referenceEquals(i,f);)i.labelNode.firstChild.checked=r,i.isChecked=r,i=this.$8(i,e);f.labelNode.firstChild.checked=r;f.isChecked=r},$8:function(n,t){var r=t,u=n,i=n.getNextSibling(),f;if(ss.isValue(i))return i;while(ss.isNullOrUndefined(i)&&r>=0)for(u=u.getParent(),r-=1,i=u.getNextSibling();ss.isValue(i);){if(f=this.$6(i,r,t),ss.isValue(f))return f;i=i.getNextSibling()}return r>=0?i:null},$6:function(n,t,i){var u,e,r,f;if(ss.isNullOrUndefined(n)||t<0||t>i)return null;if(t===i)return n;if(n.hasChildren())for(u=n.getChildren(),e=u.length,r=0;r<e;r++)if(f=this.$6(u[r],t+1,i),ss.isValue(f))return f;return null},toggleSearchUI:function(){ss.isValue(this.searchWidget)&&this.searchWidget.toggleUI()},onLevelClick:function(n){var t=n.target,r,u=[],f=[],i;t.tagName.toLowerCase()==="td"&&((spiff.EventUtil.stopEvent(n),this.isSingleSelect())||(i=parseInt(t.textContent,10),this.oFilter.levels[i]===0?(r=!1,t.classList.remove("HFLevelAllSelected"),t.classList.remove("HFLevelSomeSelected"),t.classList.add("HFLevelNoneSelected")):(r=!0,t.classList.remove("HFLevelNoneSelected"),t.classList.remove("HFLevelSomeSelected"),t.classList.add("HFLevelAllSelected")),r?u.push(i):f.push(i),(u.length>0||f.length>0)&&tab.FilterClientCommands.doLevelHierarchialFilter(this.session.get_visualId(),this.field,u,f,"filter-delta")))},layout:function(){var u=$(this.domContent),s,r;u.hide();this.domNode.classList.remove("HFHorizontal");var t=dojo.contentBox(this.domNode),f=ss.isValue(this.domLevelBox)?dojo.marginBox(this.domLevelBox):ss.mkdict(["w",0,"h",0]),e=ss.mkdict(["h",0]);this.updateTitleBar();var o=this.layoutTitleBar(),i=o.h,n=t.w;!this.hideEmptyTitlebar()&&this.titleW>0?(this.domNode.classList.add("HFHorizontal"),this.domTitleBar.style.cssFloat="left",ss.isValue(this.domLevelBox)&&(this.domLevelBox.style.cssFloat="left"),this._hasDomNode(this.menuButton)&&this.menuButton.domNode.classList.add("HFButtonHide"),this._hasDomNode(this.searchButton)&&this.searchButton.domNode.classList.add("HFButtonHide"),n-=o.w,i=0):(!this.shouldHideContextMenu()&&this._hasDomNode(this.menuButton)&&this.menuButton.domNode.classList.remove("HFButtonHide"),!this.shouldHideSearchButton()&&this._hasDomNode(this.searchButton)&&this.searchButton.domNode.classList.remove("HFButtonHide"),this.domTitleBar.style.cssFloat="none",ss.isValue(this.domLevelBox)&&(this.domLevelBox.style.cssFloat="none"));ss.isValue(this.searchWidget)&&this.searchWidget.get_isVisible()&&(s=t.h-i-f.h,this.searchWidget.layout(s),e=dojo.marginBox(this.searchWidget.get_dijitDomNode()));r=t.h-i-f.h-e.h;ss.isValue(this.domLevelBox)&&dojo.marginBox(this.domLevelBox,ss.mkdict(["w",n]));tsConfig.is_mobile?(d.setMarginBoxWidth(this.domContent,n),this.domContent.style.maxHeight=r+"px"):dojo.marginBox(this.domContent,ss.mkdict(["h",r,"w",n]));this.$4();u.show()},_hasDomNode:function(n){return ss.isValue(n)&&ss.isValue(n.domNode)},$9:function(){d.localizeDojoLabeledControls([{item1:this.searchButton,item2:"QuickFilterSearch"}])}},{$0:function(n,t){var i=tab.ColorModel.fromColorCode(t),u=tab.ColorModel.fromColorCode(n.color),c=tab.ColorModel.alphaComposite(tab.ColorModel.fromColorModelPlusAlpha(u,.235294118523598),i),l={"border-width":"1px","border-style":"solid","border-color":c.toRgb()},f,r;tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelNoneSelected",l);f=tab.ColorModel.alphaComposite(tab.ColorModel.fromColorModelPlusAlpha(u,.411764711141586),i);r={"border-color":f.toRgb()};tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelSomeSelected",r);tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelAllSelected",r);var o=tab.ColorModel.fromColorCode(t),s=tab.ColorModel.alphaComposite(tab.ColorModel.fromColorModelPlusAlpha(i,.39215686917305),e.$9),h=tab.ColorModel.alphaComposite(tab.ColorModel.fromColorModelPlusAlpha(i,.549019634723663),e.$9);o.isLStarAboveThreshold(95)&&(s=e.$5,h=e.$3);var a={"background-color":s.toRgb()},v={"background-color":h.toRgb()},y={"background-color":o.toRgb()};tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelAllSelected",a);tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelSomeSelected",v);tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelNoneSelected",y)}}),cr=global.tab.LegacyHierarchicalQuickFilterViewModel=ss.mkType(t,"tab.LegacyHierarchicalQuickFilterViewModel",function(n){this.$0=null;spiff.BaseViewModel.call(this);this.$0=n},{get_filterType:function(){return this.$0.get_filterType()},get_legacyHierarchicalQuickFilterModel:function(){return this.$0},get_hierarchyTables:function(){return this.$0.get_hierarchyTables()},get_levels:function(){return this.$0.get_levels()},get_isSearchable:function(){return this.$0.get_isSearchable()}}),ei=global.tab.LegacyQuantitativeDateQuickFilter=ss.mkType(t,"tab.LegacyQuantitativeDateQuickFilter",function(n){this.$z=0;this.$x=null;this.$y=null;this.$w=!1;v.call(this,n)},{get_editingFormat:function(){return this.oFilter.editing_format},postCreate:function(){var i;this.inherited(arguments);var f=this.oFilter.date_format,n=f.locale_formatting_strings,o=this.get_editingFormat(),s=n.narrowDay.filter(function(n){return!ss.isNullOrEmptyString(n)}),t=this.oFilter.first_day_of_week;ss.isValue(t)&&(t=t-1);var r=new Date,e=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),u={};u.format=tableau.format.mapIcuToOleFormat(f.yearMonthFormat);u.locale_formatting_strings=n;i={};i.format=o.format;i.locale_formatting_strings=n;this.$x=new tab.DatePicker(new tab.DatePickerSettings(e,e,null,null,t,s,n.todayFormatTemplate,function(n){return tableau.format.formatCustomJsDateTime(n,u,0,"d")},function(n){return tableau.format.formatCustomJsDateTime(n,i,0,"d")}));this.$x.element.on("dateSelected",ss.mkdel(this,this.$r)).on("mousedown",ss.mkdel(this,this.$q)).appendTo(document.body);this.$w=!1},destroy:function(){this.$x.dispose();this.$x=null;this.inherited(arguments)},showFullDateTimes:function(n,t){return this.$z=tab.QuickFilterDateFormatUtil.getDateTimeFormatMode([this.oCurrentMin,this.oCurrentMax,this.oRangeMin,this.oRangeMax,t],this.get_presModel().aggregation,n,this.$z),this.$z},getFilterValueAtResolution:function(n){return ss.isValue(n)&&this.showFullDateTimes(this.get_editingFormat(),null)===0?Math.floor(ss.unbox(n)):n},speciallyFormatDataValueForQuantitativeQF:function(n){return tableau.format.formatDataValue(tab.LegacyFilterModel.buildDataValueFromFilterValue(n),this.oFilter.role,this.oFilter.date_format,null,this.showFullDateTimes(this.oFilter.date_format,n))},$t:function(){return tab.QuickFilterDateFormatUtil.isPureTime([this.oCurrentMin,this.oCurrentMax,this.oRangeMin,this.oRangeMax],this.get_presModel().aggregation)},showInput:function(n,t,i){if(this.inherited(arguments),this.get_presModel().aggregation!=="trunc-month"&&this.get_presModel().aggregation!=="trunc-year"&&!this.$t()&&(!ss.referenceEquals(this.$y,i)||this.$x.element.is(":hidden"))){var r=tab.LegacyFilterModel.isNormalValue(t)&&!isNaN(ss.unbox(t.v))?new Date(tableau.types.JsDateFromOleDate(ss.unbox(t.v))):null;this.$x.show(r);this.$y=i;this.$u()}},handleContextMenuForDomLowerBound:function(n){if(tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_LegacyQuantitativeDateQuickFilter")){if(!this.hasCurrentMin())return;this.showLowerInput(n)}else v.prototype.handleContextMenuForDomLowerBound.call(this,n)},handleContextMenuForDomUpperBound:function(n){if(tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_LegacyQuantitativeDateQuickFilter")){if(!this.hasCurrentMax())return;this.showUpperInput(n)}else v.prototype.handleContextMenuForDomUpperBound.call(this,n)},layout:function(){this.inherited(arguments);this.$u()},$u:function(){if(!ss.isNullOrUndefined(this.$y)){var n=$(ss.referenceEquals(this.$y,this.domLowerInput)?this.domLowerBound:this.domUpperBound);this.$x.positionCalendarByElement(n)}},$r:function(n,t){this.$x.hide();var i=ss.referenceEquals(this.$y,this.domLowerInput),r=i?this.oCurrentMin:this.oCurrentMax,f=i?this.domLowerBound:this.domUpperBound,e=ei.mergeDateWithTime(t,new Date(tableau.types.JsDateFromOleDate(ss.unbox(r.v)))),u=tableau.types.OleDateFromJsDate(e.getTime());this.applyInputValue(r,this.$y,f,u,ss.mkdel(this,function(){this.$v(i,u)}))},$v:function(n,t){n?this.updateMinAndMax(t,this.oCurrentMax.v):this.updateMinAndMax(this.oCurrentMin.v,t)},$q:function(){this.$w=!0},hideLowerInput:function(n){this.$s(n,this.domLowerInput,ss.mkdel(this,function(n){v.prototype.hideLowerInput.call(this,n)}))},hideUpperInput:function(n){this.$s(n,this.domUpperInput,ss.mkdel(this,function(n){v.prototype.hideUpperInput.call(this,n)}))},$s:function(n,t,i){this.$w?(spiff.EventUtil.stopEvent$2(n),this.$w=!1,window.setTimeout(function(){$(t).is(":visible")&&t.focus()},0)):(i(n),this.$x.hide(),ss.referenceEquals(this.$y,t)&&(this.$y=null))}},{mergeDateWithTime:function(n,t){return new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()))}}),v=global.tab.LegacyQuantitativeQuickFilter=ss.mkType(t,"tab.LegacyQuantitativeQuickFilter",function(){this.templateString="<div class='QuantitativeFilter'><div class='QuantitativeFilterBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='QFTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='QFButton QFResetButton' showlabel='false'dojoAttachPoint='resetButton'iconClass='wcIconNonfiltered'>Showing all values<\/div><div dojoType='dijit.form.Button' class='QFButton QFDomainButton' showlabel='false'dojoAttachPoint='domainButton'iconClass='wcIconDomainAll'>Show Smaller Range<\/div><div dojoType='dijit.form.Button' class='QFButton QFMenuButton' name='type' dojoAttachPoint='menuButton'iconClass='wcIconContextMenu'><\/div><\/div><div class='QFContent' dojoAttachPoint='domContent'><div class='QFReadout QFLowerBound tab-ctrl-formatted-border-hover' dojoAttachEvent='onclick:showLowerInput' dojoAttachPoint='domLowerBound'><div class='readoutText tab-ctrl-formatted-fixedsize' dojoAttachPoint='domLowerText'><\/div><input type='text' dojoAttachPoint='domLowerInput'><\/input><\/div><div class='QFReadout QFUpperBound tab-ctrl-formatted-border-hover' dojoAttachEvent='onclick:showUpperInput' dojoAttachPoint='domUpperBound'><div class='readoutText tab-ctrl-formatted-fixedsize' dojoAttachPoint='domUpperText'><\/div><input type='text' dojoAttachPoint='domUpperInput'><\/input><\/div><div dojoAttachPoint='domBar' class='QFSlider QFBar'><div dojoAttachPoint='domRange' class='QFRange' dojoAttachEvent='onmousedown:startRangeCapture'><div dojoAttachPoint='domHighlight' class='QFRangeHighlight'><\/div><\/div><\/div><span dojoAttachPoint='domLowerImg' class='QFSlider QFImg QFFilterLeft' dojoAttachEvent='onmousedown:startLowerCapture'><\/span><span dojoAttachPoint='domUpperImg' class='QFSlider QFImg QFFilterRight' dojoAttachEvent='onmousedown:startUpperCapture'><\/span><\/div><\/div><\/div>";this.getContextMenuCommands=null;this.requestSetAttributes=null;this.attributes={};this.widgetsInTemplate=!0;this.global=!1;this.templateRoot=null;this.session=null;this.field="";this.filterViewModel=null;this.presModel=null;this.$j=200;this.$k=null;this.$n=10;this.rid=0;this.timestamp=0;this.$l=null;this.domContent=null;this.domControls=null;this.domLowerText=null;this.domUpperText=null;this.domLowerInput=null;this.domUpperInput=null;this.domBar=null;this.domRange=null;this.domHighlight=null;this.domLowerImg=null;this.domUpperImg=null;this.domLowerBound=null;this.domUpperBound=null;this.resetButton=null;this.menuButton=null;this.domainButton=null;this.lastLowerOffset=0;this.lastUpperOffset=0;this.classQF="QF";this.classQFButtonR="QFButtonR";this.classQFButtonHide="QFButtonHide";this.classQFDisabled="QFDisabled";this.classQFCenterText="QFCenterText";this.classQFHideButtons="QFHideButtons";this.classQFHideSlider="QFHideSlider";this.classQFHideReadout="QFHideReadout";this.classQFResetDisabled="QFResetDisabled";this.oCurrentMin=null;this.oCurrentMax=null;this.oRangeMin=null;this.oRangeMax=null;this.oDataMin=null;this.oDataMax=null;this.rangeMinOverride=null;this.rangeMaxOverride=null;this.previousMinVal=null;this.previousMaxVal=null;this.metricsOnly=!1;this.oMetrics=null;this.$p=null;this.precision=0;this.captureInfo=null;this.showInputStartValue=null;this.mode=null;this.showContextMenu=null;this.showDomainMenu=null;this.$m=null;this.$o=!1;this.canFastFilterBySheetNamePromise=$.Deferred();h.call(this);this.$l=new tab.DisposableHolder;tab.ServerFontLoader.get_instance().add_fontPreparationComplete(ss.mkdel(this,this.$1))},{get_attributes:function(){return this.attributes},get_presModel:function(){return this.presModel},get_oCurrentMin:function(){return this.oCurrentMin},get_oCurrentMax:function(){return this.oCurrentMax},get_editingFormat:function(){return ss.isNullOrUndefined(this.$m)&&(this.$m=tableau.format.deriveNumberEditingFormat(this.oFilter.format)),this.$m},get_visualId:function(){return this.session.get_visualId()},get_field:function(){return this.field},$i:function(){return this.oFilter.table.included},$1:function(){ss.isValue(this.domNode)&&this.$o&&this.layout(null)},postCreate:function(){var t,n;this.filterViewModel.get_filterType()!=="Quantitative";this.domLowerInput.style.display="none";this.domUpperInput.style.display="none";tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_LegacyQuantitativeQuickFilter")&&this.$l.add$2([spiff.EventUtil.bindWithDispose($(this.domLowerBound),"contextmenu",ss.mkdel(this,this.handleContextMenuForDomLowerBound)),spiff.EventUtil.bindWithDispose($(this.domUpperBound),"contextmenu",ss.mkdel(this,this.handleContextMenuForDomUpperBound))]);$(this.domLowerInput).on("blur",ss.mkdel(this,this.hideLowerInput)).on("keydown",ss.mkdel(this,this.lowerInputKeyDown)).on("keypress",ss.mkdel(this,this.checkLowerEnter));$(this.domUpperInput).on("blur",ss.mkdel(this,this.hideUpperInput)).on("keydown",ss.mkdel(this,this.upperInputKeyDown)).on("keypress",ss.mkdel(this,this.checkUpperEnter));$(document.body).on("mousedown."+this.domNode.id,ss.mkdel(this,function(n){ss.referenceEquals(n.target,this.domLowerInput)||this.domLowerInput.blur();ss.referenceEquals(n.target,this.domUpperInput)||this.domUpperInput.blur()}));this.timestamp=(new Date).getTime();this.localize();t=i.formatColumnDisplayName(this.oFilter,!1,!0);this.domTitleBar.setAttribute("title",t);this.updateTitleBar();this.$9();n=this.oFilter.table;this.$3(n.min.v,n.max.v);this.$b()},$b:function(){this.$l.add$2([spiff.TableauClickHandler.targetAndClick(this.menuButton.domNode,ss.mkdel(this,this.doMenu)),spiff.TableauClickHandler.targetAndClick(this.resetButton.domNode,ss.mkdel(this,this.toggleReset)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.menuButton.domNode,ss.mkdel(this,this.doMenu)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.resetButton.domNode,ss.mkdel(this,this.toggleReset))]);this.$l.add$2([spiff.TableauClickHandler.targetAndClick(this.domainButton.domNode,ss.mkdel(this,this.doDomainMenu)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.domainButton.domNode,ss.mkdel(this,this.doDomainMenu))])},$9:function(){if(!this.metricsOnly){var n=0,t=ss.mkdel(this,function(t,i){ss.isNullOrUndefined(t)||ss.isNullOrUndefined(t.domNode)||($(t.domNode).removeClass(this.classQFButtonR+"1 "+this.classQFButtonR+"2 "+this.classQFButtonR+"3"),i?t.domNode.classList.add(this.classQFButtonHide):(n+=1,t.domNode.classList.remove(this.classQFButtonHide),t.domNode.classList.add(this.classQFButtonR+n)),$(t.domNode).css("background-color",this.backgroundColor))});t(this.menuButton,this.shouldHideContextMenu());t(this.domainButton,this.shouldHideDomainButton());t(this.resetButton,this.shouldHideResetButton());this.domControls.classList.add(this.classQF+n+"Button")}},isSetControlUI:function(){return!1},$3:function(n,t){this.isMaxRange(n,t)?p.disableResetButton(this.resetButton,!1):p.enableResetButton(this.resetButton,!1)},isMaxRange:function(n,t){var u=ss.isValue(n),f=ss.isValue(t),i,r;return u&&f&&this.$i()!=="include-all"?!1:(i=this.oFilter.range.min.v,r=this.oFilter.range.max.v,u||(n=i),f||(t=r),ss.isValue(i)&&ss.isValue(n)&&tab.DoubleUtil.isLessThanOrApproximatelyEqual(ss.unbox(n),ss.unbox(i))&&ss.isValue(r)&&ss.isValue(t)&&tab.DoubleUtil.isGreaterThanOrApproximatelyEqual(ss.unbox(t),ss.unbox(r)))},postMixInProperties:function(){this.inherited(arguments);this.templateRoot=dojo.moduleUrl("tableau.base.widget","templates").toString()},destroy:function(){ss.isValue(this.$p)&&this.$p.dispose();this.$l.dispose();$(this.domLowerInput).off("blur").off("keydown").off("keypress");$(this.domUpperInput).off("blur").off("keydown").off("keypress");$(document.body).off("mousedown."+this.domNode.id);this.showContextMenu=null;this.showDomainMenu=null;this.requestSetAttributes=null;this.getContextMenuCommands=null;tab.ServerFontLoader.get_instance().remove_fontPreparationComplete(ss.mkdel(this,this.$1));this.inherited(arguments)},showFullDateTimes:function(){return 0},getPrecision:function(){return this.precision},hasCurrentMin:function(){return tab.LegacyFilterModel.isNormalValue(this.oCurrentMin)},hasCurrentMax:function(){return tab.LegacyFilterModel.isNormalValue(this.oCurrentMax)},getRangeMin:function(){return ss.isValue(this.rangeMinOverride)?this.rangeMinOverride:this.oRangeMin.v},getRangeMax:function(){return ss.isValue(this.rangeMaxOverride)?this.rangeMaxOverride:this.oRangeMax.v},getRange:function(){var n=this.getRangeMin(),t=this.getRangeMax();return ss.isValue(n)&&ss.isValue(t)?ss.Nullable$1.sub(t,n):null},hasDataMin:function(){var n=this.presModel.quickFilter;return tab.LegacyFilterModel.isNormalValue(this.oDataMin)&&ss.keyExists(n,"dataMin".toString())},hasDataMax:function(){var n=this.presModel.quickFilter;return tab.LegacyFilterModel.isNormalValue(this.oDataMax)&&ss.keyExists(n,"dataMax".toString())},getDataMin:function(){return this.oDataMin.v},getDataMax:function(){return this.oDataMax.v},getCurMin:function(){return this.oCurrentMin.v},getCurMax:function(){return this.oCurrentMax.v},getMinText:function(){return this.speciallyFormatDataValueForQuantitativeQF(this.oCurrentMin)},getMaxText:function(){return this.speciallyFormatDataValueForQuantitativeQF(this.oCurrentMax)},getLowerPos:function(){return this.domLowerImg.offsetLeft-this.oMetrics.absOffset+(this.$n-1)},setLowerPos:function(n){this.domLowerImg.style.left=n+this.oMetrics.absOffset-(this.$n-1)+"px"},$4:function(){return this.lastLowerOffset!==this.domLowerImg.offsetLeft},$2:function(){return this.domUpperImg.offsetLeft-this.oMetrics.absOffset},setUpperPos:function(n){this.domUpperImg.style.left=n+this.oMetrics.absOffset+"px"},$5:function(){return this.lastUpperOffset!==this.domUpperImg.offsetLeft},isRange:function(){switch(this.$i()){case"include-all":case"include-null":case"include-non-null":return!1;default:return!0}},shouldHideDomainButton:function(){return this.hideEmptyTitlebar()||this.attributes["show-morefewerbutton"]!=="true"},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},shouldHideResetButton:function(){return this.hideEmptyTitlebar()||this.attributes["show-all"]==="false"||this.attributes["show-filter-state"]==="false"},computePrecision:function(n){var i=this.getRange(),r=ss.isValue(i)&&n!==0?ss.unbox(i)/n:1,t=Math.log(r)/Math.log(10);this.precision=t>0?Math.ceil(t):Math.floor(t);(this.precision===Number.NEGATIVE_INFINITY||isNaN(this.precision))&&(this.precision=5)},$a:function(n,t,i){var r,u=n*ss.coalesce(this.getRange(),0)/t;return this.precision>=0?Math.round(i+u):(r=Math.pow(10,-this.precision),Math.round((i+u)*r)/r)},clearDataRange:function(){ss.isValue(this.oDataMin)&&(this.oDataMin=null);ss.isValue(this.oDataMax)&&(this.oDataMax=null);this.domHighlight.style.visibility="hidden"},setMinValue:function(n){if(!ss.isNullOrUndefined(n)&&!isNaN(n)){this.hasCurrentMax()&&ss.Nullable$1.gt(n,this.getCurMax())&&(n=ss.unbox(this.getCurMax()));this.oCurrentMin.v=this.oCurrentMin.t==="i"?Math.round(n):n;this.domLowerText.textContent=this.getMinText();var t=this.getRangeMin();this.hasCurrentMin()&&(!ss.isValue(t)||ss.Nullable$1.lt(this.getCurMin(),t))&&(this.rangeMinOverride=this.getCurMin())}},setMaxValue:function(n){if(!ss.isNullOrUndefined(n)&&!isNaN(n)){this.hasCurrentMin()&&ss.Nullable$1.lt(n,this.getCurMin())&&(n=ss.unbox(this.getCurMin()));this.oCurrentMax.v=this.oCurrentMax.t==="i"?Math.round(n):n;this.domUpperText.textContent=this.getMaxText();var t=this.getRangeMax();this.hasCurrentMax()&&(!ss.isValue(t)||ss.Nullable$1.gt(this.getCurMax(),t))&&(this.rangeMaxOverride=this.getCurMax())}},removeRangeOverride:function(){this.rangeMinOverride=null;this.rangeMaxOverride=null},getValueFromInput:function(n,t){var i={t:t.t,v:ss.unbox(t.v),s:null};return tableau.format.parseQuantitativeDataValue(n.value,t.t,this.get_editingFormat(),this.showFullDateTimes(this.get_editingFormat(),null),i)},speciallyFormatDataValueForQuantitativeQF:function(n){return tableau.format.formatDataValue(tab.LegacyFilterModel.buildDataValueFromFilterValue(n),this.oFilter.role,this.oFilter.format,null,0)},initValues:function(){this.oRangeMin=$.extend({},this.oFilter.range.min);this.oRangeMax=$.extend({},this.oFilter.range.max);this.oDataMin=$.extend({},this.oFilter.data.min);this.oDataMax=$.extend({},this.oFilter.data.max);this.isRange()&&(ss.isValue(this.oFilter.table.min.v)||ss.isValue(this.oFilter.table.max.v))?(this.oCurrentMin=$.extend({},this.oFilter.table.min),this.oCurrentMax=$.extend({},this.oFilter.table.max)):(this.oCurrentMin=$.extend({},this.oFilter.range.min),this.oCurrentMax=$.extend({},this.oFilter.range.max));this.oMetrics={};this.domLowerInput.value=tableau.format.formatDataValue(tab.LegacyFilterModel.buildDataValueFromFilterValue(this.oCurrentMin),this.oFilter.role,this.get_editingFormat(),null,this.showFullDateTimes(this.get_editingFormat(),null));this.domUpperInput.value=tableau.format.formatDataValue(tab.LegacyFilterModel.buildDataValueFromFilterValue(this.oCurrentMax),this.oFilter.role,this.get_editingFormat(),null,this.showFullDateTimes(this.get_editingFormat(),null))},resize:function(n){tab.DomUtil.setMarginBox(this.domNode,n);this.layout(null)},layout:function(){var r,u,f;this.$o=!0;r=200;this.initValues();this.updateTitleBar();this.$d();this.domNode.classList.add(this.classQFHideButtons);this.domNode.classList.remove(this.classQFCenterText);var t=this.layoutTitleBar(),i=dojo.contentBox(this.domNode),n={w:i.w,h:i.h};this.metricsOnly||(this.titleW>0?(n.w=i.w-t.w,this.domContent.style.top="",this.domContent.style.left=t.w+"px"):this.titleH>0?(this.domNode.classList.remove(this.classQFHideButtons),n.h=i.h-t.h,this.domContent.style.top=t.h+"px",this.domContent.style.left=""):(this.domNode.classList.remove(this.classQFHideButtons),this.domContent.style.top="",this.domContent.style.left=""));dojo.marginBox(this.domContent,ss.mkdict(["w",n.w,"h",n.h]));this.$c(n,r);this.oMetrics.top=this.domBar.offsetTop-2;this.oMetrics.absOffset=this.domBar.offsetLeft;this.oMetrics.left=0;this.oMetrics.right=this.domBar.offsetWidth;this.hasCurrentMin()?(this.domLowerImg.style.top=this.oMetrics.top-4+"px",this.domLowerImg.style.visibility=""):this.domLowerImg.style.visibility="hidden";this.hasCurrentMax()?(this.domUpperImg.style.top=this.oMetrics.top-4+"px",this.domUpperImg.style.visibility=""):this.domUpperImg.style.visibility="hidden";u=this.shouldShowDomContent()?"":"hidden";this.domContent.style.visibility=u;this.oMetrics.width=this.oMetrics.right-this.oMetrics.left;this.computePrecision(this.oMetrics.width);f=this.hasDataMin()||this.hasDataMax();this.domHighlight.style.visibility=f?"":"hidden";this.updateMinAndMax(this.oCurrentMin.v,this.oCurrentMax.v);this.updateDomainButton();this.canFastFilterBySheetNamePromise=$.Deferred();tab.FilterClientCommands.canFilterSheetsOnAGivenField(this.field,this.oFilter.targetSheets,this.getVisualIDForSession()).done(ss.mkdel(this,function(n){this.canFastFilterBySheetNamePromise.resolve(n)}))},$c:function(n,t){var o=this.attributes["show-slider"]!=="false",s=this.attributes["show-readout"]!=="false",h,i,r,u,f,c,e;o&&s?(this.domNode.classList.remove(this.classQFHideReadout),this.domNode.classList.remove(this.classQFHideSlider),h=dojo.contentBox(this.domLowerBound).h+dojo.contentBox(this.domLowerImg).h+8,n.h<h&&n.w>200?(this.domNode.classList.add(this.classQFCenterText),i=this.contentBox(this.domLowerText).w,r=this.contentBox(this.domUpperText).w,this.domLowerBound.style.width="",this.domUpperBound.style.width="",this.domLowerBound.style.top="0",this.domUpperBound.style.top="0",u=n.w-(i+dojo.contentBox(this.domLowerImg).w)-(r+dojo.contentBox(this.domUpperImg).w)-16,u<=0?this.domNode.classList.add(this.classQFHideSlider):(dojo.marginBox(this.domBar,ss.mkdict(["w",u])),this.domBar.style.top="7px",this.domBar.style.left=i+tab.DomUtil.getContentBox(this.domLowerImg).w+8+"px",this.domLowerInput.style.width=i+"px",this.domUpperInput.style.width=r+"px")):(f=Math.min(t,Math.floor(n.w/2-4)),dojo.marginBox(this.domLowerBound,ss.mkdict(["w",f])),dojo.marginBox(this.domUpperBound,ss.mkdict(["w",f])),this.domLowerInput.style.width=dojo.contentBox(this.domLowerBound).w+"px",this.domUpperInput.style.width=dojo.contentBox(this.domUpperBound).w+"px",c=this.domLowerBound.offsetTop+this.domLowerBound.offsetHeight+8,dojo.marginBox(this.domBar,ss.mkdict(["w",n.w-24])),this.domBar.style.top=c+"px",this.domBar.style.left="12px")):o?(this.domNode.classList.add(this.classQFHideReadout),this.domNode.classList.remove(this.classQFHideSlider),dojo.marginBox(this.domBar,ss.mkdict(["w",n.w-24])),this.domBar.style.left="12px",this.domBar.style.top="7px"):s?(this.domNode.classList.remove(this.classQFHideReadout),this.domNode.classList.add(this.classQFHideSlider),e=Math.min(t,Math.floor(n.w/2-4)),dojo.marginBox(this.domLowerBound,ss.mkdict(["w",e])),dojo.marginBox(this.domUpperBound,ss.mkdict(["w",e])),this.domLowerInput.style.width=tab.DomUtil.getContentBox(this.domLowerBound).w+"px",this.domUpperInput.style.width=tab.DomUtil.getContentBox(this.domUpperBound).w+"px"):(this.domNode.classList.add(this.classQFHideSlider),this.domNode.classList.add(this.classQFHideReadout))},$d:function(){var n="tab-ctrl-formatted-border-hover";this.hasCurrentMin()?(this.domLowerText.textContent=this.getMinText(),this.domLowerText.parentNode.classList.remove(this.classQFDisabled),this.domLowerText.parentNode.classList.add(n)):(this.domLowerText.textContent=this.speciallyFormatDataValueForQuantitativeQF(this.oRangeMin),this.domLowerText.parentNode.classList.add(this.classQFDisabled),this.domLowerText.parentNode.classList.remove(n));this.hasCurrentMax()?(this.domUpperText.textContent=this.getMaxText(),this.domUpperText.parentNode.classList.remove(this.classQFDisabled),this.domUpperText.parentNode.classList.add(n)):(this.domUpperText.textContent=this.speciallyFormatDataValueForQuantitativeQF(this.oRangeMax),this.domUpperText.parentNode.classList.add(this.classQFDisabled),this.domUpperText.parentNode.classList.remove(n))},shouldShowDomContent:function(){return this.hasCurrentMax()||this.hasCurrentMin()},updateFromIcons:function(){var n,i,t,r,u;this.hasCurrentMin()&&this.$4()&&(r=this.getLowerPos(),n=r-this.oMetrics.left,t=n===0?this.getRangeMin():n===this.oMetrics.width?this.getRangeMax():this.hasCurrentMax()&&this.getLowerPos()===this.$2()?this.getCurMax():this.$a(n,this.oMetrics.width,ss.unbox(this.getRangeMin())||0),ss.isValue(t)&&this.setMinValue(ss.unbox(t)),this.lastLowerOffset=this.domLowerImg.offsetLeft,this.domRange.style.left=r+"px");i=this.hasCurrentMin()?this.getLowerPos():this.oMetrics.left;this.hasCurrentMax()?(u=this.$2()-i,this.$5()&&(n=this.oMetrics.right-this.$2(),t=n===0?this.getRangeMax():n===this.oMetrics.width?this.getRangeMin():this.hasCurrentMin()&&this.getLowerPos()===this.$2()?this.getCurMin():this.$a(-n,this.oMetrics.width,ss.unbox(this.getRangeMax())||0),ss.isValue(t)&&this.setMaxValue(ss.unbox(t)),this.lastUpperOffset=this.domUpperImg.offsetLeft),this.domRange.style.width=u+"px"):this.domRange.style.width=this.oMetrics.right-i+"px";this.updateDataBar()},doMenu:function(){this.showContextMenu(this.menuButton)},doDomainMenu:function(){this.showDomainMenu(this.domainButton)},updateFromOneInput:function(n){var t,i;ss.referenceEquals(n,this.domLowerInput)?(t=this.hasCurrentMin()?this.getValueFromInput(this.domLowerInput,this.oCurrentMin):Number.MIN_VALUE,i=this.oCurrentMax.v):(t=this.oCurrentMin.v,i=this.hasCurrentMax()?this.getValueFromInput(this.domUpperInput,this.oCurrentMax):Number.MAX_VALUE);this.updateMinAndMax(t,i)},updateMinAndMax:function(n,t){var r,e,i,u,o,f;ss.isValue(n)&&ss.isValue(t)&&ss.unbox(n)>ss.unbox(t)&&(e=n,n=t,t=e);this.removeRangeOverride();this.hasCurrentMin()&&ss.isValue(n)&&!isNaN(ss.unbox(n))&&this.setMinValue(ss.unbox(n));this.hasCurrentMax()&&ss.isValue(t)&&!isNaN(ss.unbox(t))&&this.setMaxValue(ss.unbox(t));i=this.getRange();r=this.oMetrics.left;this.hasCurrentMin()?(u=ss.isValue(i)&&!tab.DoubleUtil.isApproximatelyZero(ss.unbox(i))?Math.round((ss.coalesce(this.getCurMin(),0)-ss.coalesce(this.getRangeMin(),0))*this.oMetrics.width/ss.unbox(i)):0,this.oMetrics.left+u>this.oMetrics.width&&(u=this.oMetrics.left+this.oMetrics.width),this.setLowerPos(this.oMetrics.left+u),this.lastLowerOffset=this.domLowerImg.offsetLeft,this.domRange.style.left=this.oMetrics.left+u+"px",r=this.getLowerPos()):this.domRange.style.left=r+"px";this.hasCurrentMax()?(o=this.hasCurrentMin()?this.getCurMin():this.getRangeMin(),f=ss.isValue(i)&&!tab.DoubleUtil.isApproximatelyZero(ss.unbox(i))?Math.round((ss.coalesce(this.getCurMax(),0)-ss.unbox(o))*this.oMetrics.width/ss.unbox(i)):this.oMetrics.width,this.setUpperPos(r+f),this.lastUpperOffset=this.domUpperImg.offsetLeft,this.domRange.style.width=Math.max(f,0)+"px"):this.domRange.style.width=Math.max(this.oMetrics.right-r,0)+"px";this.updateDataBar()},updateDataBar:function(){var i=0,t,r,n=this.getRange(),u,f;ss.isValue(n)&&!tab.DoubleUtil.isApproximatelyZero(ss.unbox(n))&&this.hasDataMin()&&(u=ss.coalesce(this.hasCurrentMin()?this.getCurMin():this.getRangeMin(),0),i=Math.round((ss.coalesce(this.getDataMin(),0)-u)*this.oMetrics.width/ss.unbox(n)));this.domHighlight.style.left=i+"px";r=this.hasCurrentMin()?this.getLowerPos():this.oMetrics.left;t=(this.hasCurrentMax()?this.$2():this.oMetrics.right)-r;ss.isValue(n)&&this.hasDataMax()&&(f=this.hasDataMin()?this.getDataMin():this.getRangeMin(),tab.DoubleUtil.isApproximatelyZero(ss.unbox(n))||(t=Math.round((ss.coalesce(this.getDataMax(),0)-ss.unbox(f))*this.oMetrics.width/ss.unbox(n))),t=Math.max(t,2));this.domHighlight.style.width=Math.max(t,0)+"px"},startUpperCapture:function(n){this.startCapture(n,!1,this.domUpperImg)},startLowerCapture:function(n){this.startCapture(n,!1,this.domLowerImg)},startRangeCapture:function(n){this.hasCurrentMin()&&this.hasCurrentMax()&&this.startCapture(n,!0,this.domRange)},startCapture:function(n,t,i){var u,r;(this.savePreviousMinAndMaxVals(),u=t?ss.mkdel(this,this.$8):ss.mkdel(this,this.onMouseMove),spiff.EventUtil.stopEvent(n),r=this.getRange(),ss.isValue(r)&&!tab.DoubleUtil.isApproximatelyZero(ss.unbox(r)))&&(this.captureInfo={x:n.pageX,y:n.pageY,xStart:i.offsetLeft,isRangeCapture:t,oImg:i},t&&(this.captureInfo.lowerStart=this.getLowerPos(),this.captureInfo.upperStart=this.$2()),ss.isValue(this.$p)&&this.$p.dispose(),this.$p=new tab.DisposableHolder,this.$p.add$1(spiff.EventUtil.bindWithDispose($(document),"mousemove",u)),this.$p.add$1(spiff.EventUtil.bindWithDispose($(document),"mouseup",ss.mkdel(this,this.$e))),this.$p.add$1(spiff.EventUtil.bindWithDispose($(document),"mouseleave",ss.mkdel(this,this.$e))))},onMouseMove:function(n){var r=this.hasCurrentMin()?this.getLowerPos():this.oMetrics.left,u=this.hasCurrentMax()?this.$2():this.oMetrics.right,f=ss.referenceEquals(this.captureInfo.oImg,this.domLowerImg)?this.oMetrics.left-this.$n:r,e=ss.referenceEquals(this.captureInfo.oImg,this.domUpperImg)?this.oMetrics.right:u-this.$n,t=n.pageX-this.captureInfo.x+this.captureInfo.xStart-this.oMetrics.absOffset,i;spiff.EventUtil.stopEvent$2(n);t=Math.min(e,Math.max(f,t));i=!1;ss.referenceEquals(this.captureInfo.oImg,this.domLowerImg)?(i=t+this.$n!==r,this.setLowerPos(t+this.$n)):(i=t!==u,this.setUpperPos(t));this.updateFromIcons();i&&this.applyQuantFilter(this.getCurMin(),this.getCurMax())},applyQuantFilter:function(n,t){var i=new tab.QuantitativeFilterData(this.oFilter.targetSheets,this.get_field(),n,t,this.previousMinVal,this.previousMaxVal),r=!1;(tab.FeatureFlags.isEnabled("DisableVizOnNonFastFilter")||tab.ApplicationModel.get_instance().get_isDesktopRenderMode())&&(r=this.handleVizDisabledViews(tab.FilterClientCommands.isCurrentlyWithinLocalFilterDomain(i)));tab.ApplicationModel.get_instance().get_isLocalRenderMode()?tab.FilterClientCommands.updateQuantitativeFilter(i):tab.ApplicationModel.get_instance().get_isDesktopRenderMode()&&this.applyQuantFilterForDesktopRenderMode(n,t,tab.VisualInteropObjectFactory.get_instance(),r)},applyQuantFilterForDesktopRenderMode:function(n,t,i,r){var u,e,f,h,c;if(r){u=this.previousMinVal;ss.isNullOrUndefined(u)&&(u=ss.unbox(this.getDataMin()));e=u;f=this.previousMaxVal;ss.isNullOrUndefined(f)&&(f=ss.unbox(this.getDataMax()));var o=f,l=ss.coalesce(n,e),a=ss.coalesce(t,o),s=this.oFilter.targetSheets;if(ss.isValue(i)){h=ss.referenceEquals(this.getVisualIDForSession().worksheet,this.getVisualIDForSession().dashboard)?null:this.getVisualIDForSession().dashboard;c=tab.MiscUtil.isNullOrEmpty$1(this.getVisualIDForSession().storyboard)?null:this.getVisualIDForSession().storyboard;i.onSlidingQuantitativeFilter(new tab.QuantitativeFilterParameters(s,this.get_field(),l,a,e,o,h,c))}tab.RenderingPerfUtils.dispatchMultiVizRenderingPerfEvent(s,"viz",tab.RenderingPerfUtils.startFilterEventType)}},handleVizDisabledViews:function(n){var t=!1;return this.canFastFilterBySheetNamePromise.state()==="resolved"?this.canFastFilterBySheetNamePromise.done(ss.mkdel(this,function(i){var r=function(t){return n&&ss.keyExists(i,t)&&i[t]};t=this.$f(r)})):t=!0,t},$f:function(n){for(var t,u=!1,i=this.getVizDisabledViews(),r=0;r<this.oFilter.targetSheets.length;r++)if(t=this.oFilter.targetSheets[r],ss.keyExists(i,t))n(t)?(u=!0,i[t].toggleOff()):i[t].toggleOn();else continue;return u},getVizDisabledViews:function(){for(var i,r,n,u,e,f={},t=0;t<this.oFilter.targetSheets.length;t++)for(i=this.oFilter.targetSheets[t],r=tab.Application.get_instance().get_client().get_viewControllers(),n=0;n<r.length;n++)u=r[n],ss.referenceEquals(i,u.get_sheetName())&&(e=u.get_viewWidget(),f[i]=e.get_vizDisabledView());return f},getVisualIDForSession:function(){return this.session.get_visualId()},savePreviousMinAndMaxVals:function(){this.previousMinVal=this.getCurMin();this.previousMaxVal=this.getCurMax()},$8:function(n){var i=this.captureInfo.x-(this.captureInfo.lowerStart-this.oMetrics.left),r=this.captureInfo.x+(this.oMetrics.right-this.captureInfo.upperStart),t=n.pageX;t=Math.min(r,Math.max(i,t));spiff.EventUtil.stopEvent$2(n);this.setLowerPos(this.captureInfo.lowerStart+(t-this.captureInfo.x));this.setUpperPos(this.captureInfo.upperStart+(t-this.captureInfo.x));tab.ModelUtils.invalidateVisuals(this.oFilter.targetSheets);this.updateFromIcons()},$e:function(n){this.$f(function(){return!0});ss.isValue(this.$p)&&this.$p.dispose();this.$p=null;spiff.EventUtil.stopEvent$2(n);this.captureInfo.x!==n.pageX&&(this.updateFromIcons(),this.notifyChange())},showLowerInput:function(n){this.hasCurrentMin()&&(this.showInput(n,this.oCurrentMin,this.domLowerInput),this.domLowerBound.classList.add("active"),this.savePreviousMinAndMaxVals())},showUpperInput:function(n){this.hasCurrentMax()&&(this.showInput(n,this.oCurrentMax,this.domUpperInput),this.domUpperBound.classList.add("active"),this.savePreviousMinAndMaxVals())},showInput:function(n,t,i){(spiff.EventUtil.stopEvent(n),$(i).css("display")==="none")&&(i.value=tableau.format.formatDataValue(tab.LegacyFilterModel.buildDataValueFromFilterValue(t),this.oFilter.role,this.get_editingFormat(),null,this.showFullDateTimes(this.get_editingFormat(),null)),this.showInputStartValue=this.getValueFromInput(i,t),$(i).show().siblings(".readoutText").hide(),i.focus(),i.select())},lowerInputKeyDown:function(n){this.$7(n,this.domLowerInput)},upperInputKeyDown:function(n){this.$7(n,this.domUpperInput)},$7:function(n,t){n.which===27&&($(t).val(""),t.blur())},checkLowerEnter:function(n){v.$0(n,this.domLowerInput)},checkUpperEnter:function(n){v.$0(n,this.domUpperInput)},handleContextMenuForDomLowerBound:function(n){spiff.EventUtil.stopEvent$2(n)},handleContextMenuForDomUpperBound:function(n){spiff.EventUtil.stopEvent$2(n)},hideLowerInput:function(n){this.$6(n,this.oCurrentMin,this.domLowerInput,this.domLowerBound)},hideUpperInput:function(n){this.$6(n,this.oCurrentMax,this.domUpperInput,this.domUpperBound)},$6:function(n,t,i,r){var u=this.getValueFromInput(i,t);spiff.EventUtil.stopEvent$2(n);this.applyInputValue(t,i,r,u,ss.mkdel(this,function(){this.updateFromOneInput(i)}))},applyInputValue:function(n,t,i,r,u){var f={},e,o;f=$.extend({},n);e=null;ss.isNullOrUndefined(r)||isNaN(ss.unbox(r))?r=this.showInputStartValue:(f.v=ss.unbox(r),e=this.speciallyFormatDataValueForQuantitativeQF(f));o=$(t).hide().siblings(".readoutText").show();ss.isValue(r)&&ss.isValue(this.showInputStartValue)&&!tab.DoubleUtil.isApproximatelyEqual(ss.unbox(this.showInputStartValue),ss.unbox(r))&&(o.text(e),u(),this.notifyChange());this.showInputStartValue=null;i.classList.remove("active")},getFilterValueAtResolution:function(n){return n},applyChanges:function(){var t=!1,n=$.extend(!1,{},this.oFilter.table),i,r;if(!this.hasCurrentMin()||ss.isValue(n.min.v)&&tab.DoubleUtil.isApproximatelyEqual(ss.unbox(n.min.v),ss.unbox(this.getCurMin()))||(t=!0,n.min=$.extend({},this.oCurrentMin)),!this.hasCurrentMax()||ss.isValue(n.max.v)&&tab.DoubleUtil.isApproximatelyEqual(ss.unbox(n.max.v),ss.unbox(this.getCurMax()))||(t=!0,n.max=$.extend({},this.oCurrentMax)),!t){tab.FilterClientCommands.resetQuantitativeFilter(this.get_field(),this.oFilter.targetSheets);return}this.clearDataRange();++this.rid;this.isRange()||(n.included=this.$i()==="include-non-null"?"include-range":"include-range-or-null");i=this.getFilterValueAtResolution(n.min.v);r=this.getFilterValueAtResolution(n.max.v);tab.FilterClientCommands.setQuantitativeFilterRange(this.get_visualId(),this.get_field(),i,r,n.included);this.$3(i,r)},updateDomainButton:function(){if(!ss.isValue(this.oFilter.domains)||this.oFilter.domains.length<=1){this.domainButton.domNode.style.display="none";return}this.$h();this.$g()},$h:function(){if(ss.isInstanceOfType(this.filterViewModel,oi)){var n=this.filterViewModel;this.domainButton.attr("label",n.get_domainButtonTooltipText())}},$g:function(){var n=this.domainButton.iconNode.classList;n.add("wcIconDomainAll")},toggleReset:function(){var r=this.oFilter.table,n=ss.isValue(r.min.v),u=ss.isValue(r.max.v),t,i;!n&&u||!u&&n?(t=null,i=null,n?t=this.getRangeMin():i=this.getRangeMax(),tab.FilterClientCommands.setQuantitativeFilterRange(this.get_visualId(),this.get_field(),t,i,this.$i())):tab.FilterClientCommands.setQuantitativeFilterRange(this.get_visualId(),this.get_field(),null,null,"include-all");p.disableResetButton(this.resetButton,!1)},toggleDomain:function(){var t=function(n){return n==="context"},n,i=this.attributes.values;switch(i){case"relevant":n="all";break;case"context":n="relevant";break;case"all":default:n=_.any(this.oFilter.domains,t)?"context":"relevant"}this.doRequestSetAttributes(ss.mkdict(["values",n.toString()]),!1)},doRequestSetAttributes:function(n,t){var i=ss.getEnumerator(Object.keys(n)),r;try{while(i.moveNext())r=i.current(),this.attributes[r]=n[r]}finally{i.dispose()}tab.ApplicationModel.get_instance().get_autoUpdate()||this.initFromState();this.requestSetAttributes(n,t)},notifyChange:function(){this.$k=tab.MiscUtil.clearTimeout(this.$k);this.$k=window.setTimeout(ss.mkdel(this,this.applyChanges),this.$j)},initFromState:function(){this.$9();this.layout(null)},localize:function(){},contentBox:function(n){var t=$(n).css("display"),i;return t==="none"&&(n.style.display=""),i=dojo.contentBox(n),n.style.display=t,i}},{$0:function(n,t){n.keyCode===13&&(spiff.EventUtil.stopEvent(n),t.blur())}}),oi=global.tab.LegacyQuantitativeQuickFilterViewModel=ss.mkType(t,"tab.LegacyQuantitativeQuickFilterViewModel",function(n){this.$0=null;spiff.BaseViewModel.call(this);this.$0=n},{get_filterType:function(){return this.$0.get_filterType()},get_legacyQuantitativeQuickFilterModel:function(){return this.$0},get_range:function(){return this.$0.get_range()},get_data:function(){return this.$0.get_data()},get_dateFormat:function(){return this.$0.get_dateFormat()},get_editingFormat:function(){return this.$0.get_editingFormat()},get_format:function(){return this.$0.get_format()},get_calendarControlStartOfWeek:function(){return this.$0.get_calendarControlStartOfWeek()},get_dataSourceStartOfWeek:function(){return this.$0.get_dataSourceStartOfWeek()},get_quantitativeFilterTable:function(){return this.$0.get_quantitativeFilterTable()},get_column:function(){return this.get_quantitativeFilterTable().column},get_included:function(){return this.get_quantitativeFilterTable().included},get_min:function(){return this.get_quantitativeFilterTable().min},get_max:function(){return this.get_quantitativeFilterTable().max},get_domainType:function(){return this.$0.get_domainType()},get_domainButtonTooltipText:function(){var n=this.get_domainType();return n===tableau.types.QFDomain.QFD_RELEVANT?tab.Strings.QuickFilterDomainRelevant:n===tableau.types.QFDomain.QFD_CONTEXT?tab.Strings.QuickFilterDomainContext:n===tableau.types.QFDomain.QFD_CASCADING?tab.Strings.QuickFilterDomainCascading:n===tableau.types.QFDomain.QFD_CASCADING_CONTEXT?tab.Strings.QuickFilterDomainCascadingContext:tab.Strings.QuickFilterDomainDatabase}}),au=global.tab.LegacyQuickFilterDisplayView=ss.mkType(t,"tab.LegacyQuickFilterDisplayView",function(n){this.$f=null;ss.makeGenericType(spiff.BaseView$1,[rt]).call(this,n,new yi);this.$e().add_updateQuickFilterDisplay(ss.mkdel(this,this.$9));this.$e().add_resized(ss.mkdel(this,this.$d));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$e().remove_updateQuickFilterDisplay(ss.mkdel(this,this.$9))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$e().remove_resized(ss.mkdel(this,this.$d))})));this.$e().add_updateQuickFilterContent(ss.mkdel(this,this.$8));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$e().remove_updateQuickFilterContent(ss.mkdel(this,this.$8))})));tsConfig.is_authoring&&!tsConfig.is_mobile&&tsConfig.features.HybridFormatPane&&tsConfig.features.MttwFilterFormatting&&tsConfig.features.MttwContextualFormatting&&this.disposables.add$1(spiff.TableauClickHandler.targetAndClick(this.element[0],ss.mkdel(this,this.handleSingleClick)));this.$e().get_hasBorder()&&this.get_template().domRoot.addClass("tabBordered")},{get_zoneModel:function(){return this.$e().get_zoneModel()},get_domRoot:function(){return this.get_template().domRoot},$e:function(){return this.get_viewModel()},dispose:function(){ss.isValue(this.$f)&&(this.$f.destroyRecursiveShim(!1),this.$f=null);ss.makeGenericType(spiff.BaseView$1,[rt]).prototype.dispose.call(this)},onAddedToDom:function(){spiff.Widget.prototype.onAddedToDom.call(this);ss.isValue(this.$e().get_quickFilterDisplayModel())&&this.$9()},$9:function(){(ss.isNullOrUndefined(this.$f)||this.$e().get_needToUpdateDisplay())&&(ss.isNullOrUndefined(this.$f)?(this.$f=this.$7(),this.get_template().domRoot.append(this.$f.getDomNode()),this.$f.startupShim()):this.$c(),this.$d(),this.$8())},$8:function(){ss.isValue(this.$f)&&(this.$e().get_needToUpdateContent()||this.$e().get_needToUpdateDisplay())&&(this.$f.updateAttributesShim(this.$e().get_quickFilterDisplayModel().get_attributes()),this.$f.updateFilterStateShim(this.$e().get_filterPresModel()))},$d:function(){tab.DomUtil.resize(this.$f,this.get_zoneModel().get_zoneContentBounds());this.$f.setTitleSizeShim(this.$e().get_zoneTitleHeight(),this.$e().get_zoneTitleWidth())},$7:function(){var n=this.$a();return this.makeFilterPanel(n)},$c:function(){var n=this.$a();this.$f.updateFilterPropertiesShim(n);this.$f.updateSubWidgetShim(this.$e().get_filterPresModel())},$a:function(){var r=this.$e().get_layoutSession(),o=this.$e().get_zoneModel().get_worksheetName(),i={},n,t,u,f,e;return i.sessionid=r.get_id(),i.urlRoot=r.get_urlRoot(),i.layoutSession=r,i.sheetid=o,n=i,t=this.$e().get_quickFilterDisplayModel(),n.titleHTML=this.get_zoneModel().get_zoneCommonModel().get_hasTitle()?t.get_quickFilterTitle().html:"",n.session=this.$e().get_viewSession(),u=t.get_fieldName(),f=t.get_membershipTarget(),n.field=u,n.membershipTarget=f,n.quickFilterDisplayViewModel=this.$e(),ss.isValue(t.get_attributes())&&(n.attributes=t.get_attributes()),ss.isValue(t.get_width())&&(n.width=t.get_width()),e=ss.mkdel(this,function(n,t){this.$b(new tab.QuickFilterIdentifier(u,f),this.$e().get_visualId(),n,t)}),n.requestSetAttributes=e,n.textStyle=this.$e().get_quickFilterDisplayPresModel().textStyle,ss.isValue(this.get_zoneModel().pm.zoneCommon.styledBox)&&(n.backgroundColor=this.get_zoneModel().get_zoneCommonModel().get_zoneStyle().get_fillColor()),n.blendedZoneContentColor=this.get_zoneModel().get_blendedZoneContentColor(),n},makeFilterPanel:function(n){var t=tab.ObjectRegistry.resolve(tab.ILegacyDojoWidgetMaker).call(null,[]);return t.makeFilterPanelWidget(n)},$b:function(n,t,i){ss.keyExists(i,"mode")?tab.FilterClientCommands.setCategoricalQuickFilterMode(t,n,i.mode):ss.keyExists(i,"values")&&tab.FilterClientCommands.setCategoricalQuickFilterDomain(t,n,i.values)},handleSingleClick:function(){var n={};n.formattingCtx="filters";tab.WebCommandRegistry.get_instance().createCommandWithParams(tab.WebFormatPaneCmd.cmdId,n).invoke()}}),rt=global.tab.LegacyQuickFilterDisplayViewModel=ss.mkType(t,"tab.LegacyQuickFilterDisplayViewModel",function(n,t){this.$8=null;this.$4=null;this.$6=!0;this.$7=!0;this.$5=null;this.$2$1=null;this.$2$2=null;this.$2$3=null;spiff.BaseViewModel.call(this);this.$4=t;this.$4.add_filterUpdated(ss.mkdel(this,this.$3));this.$8=n;this.$8.add_quickFilterDisplayUpdated(ss.mkdel(this,this.handleUpdateQuickFilterDisplay));this.$8.get_zoneModel().get_zoneCommonModel().add_resizeZone(ss.mkdel(this,this.$2));this.$1()},{add_updateQuickFilterDisplay:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_updateQuickFilterDisplay:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},add_updateQuickFilterContent:function(n){this.$2$2=ss.delegateCombine(this.$2$2,n)},remove_updateQuickFilterContent:function(n){this.$2$2=ss.delegateRemove(this.$2$2,n)},add_resized:function(n){this.$2$3=ss.delegateCombine(this.$2$3,n)},remove_resized:function(n){this.$2$3=ss.delegateRemove(this.$2$3,n)},get_handlingOfContextMenuEventsRequired:function(){if(!tab.DefaultHandlingOfContextMenuEventsOnDashboard.get_isSupported())return!1;var n=this.get_quickFilterType();return n==="categorical"?tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_CategoricalFilter"):n==="quantitative"?tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_LegacyQuantitativeQuickFilter"):n==="relative-date"?tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_LegacyRelativeDateQuickFilter"):!1},get_quickFilterDisplayModel:function(){return this.$8},get_zoneModel:function(){return this.$8.get_zoneModel()},get_quickFilterDisplayPresModel:function(){return this.$8.get_quickFilterDisplayPresModel()},get_quickFilterType:function(){var n=this.get_quickFilterDisplayPresModel();return ss.isValue(n)&&ss.isValue(n.quickFilter)?n.quickFilter.quickFilterType:"unknown"},get_viewSession:function(){return tab.ModelUtils.getViewSession(this.get_zoneModel().get_worksheetName())},get_layoutSession:function(){return tab.CommandController.get().legacySession},get_zoneTitleHeight:function(){if(!this.get_zoneModel().get_zoneCommonModel().get_hasTitle()||this.get_zoneModel().get_titleHeight()===0)return 0;var n=this.get_quickFilterDisplayPresModel().quickFilterTitle.h;return n>0&&(this.get_hasBorder()&&(n+=3),n=Math.max(n,17)),n},get_zoneTitleWidth:function(){return!this.get_zoneModel().get_zoneCommonModel().get_hasTitle()||this.get_zoneModel().get_titleWidth()===0?0:this.get_quickFilterDisplayPresModel().quickFilterTitle.w},get_hasBorder:function(){return this.$8.get_zoneModel().get_hasBorder()},get_filterPresModel:function(){return ss.isValue(this.$8.get_fakeFilterPresModel())?this.$8.get_fakeFilterPresModel():this.$4.get_filterPresModel()},get_filterTypeViewModel:function(){return this.$5},get_needToUpdateContent:function(){return this.$6},set_needToUpdateContent:function(n){this.$6=n},get_needToUpdateDisplay:function(){return this.$7},set_needToUpdateDisplay:function(n){this.$7=n},get_visualId:function(){return tab.ModelUtils.getVisualId(this.get_zoneModel().get_worksheetName())},handleUpdateQuickFilterDisplay:function(){this.set_needToUpdateDisplay(!0);_.defer(ss.mkdel(this,function(){this.raiseActionEvent(this.$2$1);this.set_needToUpdateDisplay(!1)}))},$2:function(){this.raiseActionEvent(this.$2$3)},$3:function(){this.set_needToUpdateContent(!0);_.defer(ss.mkdel(this,function(){this.raiseActionEvent(this.$2$2);this.set_needToUpdateContent(!1)}))},$1:function(){this.$0();switch(this.$4.get_filterType()){case"Categorical":this.$5=new hr(this.$4);break;case"Hierarchical":this.$5=new cr(this.$4);break;case"Quantitative":this.$5=new oi(this.$4);break;case"RelativeDate":case"RelativeDatePick":this.$5=new dr(this.$4)}},$0:function(){ss.isValue(this.$5)&&(this.$5.dispose(),this.$5=null)},dispose:function(){this.$8.remove_quickFilterDisplayUpdated(ss.mkdel(this,this.handleUpdateQuickFilterDisplay));this.$8.get_zoneModel().get_zoneCommonModel().remove_resizeZone(ss.mkdel(this,this.$2));this.$8=null;this.$4.remove_filterUpdated(ss.mkdel(this,this.$3));this.$4=null;this.$0();spiff.BaseViewModel.prototype.dispose.call(this)}}),h=global.tab.LegacyQuickFilterWidget=ss.mkType(t,"tab.LegacyQuickFilterWidget",function(){this.titleHTML=null;this.backgroundColor=null;this.blendedZoneContentColor=null;this.textStyle=null;this.domTitleBar=null;this.oFilter=null;this.titleH=0;this.titleW=0;Object.call(this)},{updateFilterProperties:function(n){this.titleHTML=n.titleHTML;this.backgroundColor=n.backgroundColor;this.blendedZoneContentColor=n.blendedZoneContentColor;this.textStyle=n.textStyle},hideEmptyTitlebar:function(){return ss.isNullOrEmptyString(this.titleHTML)},unformattedDisplayName:function(){return this.hideEmptyTitlebar()?"":i.formatColumnDisplayName(this.oFilter,!1,!1)},updateTitleBar:function(){this.domTitleBar.innerHTML=this.titleHTML;tab.FormattingConverters.cleanUpFontFamilyStyles($(this.domTitleBar))},setTitleSize:function(n,t){this.titleH=n;this.titleW=t},layoutTitleBar:function(){var n=dojo.marginBox(this.domTitleBar),t;return this.$0(),t=this.titleH===0&&this.titleW===0,(this.titleH>0||t)&&(n.h=this.titleH,this.domTitleBar.style.height=n.h+"px"),(this.titleW>0||t)&&(n.w=this.titleW,this.domTitleBar.style.width=n.w+"px"),tableau.util.setupTitleEllipsis($(this.domTitleBar)),n},$0:function(){ss.isValue(this.domTitleBar)&&$(this.domTitleBar).css({height:"auto",width:"auto"})}}),u=global.tab.LegacyRelativeDateQuickFilter=ss.mkType(t,"tab.LegacyRelativeDateQuickFilter",function(){this.templateString="<div class='RelativeDateFilter'><div class='RelativeDateFilterBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='RDFButton RDFMenuButton' name='type' dojoAttachPoint='menuButton'dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'><\/div><\/div><div dojoType='dijit.form.DropDownButton' dojoAttachPoint='domDropdownButton'><span class='RDText'>date description<\/span><div dojoType='dijit.TooltipDialog' dojoAttachPoint='domTooltipDialog'><div class='RelativeDateFilterDialog' dojoAttachPoint='domDialog'><div class='RangeButtonsBar'><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPYear'dojoAttachPoint='buttonYear' name='year'>Years<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPQuarter'dojoAttachPoint='buttonQuarter' name='quarter'>Quarters<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPMonth'dojoAttachPoint='buttonMonth' name='month'>Months<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPWeek'dojoAttachPoint='buttonWeek' name='week'>Weeks<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPDay'dojoAttachPoint='buttonDay' name='day'>Days<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPHour'dojoAttachPoint='buttonHour' name='hour'>Hours<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPMinute'dojoAttachPoint='buttonMinute' name='minute'>Minutes<\/div><\/div><div class='vertSpacer topHR'><\/div><div class='radioLine'><label class='column1'><input class='rradio' aria-describedby='rdf-preview' type='radio' name='radio-${field}' value='last'dojoAttachPoint='radioLast' dojoAttachEvent='onclick:setRLast'><\/input><div class='fakeRadio'><\/div><span class='rlabel' dojoAttachPoint='textLast' dojoAttachEvent='onclick:setRLast'><\/span><\/label><label class='column2' id='rdf-Lastn-label'><input class='rradio' aria-describedby='rdf-preview' type='radio' name='radio-${field}' value='lastn'dojoAttachPoint='radioLastn' dojoAttachEvent='onclick:setRLastn'><\/input><div class='fakeRadio'><\/div><span class='rlabel alignLN' dojoAttachPoint='textLastn1' dojoAttachEvent='onclick:setRLastn'><\/span><input class='rtext' type='text' size='2' aria-describedby='rdf-Lastn-label' dojoAttachPoint='inputLastn' value='3'dojoAttachEvent='onkeyup:onTypingLast'><\/input><span class='spinner' dojoAttachPoint='lastSpinner'><div class='spinnerElement spinnerUp' dojoAttachPoint='lastUp'dojoAttachEvent='onmouseover:overLastUp,onmouseout:outLastUp,onclick:upLast'><\/div><div class='spinnerElement spinnerDown' dojoAttachPoint='lastDown'dojoAttachEvent='onmouseover:overLastDown,onmouseout:outLastDown,onclick:downLast'><\/div><\/span><span class='rlabel' dojoAttachPoint='textLastn2' dojoAttachEvent='onclick:setRLastn'><\/span><\/label><\/div><div class='radioLine'><label class='column1'><input class='rradio' aria-describedby='rdf-preview' type='radio' name='radio-${field}' value='curr'dojoAttachPoint='radioCurr' dojoAttachEvent='onclick:setRCurr'><\/input><div class='fakeRadio'><\/div><span class='rlabel' dojoAttachPoint='textCurr' dojoAttachEvent='onclick:setRCurr'><\/span><\/label><label class='column2' id='rdf-Nextn-label'><input class='rradio' aria-describedby='rdf-preview' type='radio' name='radio-${field}' value='nextn'dojoAttachPoint='radioNextn' dojoAttachEvent='onclick:setRNextn'><\/input><div class='fakeRadio'><\/div><span class='rlabel alignLN' dojoAttachPoint='textNextn1' dojoAttachEvent='onclick:setRNextn'><\/span><input class='rtext' type='text' size='2' aria-describedby='rdf-Nextn-label' dojoAttachPoint='inputNextn' value='3'dojoAttachEvent='onkeyup:onTypingNext'><\/input><span class='spinner' dojoAttachPoint='nextSpinner'><div class='spinnerElement spinnerUp' dojoAttachPoint='nextUp'dojoAttachEvent='onmouseover:overNextUp,onmouseout:outNextUp,onclick:upNext'><\/div><div class='spinnerElement spinnerDown' dojoAttachPoint='nextDown'dojoAttachEvent='onmouseover:overNextDown,onmouseout:outNextDown,onclick:downNext'><\/div><\/span><span class='rlabel' dojoAttachPoint='textNextn2' dojoAttachEvent='onclick:setRNextn'><\/span><\/label><\/div><div class='radioline'><label class='column1'><input class='rradio' aria-describedby='rdf-preview' type='radio' name='radio-${field}' value='next'dojoAttachPoint='radioNext' dojoAttachEvent='onclick:setRNext'><\/input><div class='fakeRadio'><\/div><span class='rlabel' dojoAttachPoint='textNext' dojoAttachEvent='onclick:setRNext'><\/span><\/label><label class='column2'><input class='rradio' aria-describedby='rdf-preview' type='radio' name='radio-${field}' value='todate'dojoAttachPoint='radioTodate' dojoAttachEvent='onclick:setRTodate'><\/input><div class='fakeRadio'><\/div><span class='rlabel' dojoAttachPoint='textTodate' dojoAttachEvent='onclick:setRTodate'><\/span><\/label><\/div><div class='vertSpacer bottomHR'><\/div><div class='preview' id='rdf-preview'><span dojoAttachPoint='domPreview'><\/span><\/div><\/div><\/div><\/div><\/div><\/div>";this.widgetsInTemplate=!0;this.session=null;this.field="";this.filterViewModel=null;this.stateId=0;this.rid=0;this.timestamp=0;this.$b=[];this.layoutSession=null;this.getContextMenuCommands=null;this.showContextMenu=null;this.domText=null;this.domDropdownButton=null;this.domDialog=null;this.$c=[];this.buttonYear=null;this.buttonQuarter=null;this.buttonMonth=null;this.buttonWeek=null;this.buttonDay=null;this.buttonHour=null;this.buttonMinute=null;this.radioLast=null;this.radioCurr=null;this.radioNext=null;this.radioLastn=null;this.radioNextn=null;this.lastSpinner=null;this.nextSpinner=null;this.lastUp=null;this.lastDown=null;this.nextUp=null;this.nextDown=null;this.domNode=null;this.domTooltipDialog=null;this.menuButton=null;this.$9="RDFButtonR1";this.$8="RDFButtonHide";this.$a=new tab.DisposableHolder;this.getSID=null;this.attributes=null;this.requestSetAttributes=null;vt.call(this)},{postCreate:function(){if(this.filterViewModel.get_filterType()!=="RelativeDate",this.$5(),this.getSID=ss.mkdel(this,function(){return this.stateId}),ss.isValue(this.oFilter.fy)&&(this.fy=this.oFilter.fy-1),ss.isValue(this.oFilter.start_of_week)&&(this.startOfWeek=this.oFilter.start_of_week),this.timestamp=(new Date).getTime(),this.$c=[this.buttonYear,this.buttonQuarter,this.buttonMonth,this.buttonWeek,this.buttonDay],this.oFilter.noTime?(this.buttonHour.domNode.style.display="none",this.buttonMinute.domNode.style.display="none"):(this.$c.push(this.buttonHour),this.$c.push(this.buttonMinute)),this.connect(this.domTooltipDialog,"onOpen",ss.mkdel(this,this.$6)),this.initFromState(),$(this.menuButton.domNode).css("background-color",this.backgroundColor),tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_LegacyRelativeDateQuickFilter")){var n=$(this.domDropdownButton.domNode);this.$a.add$1(spiff.EventUtil.bindWithDispose(n,"contextmenu",ss.mkdel(this,this.preventContextMenu)))}},preventContextMenu:function(n){spiff.EventUtil.stopEvent$2(n)},$3:function(){$(this.domDialog).toggleClass("focus-visible",!spiff.FocusManager.wasFocusedByPointer())},$4:function(n){var t=n,i;t.which===27?(this.domDropdownButton._closeDropDown(!0),t.stopPropagation(),t.preventDefault()):t.which===9&&(i=$(t.currentTarget).find(":tabbable:not(input[type='radio']:not(:checked))"),ss.referenceEquals(t.target,i.last()[0])&&!t.shiftKey?(i.first().focus(),t.stopPropagation(),t.preventDefault()):ss.referenceEquals(t.target,i.first()[0])&&t.shiftKey&&(i.last().focus(),t.stopPropagation(),t.preventDefault()))},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},shouldHideDomainButton:function(){return!0},dispose:function(){this.$a.dispose();this.showContextMenu=null},destroy:function(){this.dispose();ss.isValue(this.domText)&&(this.domText.innerHTML="");this.inherited(arguments)},layout:function(){var t,e,u,o,r,s;if(this.updateTitleBar(),this.domNode.classList.remove("RDFHorizontal"),t=dojo.marginBox(this.domDialog),ss.isValue(t)&&ss.isValue(t.w)&&t.w!==0){var h=this.layoutTitleBar(),f=dojo.contentBox(this.domNode),n=f.w-6,i=$(this.domDropdownButton.domNode);for(i.find(".dijitButtonNode").addClass("tab-ctrl-formatted-widget tab-ctrl-formatted-darker-border-hover"),i.find(".dijitButtonText").addClass("tab-ctrl-formatted-fixedsize"),tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_CategoricalFilter")&&i.find(".dijitButtonNode").addClass("tab-ctrl-formatted-darker-border-focus"),i.find(".dijitArrowButtonInner")[0].innerHTML=kt.getDropDownForColor(this.textStyle.color.toString()),!this.hideEmptyTitlebar()&&this.titleW>0?(this.domNode.classList.add("RDFHorizontal"),this.domTitleBar.style.cssFloat="left",this.domDropdownButton.domNode.style.cssFloat="left",e=dojo._getPadBorderExtents(this.domDropdownButton.domNode),n=f.w-h.w-e.w):(this.domTitleBar.style.cssFloat="none",this.domDropdownButton.domNode.style.cssFloat="none"),n>29&&(this.domDropdownButton.domNode.style.width=n+"px",this.domDropdownButton.domNode.firstChild.style.width=n-2+"px",n=n-25,u=this.domDropdownButton.domNode.firstChild.firstChild.firstChild.childNodes[1],ss.isValue(u)&&(u.style.width=n+"px")),o=Math.floor((t.w-10)/this.$c.length),r=0;r<this.$c.length;r++)s=this.$c[r],s.titleNode.style.width=o-5+"px"}},initFromState:function(){var i=ss.mkdel(this,function(n,t){t?(n.domNode.classList.remove(this.$9),n.domNode.classList.add(this.$8)):(n.domNode.classList.remove(this.$8),n.domNode.classList.add(this.$9))}),t,n;i(this.menuButton,this.shouldHideContextMenu());this.domDropdownButton.attr("label",this.oFilter.text);this.domTitleBar.id=tab.DomUtil.generateUniqueId();t=this.domDropdownButton.domNode.querySelector("button");t.setAttribute("aria-haspopup","dialog");t.setAttribute("aria-labelledby",this.domTitleBar.id+" "+t.id+"_label");n=this.domTooltipDialog.domNode;n.setAttribute("aria-labelledby",this.domTitleBar.id);n.setAttribute("aria-modal","true");n.addEventListener("focus",ss.mkdel(this,this.$3),!0);n.addEventListener("keydown",ss.mkdel(this,this.$4),!0);this.updateCurrentStateOfData();this.setRangeType(this.rangeType,this.rangeN);this.setTitle();this.updateTitleBar()},updateCurrentStateOfData:function(){var t=this.oFilter.table,n;this.periodType=t.periodType;this.rangeType=t.rangeType;this.rangeN=t.rangeN;typeof t.anchor=="undefined"||(n=t.anchor,this.anchorDateTime=new Date(n.year,n.month-1,n.day,n.hour,n.minute,n.second))},setTitle:function(){var n=i.formatColumnDisplayName(this.oFilter,!1,!0);this.domTitleBar.setAttribute("title",n)},applyChanges:function(){var n={},t;n.periodType=this.periodType;n.rangeType=this.rangeType;n.rangeN=this.rangeN;this.stateId+=1;t=tableau.util.findDirectParentByClassName(this.domDialog,"dijitPopup",document.body);ss.isNullOrUndefined(t)||(t.style.zIndex="980");tab.FilterClientCommands.doRelativeDateQuickFilter(this.session.get_visualId(),this.field,this.periodType,this.rangeType,this.rangeN)},doMenu:function(){this.showContextMenu(this.menuButton)},$6:function(){this.setPeriodUI(this.periodType);this.setRangeUI(this.rangeType,this.rangeN);this.setPreviewUI();this.updateVisibilityOfDayToAnchor()},setRangeUI:function(n,t){this.inputLastn.disabled=!0;this.inputNextn.disabled=!0;this.lastSpinner.style.display="none";this.radioLastn.classList.remove("spinnerBugFix");this.nextSpinner.style.display="none";this.radioNextn.classList.remove("spinnerBugFix");switch(n){case"last":this.radioLast.checked=!0;break;case"curr":this.radioCurr.checked=!0;break;case"next":this.radioNext.checked=!0;break;case"lastn":this.radioLastn.checked=!0;this.rangeN=t;this.inputLastn.value=this.rangeN.toString();this.inputLastn.disabled=!1;this.lastSpinner.style.display="";this.radioLastn.classList.add("spinnerBugFix");break;case"nextn":this.radioNextn.checked=!0;this.rangeN=t;this.inputNextn.value=this.rangeN.toString();this.inputNextn.disabled=!1;this.nextSpinner.style.display="";this.radioNextn.classList.add("spinnerBugFix");break;case"todate":this.radioTodate.checked=!0}},updateRangeButtons:function(n){for(var i=this.$c.length,t=0;t<i;t++)this.$c[t].attr("checked",ss.referenceEquals(this.$c[t].name,n.toString()))},overLastUp:function(){this.lastUp.classList.add("hover")},outLastUp:function(){this.lastUp.classList.remove("hover")},overLastDown:function(){this.lastDown.classList.add("hover")},outLastDown:function(){this.lastDown.classList.remove("hover")},overNextUp:function(){this.nextUp.classList.add("hover")},outNextUp:function(){this.nextUp.classList.remove("hover")},overNextDown:function(){this.nextDown.classList.add("hover")},outNextDown:function(){this.nextDown.classList.remove("hover")},$7:function(n,t){var i=parseInt(n.value,10)+(t?1:-1);if(!(i<1)){n.value=i.toString();this.onTyping(n)}},upLast:function(){this.$7(this.inputLastn,!0)},downLast:function(){this.$7(this.inputLastn,!1)},upNext:function(){this.$7(this.inputNextn,!0)},downNext:function(){this.$7(this.inputNextn,!1)},$5:function(){d.localizeDojoLabeledControls([{item1:this.buttonYear,item2:"RelDateFilterYears"},{item1:this.buttonQuarter,item2:"RelDateFilterQuarters"},{item1:this.buttonMonth,item2:"RelDateFilterMonths"},{item1:this.buttonWeek,item2:"RelDateFilterWeeks"},{item1:this.buttonDay,item2:"RelDateFilterDays"},{item1:this.buttonHour,item2:"RelDateFilterHours"},{item1:this.buttonMinute,item2:"RelDateFilterMinutes"}])}},{get_anchoredDescriptions:function(){return ss.isNullOrUndefined(u.$2)&&u.$0(),u.$2},get_nonAnchoredDescriptions:function(){return ss.isNullOrUndefined(u.$3)&&u.$0(),u.$3},$0:function(){var e,o,t,r,n,f;for(u.$2={},u.$3={},e=tab.Strings,o=ss.Enum.getValues(vu),t=0;t<o.length;t++){var i=o[t],s={},h={},c=ss.Enum.getValues(yu);for(r=0;r<c.length;r++)n=c[r],f=ss.formatString("RelDateAnchored_{0}_{1}",n,i),s[n]=e[f],f=ss.formatString("RelDate_{0}_{1}",n,i),h[n]=e[f];u.$2[i]=s;u.$3[i]=h}}}),lr=global.tab.ListGridModel=ss.mkType(t,"tab.ListGridModel",function(n,t,i,r){var f;this.$1=0;this.$2=0;this.$4=0;this.$6=0;this.$5=0;this.$3=0;this.$0=null;this.$1=n;this.$2=t;this.$4=i;this.$6=r;this.$5=this.$1*this.$2;this.$3=i>0?Math.ceil(n/i):0;this.$0={};var e=0,u=i*t,o=this.$5;for(f=0;f<this.$3;++f){o<u&&(u=o);var s=new tab.IntegerRange(e,e+u-1),h=tab.IntegerRange.pixelToItemRange(s,t),c=new bi(f,!1,{x:0,y:e},h,"item");this.$0[f]=c;o-=u;e+=u}},{get_totalHeight:function(){return this.$5},get_itemHeight:function(){return this.$2},get_tileCount:function(){return this.$3},get_viewportHeight:function(){return this.$6},destroy:function(){},updateViewport:function(n,t){this.$6=t},getTileStatus:function(n){var t=this.$0[n];return typeof t=="undefined"?!1:t.$0()},updateTileStatus:function(n,t){var i=this.$0[n];typeof i!="undefined"&&this.$0[n].$1(t)},getTilePosition:function(n){var t=this.$0[n];return typeof t=="undefined"?null:{x:t.$2().x,y:t.$2().y}},getTileRange:function(n){var t=this.$0[n];return typeof t=="undefined"?null:new tab.IntegerRange(t.$3().get_from(),t.$3().get_to())},getTileRangeType:function(n){var t=this.$0[n];return typeof t=="undefined"?"unknown":t.$4()},pixelToTileRange:function(n){return tab.IntegerRange.pixelToTileRange(n,this.$2,this.$4)},itemToTileIndex:function(n){return Math.floor(n/this.$4)},globalToLocalItemIndex:function(n){return ss.imod(n,this.$4)}}),si=global.tab.LocalSearch=ss.mkType(t,"tab.LocalSearch",function(){},null,{searchQueryMatchesText:function(n,t){var i=n.length,r;return n.charCodeAt(0)===39&&n.charCodeAt(i-1)===39?ss.referenceEquals(n.substr(1,i-2),t):n.charCodeAt(0)!==42&&n.charCodeAt(i-1)===42?t.indexOf(n.substr(0,i-1))===0:n.charCodeAt(0)===42&&n.charCodeAt(i-1)!==42?(r=t.lastIndexOf(n.substr(1,i-1)),r>=0&&r===t.length-(i-1)):n.charCodeAt(0)===42&&n.charCodeAt(i-1)===42?t.indexOf(n.substr(1,i-2))>=0:t.indexOf(n)>=0},findMatches:function(n,t,i,r){var s=n.toLowerCase(),o=[],f=t.table.tuples,u,e;for(ss.isNullOrUndefined(r)&&(r=function(n){return n}),u=0;u<f.length;u++)e=i(f[u]),si.searchQueryMatchesText(s,e.toLowerCase())&&o.push(r(f[u],e,u));return o}}),g=global.tab.OnClickOverride=ss.mkType(t,"tab.OnClickOverride",function(){this.$2=null;this.$3=tsConfig.is_mobile;dijit.MenuItem.call(this)},{postCreate:function(){if(this.inherited(arguments),this.$3)var n=new tableau.util.NoClickDelay(this.domNode)},$0:function(){this.getParent().focusChild(this)},$1:function(n){this.$2=tab.MiscUtil.clearTimeout(this.$2);this.$2=window.setTimeout(n,75)},_onClick:function(n){if(this.$3){if(!this._isReasonableEvent(n))return;var t=ss.mkdel(this,function(){this.getParent().onItemClick(this,n);spiff.EventUtil.stopEvent(n)});this.$0();this.$1(t)}else this.inherited(arguments)},_onHover:function(n){this.$3?this._onClick(n):this.inherited(arguments)}}),hi=global.tab.PageTemplate=ss.mkType(t,"tab.PageTemplate",function(){spiff.Template.call(this,$("<div class='tab-page'><\/div>"))}),ci=global.tab.PageView=ss.mkType(t,"tab.PageView",function(n){this.pageViewModel=null;this.$8=null;ss.makeGenericType(spiff.BaseView$1,[ut]).call(this,n,new hi);this.pageViewModel=n;this.pageViewModel.add_newPage(ss.mkdel(this,this.handleNewPage));this.pageViewModel.add_resized(ss.mkdel(this,this.updatePageControl));this.pageViewModel.add_titleVisibilityChanged(ss.mkdel(this,this.updatePageControl));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.pageViewModel.remove_newPage(ss.mkdel(this,this.handleNewPage))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.pageViewModel.remove_resized(ss.mkdel(this,this.updatePageControl))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.pageViewModel.remove_titleVisibilityChanged(ss.mkdel(this,this.updatePageControl))})))},{$7:function(){return this.get_viewModel().get_pageModel().get_zoneModel()},dispose:function(){ss.isValue(this.$8)&&(this.$8.destroyRecursiveShim(!1),this.$8=null);ss.makeGenericType(spiff.BaseView$1,[ut]).prototype.dispose.call(this)},onAddedToDom:function(){spiff.Widget.prototype.onAddedToDom.call(this);ss.isValue(this.pageViewModel.get_pageModel())&&this.handleNewPage()},handleNewPage:function(){var n,t;ss.isNullOrUndefined(this.$8)&&ss.isValue(this.pageViewModel.get_pageModel())&&ss.isValue(this.pageViewModel.get_pageModel().pm)?(this.$8=this.createCurrentPagePanel(),this.get_template().domRoot.append(this.$8.getDomNode()),this.$8.startupShim(),n={x:0,y:0,w:this.$7().get_contentWidth(),h:this.$7().get_contentHeight()},tab.DomUtil.resize(this.$8,tab.RectXYUtil.toRect(n))):(t=this.createCurrentPagePanelProperties(),this.$8.updatePropertiesShim(t),this.$8.refreshLayoutShim())},updatePageControl:function(){ss.isValue(this.pageViewModel.get_pageModel())&&ss.isValue(this.pageViewModel.get_pageModel().pm)&&(this.$8.destroyRecursiveShim$1(),this.$8=null,this.handleNewPage())},createCurrentPagePanelProperties:function(){var t=this.pageViewModel.get_pageModel().pm,n={};return n.cpHeight=this.$7().get_contentHeight(),n.sheetid=this.$7().get_associatedSheet(),n.enable=this.pageViewModel.get_historyTrailsEnabled(),n.show_slider=t.showPageSlider,n.show_toggle=this.pageViewModel.get_showHistoryToggle(),n.show_dropdown=t.showPageReadout,n.current_page=t.currentPage,n.pages=t.pageNames,n.session=this.pageViewModel.get_viewSession(),n.layoutSession=this.pageViewModel.get_layoutSession(),n.lTitle=this.pageViewModel.get_title(),n.titleHtml=this.pageViewModel.get_titleHtml(),n.zoneTitleHeight=this.pageViewModel.get_zoneTitleHeight(),n.zoneTitleWidth=this.pageViewModel.get_zoneTitleWidth(),n.isDashboard=!0,n.pageViewModel=this.pageViewModel,n.backgroundColor=this.pageViewModel.get_backgroundColor(),n},createCurrentPagePanel:function(){var n=this.createCurrentPagePanelProperties();return this.instantiateCurrentPagePanel(n)},instantiateCurrentPagePanel:function(n){var t=tab.ObjectRegistry.resolve(tab.ILegacyDojoWidgetMaker).call(null,[]);return t.makeCurrentPagePanelWidget(n)}}),ut=global.tab.PageViewModel=ss.mkType(t,"tab.PageViewModel",function(n){this.$0=null;this.$2$1=null;this.$2$2=null;this.$2$3=null;spiff.BaseViewModel.call(this);this.$0=n;this.$0.add_newPage(ss.mkdel(this,this.handleNewPage));this.$0.get_zoneModel().get_zoneCommonModel().add_resizeZone(ss.mkdel(this,this.handleParentZoneResized));this.get_pageModel().get_zoneModel().get_zoneCommonModel().add_changeZoneTitleVisibility(ss.mkdel(this,this.handleTitleVisibilityChanged));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$0.remove_newPage(ss.mkdel(this,this.handleNewPage))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$0.get_zoneModel().get_zoneCommonModel().remove_resizeZone(ss.mkdel(this,this.handleParentZoneResized))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$0.get_zoneModel().get_zoneCommonModel().remove_changeZoneTitleVisibility(ss.mkdel(this,this.handleTitleVisibilityChanged))})))},{add_newPage:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_newPage:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},add_resized:function(n){this.$2$2=ss.delegateCombine(this.$2$2,n)},remove_resized:function(n){this.$2$2=ss.delegateRemove(this.$2$2,n)},add_titleVisibilityChanged:function(n){this.$2$3=ss.delegateCombine(this.$2$3,n)},remove_titleVisibilityChanged:function(n){this.$2$3=ss.delegateRemove(this.$2$3,n)},get_pageModel:function(){return this.$0},get_viewSession:function(){return tab.ModelUtils.getViewSession(this.get_pageModel().get_zoneModel().get_associatedSheet())},get_layoutSession:function(){return tab.CommandController.get().legacySession},get_visualId:function(){return tab.ModelUtils.getVisualId(this.get_pageModel().get_zoneModel().get_associatedSheet())},get_titleHtml:function(){return this.get_pageModel().get_zoneModel().get_hasTitle()?this.get_pageModel().pm.titleHtml:""},get_title:function(){return this.get_pageModel().get_zoneModel().get_hasTitle()?this.get_pageModel().get_title():""},get_historyTrailsEnabled:function(){return this.$0.pm.pageTrailOptions.state},get_isHistoryToggleInteractionDisabled:function(){return tab.ApplicationModel.get_instance().get_workbook().get_isCurrentSheetStoryboard()||!this.$0.pm.supportTrailOptions},get_showHistoryToggle:function(){var n=this.$0.pm.showHistoryControls;return tsConfig.is_mobile&&this.get_isHistoryToggleInteractionDisabled()&&!this.get_historyTrailsEnabled()&&(n=!1),n},get_showHistoryToggleForPopup:function(){var n=this.get_showHistoryToggle();return this.get_isHistoryToggleInteractionDisabled()&&(n=!1),n},get_zoneTitleHeight:function(){return this.get_pageModel().get_zoneModel().get_hasTitle()?this.get_pageModel().get_zoneModel().get_titleHeight():0},get_zoneTitleWidth:function(){return this.get_pageModel().get_zoneModel().get_hasTitle()?this.get_pageModel().get_zoneModel().get_titleWidth():0},get_backgroundColor:function(){return this.get_pageModel().get_zoneModel().get_drawnZoneColor()},handleNewPage:function(){this.raiseActionEvent(this.$2$1)},handleParentZoneResized:function(){this.raiseActionEvent(this.$2$2)},handleTitleVisibilityChanged:function(){this.raiseActionEvent(this.$2$3)}}),li=global.tab.ParameterControl=ss.mkType(t,"tab.ParameterControl",function(n){this.$n=!0;this.paramMenuButton=null;this.domBox=null;this.domControls=null;this.getSID=null;this.session=null;this.$f=null;this.$h="";this.$e={};this.stateId=0;this.$m=null;this.$l=null;this.domTitleBar=null;this.domContent=null;this.$i=0;this.$k=0;this.$j=null;this.backgroundColor=null;this.blendedZoneContentColor=null;this.$g=null;this.$d=null;Object.call(this);this.$g=new tab.DisposableHolder;this.session=n.session;this.$h=n.field;this.$i=n.titleH;this.$k=n.titleW;this.$j=n.titleHTML;this.backgroundColor=n.backgroundColor;this.blendedZoneContentColor=n.blendedZoneContentColor;this.$e=n.attributes;this.$m=n.viewModel},{get_model:function(){return this.$m.get_parameterCtrlModel().get_parameterCtrlPresModel()},get_paramTitle:function(){return ss.isValue(this.domTitleBar)?this.domTitleBar.title:null},get_domBoxElement:function(){return this.domBox},get_backgroundColor:function(){return this.backgroundColor},get_blendedZoneContentColor:function(){return this.blendedZoneContentColor},postCreate:function(){this.getSID=ss.mkdel(this,function(){return this.stateId});this.$1()},destroy:function(){ss.isValue(this.$l)&&this.$l.destroy();ss.isValue(this.$d)&&this.$d.dispose();this.$g.dispose();this.domContent.innerHTML="";this.inherited(arguments)},getTypeInParamClass:function(){return tableau.base.widget.paramui.TypeIn},getTypeInDateFieldParamClass:function(){return tableau.base.widget.paramui.TypeInDateField},getCompactParamClass:function(){return tableau.base.widget.paramui.Compact},getListParamClass:function(){return tableau.base.widget.paramui.List},getSliderParamClass:function(){return tableau.base.widget.paramui.Slider},$1:function(){var n=null;if(!ss.isNullOrUndefined(this.get_model())&&!ss.isNullOrUndefined(this.get_model().legacyPresModel)){ss.isValue(this.get_model().legacyPresModel)&&this.domTitleBar.setAttribute("title",this.get_model().legacyPresModel.title);this.$f=this.$6();switch(this.$f){case"type_in":n=this.getTypeInParamClass();break;case"compact":n=this.getCompactParamClass();break;case"list":n=this.getListParamClass();break;case"slider":n=this.getSliderParamClass();break;case"datetime":n=this.getTypeInDateFieldParamClass();break;default:return}ss.isValue(this.$l)&&(this.$l.destroy(),this.$l=null);ss.isNullOrUndefined(this.$e)&&(this.$e={});this.$l=new n(this,this.domContent,this.$h,this.$e,this.$m);this.$l.instantiate(!1);this.$a();this.$2();this.$7()}},$2:function(){var n=$(this.paramMenuButton);if(!this.$m.get_hasContextMenu()){n.remove();return}ss.isNullOrUndefined(this.$d)&&(this.$d=new spiff.ToggleButton($("<div><\/div>"),null),this.$d.addClass("wcIconContextMenu"),this.$d.add_click(ss.mkdel(this,this.$c)),this.$g.add$1(this.$d),n.append(this.$d.element),this.setupEventHandlers(),n.css("background-color",this.backgroundColor));this.hideControls()},setupEventHandlers:function(){var r=spiff.TableauClickHandler.targetAndClick(this.domNode,ss.mkdel(this,this.$b)),n,t,i;r.set_stopPropagationOnEvent(!1);this.$g.add$1(r);n=$(this.domNode);this.$g.add$1(spiff.EventUtil.bindWithDispose(n,"mouseenter",ss.mkdel(this,this.$4)));this.$g.add$1(spiff.EventUtil.bindWithDispose(n,"mouseleave",ss.mkdel(this,this.$5)));t=ss.mkdel(this,function(){this.$b()});i=ss.mkdel(this,function(){window.setTimeout(ss.mkdel(this,function(){tab.DomUtil.isAncestorOf(this.domNode,document.activeElement)||this.hideControls()}),200)});this.domNode.addEventListener("focus",t,!0);this.domNode.addEventListener("blur",i,!0);this.$g.add(ss.mkdel(this,function(){this.domNode.removeEventListener("focus",t,!0);this.domNode.removeEventListener("blur",i,!0)}));this.$g.add$2([spiff.TableauClickHandler.targetAndClick(this.paramMenuButton,ss.mkdel(this,this.$c)),tab.KeyboardHandlers.setAccessibilityKeyboardHandlers(this.paramMenuButton,ss.mkdel(this,this.$c))])},$c:function(){this.$m.showContextMenu(new spiff.ShowMenuOptions($(this.paramMenuButton),!1),ss.mkdel(this,function(){this.$d.set_selected(!1)}))},$b:function(){this.$i>0&&$(this.domControls).removeClass("HideControls")},hideControls:function(){this.$d.get_selected()||$(this.domControls).addClass("HideControls")},$4:function(){this.$b()},$5:function(n){var t=dojo.coords(this.domNode,!0);(t.x>n.pageX||t.x+t.w<=n.pageX||t.y>n.pageY||t.y+t.h<=n.pageY)&&this.hideControls()},$a:function(){this.domTitleBar.innerHTML=this.$j;tab.FormattingConverters.cleanUpFontFamilyStyles($(this.domTitleBar));$(this.domTitleBar).find("div").css(ss.mkdict(["text-overflow","ellipsis","overflow","hidden"]))},updateProperties:function(n){this.session=n.session;this.$h=n.field;this.$i=n.titleH;this.$k=n.titleW;this.$j=n.titleHTML;this.backgroundColor=n.backgroundColor;this.blendedZoneContentColor=n.blendedZoneContentColor;this.$e=n.attributes;this.$6()!==this.$f?this.$1():(this.$a(),this.$7(),this.$8())},$7:function(){ss.isValue(this.get_model().textStyle)&&ss.isValue(this.get_blendedZoneContentColor())&&nt.applyFormatting(this.domNode,this.get_model().textStyle,this.get_blendedZoneContentColor(),this.get_model().lineHeight,!0)},$8:function(){ss.isValue(this.$l)&&this.$l.refreshState(this.$e)},$6:function(){return this.get_model().paramDisplayMode},$0:function(){return this.$k===0&&this.$i===0},$9:function(){ss.isValue(this.domTitleBar)&&$(this.domTitleBar).css({height:"auto",width:"auto"})},getTitleOffset:function(){return $(this.domNode).hasClass("PCInlineTitle")?0:dojo.marginBox(this.domTitleBar).h},layout:function(){if(!ss.isNullOrUndefined(this.domNode.parentNode)&&!ss.isNullOrUndefined(this.$l)){$(this.domNode).removeClass("PCInlineTitle");var i=this.$3(),n=dojo.contentBox(this.domNode),t={w:n.w,h:n.h};this.$0()||(this.$k>0?(t.w=n.w-i.w,this.$m.get_hasBorder()&&(this.domContent.style.paddingTop="1px"),this.domTitleBar.style.cssFloat="left",this.domContent.style.cssFloat="left",this.domNode.classList.add("PCInlineTitle")):(t.h=n.h-i.h,tsConfig.is_mobile&&this.$m.get_hasBorder()&&(t.h-=3),this.domTitleBar.style.cssFloat="none",this.domContent.style.cssFloat="none"));this.$l.layout(t)}},$3:function(){var n={};return this.$9(),(this.$i>0||this.$0())&&(n.h=this.$i,this.domTitleBar.style.height=n.h+"px"),(this.$k>0||this.$0())&&(n.w=this.$k,this.domTitleBar.style.width=n.w+"px"),tableau.util.setupTitleEllipsis($(this.domTitleBar)),n},getDomNode:function(){return this.domNode},destroyRecursiveShim:function(n){this.destroyRecursive(n)},startupShim:function(){this.startup()},destroyRecursiveShim$1:function(){this.destroyRecursive()},updatePropertiesShim:function(n){this.updateProperties(n)},layoutShim:function(n){this.layout(n)}}),ai=global.tab.ParameterControlTemplate=ss.mkType(t,"tab.ParameterControlTemplate",function(){spiff.Template.call(this,$("<div class='tab-parameter'><\/div>"))}),vi=global.tab.ParameterControlView=ss.mkType(t,"tab.ParameterControlView",function(n){this.$8=null;this.$7=null;ss.makeGenericType(spiff.BaseView$1,[ft]).call(this,n,new ai);this.$8=n;this.$8.add_newParameterControl(ss.mkdel(this,this.handleNewParameterControl));this.$8.add_resized(ss.mkdel(this,this.updateSize));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$8.remove_newParameterControl(ss.mkdel(this,this.handleNewParameterControl))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$8.remove_resized(ss.mkdel(this,this.updateSize))})));tsConfig.is_authoring&&!tsConfig.is_mobile&&tsConfig.features.HybridFormatPane&&tsConfig.features.MttwParameterFormatting&&tsConfig.features.MttwContextualFormatting&&this.disposables.add$1(spiff.TableauClickHandler.targetAndClick(this.element[0],ss.mkdel(this,this.handleSingleClick)));this.$8.get_hasBorder()&&this.get_template().domRoot.addClass("tabBordered")},{get_zoneModel:function(){return this.$8.get_zoneModel()},dispose:function(){ss.isValue(this.$7)&&(this.$7.destroyRecursiveShim(!1),this.$7=null);ss.makeGenericType(spiff.BaseView$1,[ft]).prototype.dispose.call(this)},onAddedToDom:function(){spiff.Widget.prototype.onAddedToDom.call(this);ss.isValue(this.$8.get_parameterCtrlModel())&&this.handleNewParameterControl()},handleNewParameterControl:function(){ss.isNullOrUndefined(this.$7)?(this.$7=this.createParameterControl(),this.get_template().domRoot.append(this.$7.getDomNode()),this.$7.startupShim(),ss.isValue(this.get_zoneModel().get_zoneContentBounds())&&tab.DomUtil.resize(this.$7,this.get_zoneModel().get_zoneContentBounds())):this.updateViewProperties();this.$7.layoutShim(null)},updateSize:function(){tab.DomUtil.resize(this.$7,this.get_zoneModel().get_zoneContentBounds());this.$7.layoutShim(null)},updateViewProperties:function(){if(!ss.isNullOrUndefined(this.$7)){var n=this.createParameterControlProperties();this.$7.updatePropertiesShim(n)}},createParameterControlProperties:function(){var n={},t;return n.session=this.$8.get_layoutSession(),t=this.get_viewModel().get_parameterCtrlModel(),n.field=t.get_parameterName(),ss.isValue(this.get_zoneModel().pm)&&ss.isValue(this.get_zoneModel().pm.zoneCommon.styledBox)&&(n.backgroundColor=this.get_zoneModel().get_zoneCommonModel().get_contentStyle().get_fillColor()),n.blendedZoneContentColor=this.get_zoneModel().get_blendedZoneContentColor(),ss.isValue(this.get_zoneModel().pm)&&ss.isValue(this.get_zoneModel().pm.zoneTitle)&&(n.titleHTML=this.$8.get_titleHtml(),n.titleH=this.$8.get_titleHeight(),n.titleW=this.$8.get_titleWidth()),ss.isValue(t.get_attributes())&&(n.attributes=t.get_attributes()),n.viewModel=this.$8,n},createParameterControl:function(){var n=this.createParameterControlProperties();return this.$7=this.makeParameterControl(n),this.$7},makeParameterControl:function(n){var t=tab.ObjectRegistry.resolve(tab.ILegacyDojoWidgetMaker).call(null,[]);return t.makeControlWidget(n)},handleSingleClick:function(){var n={};n.formattingCtx="parameters";tab.WebCommandRegistry.get_instance().createCommandWithParams(tab.WebFormatPaneCmd.cmdId,n).invoke()}}),ft=global.tab.ParameterControlViewModel=ss.mkType(t,"tab.ParameterControlViewModel",function(n){this.$3=null;this.$2$1=null;this.$2$2=null;spiff.BaseViewModel.call(this);this.$3=n;this.$3.add_newParameterCtrl(ss.mkdel(this,this.$0));this.$3.get_zoneModel().get_zoneCommonModel().add_resizeZone(ss.mkdel(this,this.$1));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$3.remove_newParameterCtrl(ss.mkdel(this,this.$0))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$3.get_zoneModel().get_zoneCommonModel().remove_resizeZone(ss.mkdel(this,this.$1))})))},{add_newParameterControl:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_newParameterControl:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},add_resized:function(n){this.$2$2=ss.delegateCombine(this.$2$2,n)},remove_resized:function(n){this.$2$2=ss.delegateRemove(this.$2$2,n)},get_handlingOfContextMenuEventsRequired:function(){return tab.DefaultHandlingOfContextMenuEventsOnDashboard.get_isSupported()&&tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_Parameters")},get_parameterCtrlModel:function(){return this.$3},get_zoneModel:function(){return this.$3.get_zoneModel()},get_layoutSession:function(){return tab.CommandController.get().legacySession},get_hasBorder:function(){return this.$3.get_zoneModel().get_hasBorder()},get_hasContextMenu:function(){return tsConfig.is_authoring&&!tsConfig.is_mobile&&tsConfig.current_sheet_type==="worksheet"},get_titleHtml:function(){return this.get_isTitleVisible()?this.get_zoneModel().pm.zoneTitle.html:""},get_isTitleVisible:function(){return this.get_zoneModel().get_zoneCommonModel().get_hasTitle()},get_titleWidth:function(){var n=0;return this.get_isTitleVisible()&&this.get_zoneModel().get_titleWidth()>0&&(n=this.get_zoneModel().pm.zoneTitle.w),n},get_titleHeight:function(){var n=0;return this.get_isTitleVisible()&&this.get_zoneModel().get_titleHeight()>0&&(n=this.get_zoneModel().pm.zoneTitle.h,this.get_hasBorder()&&(n+=3),n=Math.max(n,17)),n},showContextMenu:function(n,t){this.get_hasContextMenu()&&tab.ParameterClientCommands.getParameterControlMenu(this.get_parameterCtrlModel().get_parameterName(),ss.mkdel(this,function(i){this.$2(i.commands,n,t)}))},$2:function(n,t,i){if(!ss.isNullOrUndefined(n)){var r=tab.WidgetUtil.menuViewModelFromCommands(n,function(n){tab.WidgetUtil.commandMenuItemClicked(n)},i,null,null);ss.isValue(r)&&r.show(t)}},$0:function(){this.raiseActionEvent(this.$2$1)},$1:function(){this.raiseActionEvent(this.$2$2)}}),y=global.tab.ParamUIBase=ss.mkType(t,"tab.ParamUIBase",function(n,t,i,r,u){this.disposables=null;this.parameterViewModel=null;this.parent=null;this.field=null;this.newValInFlight=null;this.div=null;this.attributes=null;Object.call(this);this.disposables=new tab.DisposableHolder;this.parent=n;this.div=t;this.field=i;this.attributes=r;this.parameterViewModel=u;this.newValInFlight=null},{setAriaLabel:function(n){ss.isNullOrUndefined(n)||(tab.MiscUtil.isNullOrEmpty$1(this.parent.get_paramTitle())?n.removeAttribute("aria-label"):n.setAttribute("aria-label",this.parent.get_paramTitle()))},get_legacyModel:function(){return this.parameterViewModel.get_parameterCtrlModel().get_parameterCtrlJsonPresModel()},get_model:function(){return this.parameterViewModel.get_parameterCtrlModel().get_parameterCtrlPresModel()},get_unformattedDisplayName:function(){return this.parameterViewModel.get_isTitleVisible()?this.get_legacyModel().title:""},instantiate:null,setNewState:null,refreshState:function(n){this.attributes=n;this.setNewState()},dispose:function(){this.disposables.dispose()},destroy:function(){this.dispose();this.div.innerHTML=""},layout:function(n){tsConfig.is_mobile?(d.setMarginBoxWidth(this.div,n.w),this.div.style.maxHeight=n.h+"px"):dojo.marginBox(this.div,n)},validateAndSetParameterValue:function(n,t,i,r,u,f,e,o){if(tab.MiscUtil.isNullOrEmpty$1(n)&&i!=="cstring"){o();return}if(!ss.referenceEquals(n,this.newValInFlight)){if(this.newValInFlight=n,u==="list"&&ss.contains(f,n)){tab.ParameterServerCommands.setParameterValue$1(this.field,this.newValInFlight,t,e,function(){o()});this.newValInFlight=null;return}var s=new tab.ValidateDataValueCmd;s.c.dataType=i;s.c.globalFieldName=r;s.c.isForInput=!0;s.c.rawDataValueString=n;s.c.useUsLocale=t;s.invoke().fail(o).done(ss.mkdel(this,function(n){n.captionedDataValue!==undefined&&n.captionedDataValue!==null?tab.ParameterServerCommands.setParameterValue$1(this.field,this.newValInFlight,t,e,function(){o()}):o()})).always(ss.mkdel(this,function(){this.newValInFlight=null}))}}}),ar=global.tab.ParamUICompact=ss.mkType(t,"tab.ParamUICompact",function(n,t,i,r,u){var f,o,s,e;this.$4=null;this.$3=null;y.call(this,n,t,i,r,u);f=new spiff.ComboBoxViewModel;f.set_menuTheme(1);f.set_menuStyleClass(this.parent.domNode.id+"_menu");f.set_labelText(n.get_paramTitle());f.set_shouldHandleRightClickOnMenuAsClick(tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_Parameters"));this.$4=f;this.$4.add_selectedItemChanged(ss.mkdel(this,this.$2));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$4.remove_selectedItemChanged(ss.mkdel(this,this.$2))})));this.$1();ss.isValue(this.parent.get_blendedZoneContentColor())&&(tab.ColorModel.fromColorCode(this.parent.get_blendedZoneContentColor()).isLuminanceAboveThreshold(.314999997615814)||this.$4.set_additionalMenuClass("tab-darkBackground"),o=new ur(this.parent.get_model().textStyle,this.parent.get_blendedZoneContentColor(),this.parent.get_model().lineHeight),nt.applyFormattingByClassName(this.$4.get_menuStyleClass(),o,!0));this.$3=tab.ObjectRegistry.newView(spiff.ComboBoxView).call(null,[this.$4]);ss.isValue(this.parent.get_model().textStyle)&&(s=this.$3.get_rootElement().find(".tabComboBoxButton")[0],s.innerHTML=kt.getDropDownForColor(this.parent.get_model().textStyle.color.toString()));e=this.$3.get_rootElement().get(0);e.addEventListener("contextmenu",ss.mkdel(this,this.$0));this.disposables.add(ss.mkdel(this,function(){e.removeEventListener("contextmenu",ss.mkdel(this,this.$0))}));this.$3.addToDom($(this.div));this.disposables.add$1(this.$4);this.disposables.add$1(this.$3)},{instantiate:function(){},setNewState:function(){this.$1()},$1:function(){this.$4.clearItems();var n=null,t=_.map(this.get_legacyModel().domain,ss.mkdel(this,function(t){var i=new spiff.ComboBoxItem(null,t,null,"",null);return ss.referenceEquals(t,this.get_legacyModel().alias)&&(n=i),i}));this.$4.setItems(t);this.$4.set_selectedItem(n)},$2:function(n){if(!ss.isNullOrUndefined(n)&&!tab.MiscUtil.isNullOrEmpty(this.get_legacyModel().domain)){var t=n.get_name();ss.referenceEquals(t,this.get_legacyModel().alias)||tab.ParameterServerCommands.setParameterValue(this.field,t,null)}},$0:function(n){tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_Parameters")&&spiff.EventUtil.stopEvent(n)},layout:function(){this.inherited(arguments)}}),vr=global.tab.ParamUIList=ss.mkType(t,"tab.ParamUIList",function(n,t,i,r,u){y.call(this,n,t,i,r,u)},{instantiate:function(t){for(var e,o=t&&this.div.contains(document.activeElement),s=ss.mkdel(n.filterItem,n.filterItem.getRadioHtml),u=this.field,h=this.get_legacyModel().alias,f=[],r=this.get_legacyModel().domain,c=r.length,i=0;i<c;i++)e=ss.formatString("{0}_{1}",u,i.toString()),f.push(s(e,u,r[i],ss.referenceEquals(h,r[i])));this.div.innerHTML=f.join("");this.div.setAttribute("role","radiogroup");this.setAriaLabel(this.div);this.div.classList.add("tab-ctrl-formatted-text");t?o&&this.div.querySelector("[role='radio'][aria-checked='true']").focus():(this.disposables.add$1(spiff.EventUtil.bindWithDispose($(this.div),"click",ss.mkdel(this,this.$1))),this.disposables.add$1(spiff.EventUtil.bindWithDispose($(this.div),"keydown",ss.mkdel(this,this.$0))))},setNewState:function(){this.instantiate(!0)},$0:function(n){var t,i;if(!n.ctrlKey&&!n.altKey&&!n.shiftKey&&!n.metaKey&&n.target.getAttribute("role")==="radio"){switch(n.which){case 32:n.target.querySelector("input").click();break;case 40:case 39:t=n.target.nextElementSibling;ss.isValue(t)&&t.getAttribute("role")==="radio"?t.focus():$(this.div).find("[role='radio']").first().focus();break;case 38:case 37:i=n.target.previousElementSibling;ss.isValue(i)&&i.getAttribute("role")==="radio"?i.focus():$(this.div).find("[role='radio']").last().focus();break;default:return}n.stopPropagation();n.preventDefault()}},$1:function(t){var e=t.target.tagName.toLowerCase(),r,i,u,f;e==="input"&&(r=$(t.target),i=r.parents(".FIItem"),i.length>0&&(u=n.filterItem.getIndex(i.get(0)),f=this.get_legacyModel().domain[u],tab.ParameterServerCommands.setParameterValue(this.field,f,null)))}}),dt=global.tab.ParamUISlider=ss.mkType(t,"tab.ParamUISlider",function(n,t,i,r,u){this.slider=null;y.call(this,n,t,i,r,u)},{get_currentDisplayValueFromModel:function(){return!this.$4()&&this.$5()&&!this.$9()&&this.$8()?this.formatValue(this.get_modelValueOrRangeMin()):this.get_legacyModel().alias},$4:function(){return ss.isValue(this.get_legacyModel().domain)},$5:function(){var n=this.get_legacyModel();return ss.isValue(n.granularity)&&ss.isValue(n.min)&&ss.isValue(n.max)},$9:function(){return this.get_legacyModel().granularity.s==="n"},$8:function(){return ss.isValue(this.get_legacyModel().date_period_type)},$b:function(){var n=this.get_legacyModel().min.v;return ss.isNullOrUndefined(n)&&(n=ss.unbox(this.get_legacyModel().value.v)),n},$a:function(){var n=this.get_legacyModel().max.v;return ss.isNullOrUndefined(n)&&(n=ss.unbox(this.get_legacyModel().value.v)),n},get_modelValueOrRangeMin:function(){var n=this.get_legacyModel().value.v;return ss.isNullOrUndefined(n)&&(n=this.$b()),n},$6:function(){return this.get_legacyModel().granularity.v},$7:function(){return this.get_legacyModel().date_period_type},get_numPeriods:function(){return this.get_legacyModel().num_periods},$d:function(){return this.$a()-this.$b()},get_currentPercentageOfRange:function(){if(this.$d()===0)return 0;var n=this.get_modelValueOrRangeMin();return(n-this.$b())/this.$d()*100},get_sizeOfDiscreteRange:function(){return Math.round(this.$d()/this.$6())+1},get_currentIndexInRange:function(){var n=this.get_modelValueOrRangeMin();return Math.round((n-this.$b())/this.$6())},get_currentIndexInDateRange:function(){var n=this.get_modelValueOrRangeMin();return Math.round((n-this.$b())/(this.$6()*this.$c()))},$c:function(){return dt.$1[this.$7()]},instantiate:function(n){var r=n&&ss.isValue(this.slider)&&this.div.contains(document.activeElement)&&document.activeElement.getAttribute("role")==="slider",t,i;ss.isValue(this.slider)&&(this.slider.destroy(),this.slider=null);this.slider=new tableau.base.widget.ui.Slider(this.div,this.attributes,!1,ss.mkdel(this,this.doUpdateViz),ss.mkdel(this.parent,this.parent.getTitleOffset),ss.mkdel(this,this.getCurrentText),null);t=this.get_currentDisplayValueFromModel();this.get_legacyModel().fake_continuous&&(this.attributes["show-step-btns"]="false",this.attributes["show-ticks"]="false");var u=ss.mkdel(this,function(){this.slider.instantiateFromDomain(this.get_legacyModel().domain,t)}),f=ss.mkdel(this,function(){var n=Number.POSITIVE_INFINITY,i=this.get_currentPercentageOfRange();this.attributes["show-step-btns"]="false";this.slider.instantiate(n,i,t)}),e=ss.mkdel(this,function(){var n=this.get_numPeriods(),i=this.get_currentIndexInDateRange();this.slider.instantiate(n,i,t)}),o=ss.mkdel(this,function(){var n=this.get_sizeOfDiscreteRange(),i=this.get_currentIndexInRange();this.slider.instantiate(n,i,t)}),s=ss.mkdel(this,function(){var n=Number.POSITIVE_INFINITY;this.attributes["show-step-btns"]="false";this.slider.instantiate(n,50,t)});this.behaviorPicker(u,f,e,o,s);i=this.div.querySelector("[role='slider']");ss.isValue(i)&&(this.setAriaLabel(i),r&&i.focus())},behaviorPicker:function(n,t,i,r,u){return this.$4()?n():this.$5()?this.$9()?t():this.$8()?i():r():u()},setNewState:function(){this.updateView()},updateView:function(){this.instantiate(!0);this.slider.layout()},currentlySelectedTupleInDomainList:function(){for(var t=this.get_legacyModel().alias,i=this.get_legacyModel().domain.length,n=0;n<i;n++)if(ss.referenceEquals(this.get_legacyModel().domain[n],t))return{item1:t,item2:n};return null},doUpdateViz:function(n){var u=ss.mkdel(this,function(){return{item1:this.get_legacyModel().domain[n],item2:null}}),f=ss.mkdel(this,function(){return{item1:null,item2:this.$0(this.$3(n))}}),e=ss.mkdel(this,function(){return{item1:null,item2:this.$0(this.$1(n))}}),o=ss.mkdel(this,function(){return{item1:null,item2:this.$0(this.$2(n))}}),s=ss.mkdel(this,function(){return{item1:null,item2:this.$0(this.get_modelValueOrRangeMin())}}),t=this.behaviorPicker(u,f,e,o,s),i,r;ss.isNullOrUndefined(t)||(i=null,ss.isValue(t.item1)?i=t.item1:ss.isValue(t.item2)&&(r=null,t.item2.t==="t"&&(r={format:"M/d/yyyy",timeFormat:"h:mm:ss tt"}),i=tableau.format.formatDataValue(t.item2,null,r,null,2)),tab.ParameterServerCommands.setParameterValue(this.field,i,!0))},layout:function(){this.inherited(arguments);ss.isValue(this.slider)&&typeof this.slider.layout=="function"&&this.slider.layout()},getCurrentText:function(n){if(!this.$4()&&ss.referenceEquals(this.get_legacyModel().max,this.get_legacyModel().min))return this.get_currentDisplayValueFromModel();var t=ss.mkdel(this,function(){return this.get_legacyModel().domain[n]}),i=ss.mkdel(this,function(){return this.formatValue(this.$3(n))}),r=ss.mkdel(this,function(){return this.formatValue(this.$1(n))}),u=ss.mkdel(this,function(){return this.formatValue(this.$2(n))}),f=function(){return""},e=this.behaviorPicker(t,i,r,u,f);return ss.coalesce(e,"")},$3:function(n){return this.$d()===0?this.$b():n/100*this.$d()+this.$b()},$2:function(n){return n*this.$6()+this.$b()},$1:function(n){n=n*this.$6();var t=tab.DateUtil.adjustDateByPeriodInUTC(new Date(tableau.types.JsDateFromOleDate(this.$b())),this.$7(),n);return Math.min(tableau.types.OleDateFromJsDate(t.getTime()),this.$a())},formatValue:function(n){var t=this.get_legacyModel().date_format||this.get_legacyModel().format;return tableau.format.formatDataValue(this.$0(n),null,t,null,2)},$0:function(n){return{t:ss.isValue(this.get_legacyModel().min.v)?this.get_legacyModel().min.t:this.get_legacyModel().value.t,v:n.toString(),s:null}}}),et=global.tab.ParamUITypeIn=ss.mkType(t,"tab.ParamUITypeIn",function(n,t,i,r,u){this.widget=null;y.call(this,n,t,i,r,u)},{getWidgetClass:function(){return tableau.base.widget.ui.TypeIn},instantiate:function(){var n=this.getWidgetClass();this.widget=new n(this.div,ss.mkdel(this,this.$0),"TypeIn");this.widget.instantiate(this.get_legacyModel().alias,this.field,this.get_legacyModel().value,this.get_legacyModel().min,this.get_legacyModel().max,this.get_legacyModel().format,this.get_legacyModel().date_format,this.get_legacyModel().editing_format,this.get_model().firstDayOfWeek);this.get_legacyModel().is_list_domain&&this.widget.$0(this.get_legacyModel().domain,ss.mkdel(this.parent.session,this.parent.session.getAutocompleteInfo));tab.FeatureFlags.isEnabled("AccessibilityTypeInFilters")&&this.setAriaLabel(this.widget.queryBox)},setNewState:function(){this.widget.setNewState(this.get_legacyModel().alias,this.get_legacyModel().domain,this.get_legacyModel().value,this.get_legacyModel().min,this.get_legacyModel().max)},layout:function(){this.inherited(arguments);this.widget.layout()},$0:function(n){this.validateAndSetParameterValue(n,!1,this.get_model().dataType,this.get_model().parameterName,this.get_model().parameterDomainType,this.get_model().formattedValues,ss.mkdel(this,this.$2),ss.mkdel(this,this.$1))},$1:function(){this.widget.queryBox.value=this.get_legacyModel().alias;this.setNewState()},$2:function(){_.defer(ss.mkdel(this,this.setNewState))}}),yr=global.tab.ParamUITypeInDateField=ss.mkType(t,"tab.ParamUITypeInDateField",function(n,t,i,r,u){et.call(this,n,t,i,r,u)},{getWidgetClass:function(){return tableau.base.widget.ui.TypeInDateField},instantiate:function(n){et.prototype.instantiate.call(this,n);var t=this.widget;t.set_customCalendarDateSelectionAction(ss.mkdel(this,function(n){var i=ss.toUTC(new Date(tableau.types.JsDateFromOleDate(ss.unbox(this.get_legacyModel().value.v)))),t=ss.toUTC(n);return t.setHours(i.getHours()),t.setMinutes(i.getMinutes()),t.setSeconds(i.getSeconds()),ss.fromUTC(t)}))}}),pr=global.tab.Pattern=ss.mkType(t,"tab.Pattern",function(n,t,i){this.widget=null;s.call(this,n,t,i)},{instantiate:function(n,t){var r=arguments[0],i;this.widget=new tableau.base.widget.ui.TypeIn(this.div,ss.mkdel(this,this.doChange),"Pattern");this.widget.instantiate(r,t);tab.FeatureFlags.isEnabled("AccessibilityTypeInFilters")&&this.$3();tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_CategoricalFilter")&&(i=$(this.widget.queryBox),this.disposables.add$1(spiff.EventUtil.bindWithDispose(i,"contextmenu",ss.mkdel(this.parent,this.parent.handleContextMenuForSearchWidget))))},destroy:function(){this.widget.destroy()},resetContent:function(n,t){this.widget.destroy();this.instantiate(n,t)},layout:function(){this.inherited(arguments);this.widget.layout()},doChange:function(n){this.parent.set_stateId(this.parent.get_stateId()+1);tab.FilterClientCommands.setPatternFilterState(this.parent.get_session().get_visualId(),this.parent.get_identifier(),n.toString());this.parent.get_oFilter().pattern=n},$3:function(){tab.MiscUtil.isNullOrEmpty$1(this.parent.get_titleDomId())?$(this.widget.queryBox).removeAttr("aria-labelledby"):$(this.widget.queryBox).attr("aria-labelledby",this.parent.get_titleDomId())}}),wr=global.tab.PendingChangesManager=ss.mkType(t,"tab.PendingChangesManager",function(n,t,i,r){this.domainActualSize=0;this.$6=!1;this.$5=!1;this.$8=null;this.$a=!1;this.$9=!1;this.$7=null;this.$4=null;this.parent=null;this.$1$1=null;this.$1$2=null;this.parent=n;this.domainActualSize=t;this.$6=i;this.$5=r;this.resetPendingChanges()},{add_onPendingChanges:function(n){this.$1$1=ss.delegateCombine(this.$1$1,n)},remove_onPendingChanges:function(n){this.$1$1=ss.delegateRemove(this.$1$1,n)},add_onNoPendingChanges:function(n){this.$1$2=ss.delegateCombine(this.$1$2,n)},remove_onNoPendingChanges:function(n){this.$1$2=ss.delegateRemove(this.$1$2,n)},get_allItemCheckState:function(){return this.$4},set_allItemCheckState:function(n){this.$4=n},get_pendingChangelist:function(){return this.$8},set_pendingChangelist:function(n){this.$8=n},resetFilterInfo:function(n,t,i){this.domainActualSize=n;this.$6=t;this.$5=i},resetPendingChanges:function(){this.$8=new st;this.$7=[];this.$a=!1;this.$9=!1;this.$4=null;this.$1()},processChanges:function(n){this.get_pendingChangelist().appendChangelist(n);this.$0()},processAll:function(n){this.$7=[];this.$a=!0;this.$9=this.$6?!n:n;this.$8=new st;var t=new lt;t.setRange(new tab.IntegerRange(0,this.domainActualSize),this.$9);this.get_pendingChangelist().addChange(t);this.$0()},isSelectAll:function(){return this.$a&&this.$7.length===0&&(this.$6?!this.$9:this.$9)},isDeSelectAll:function(n){var t=this.$7.length===0||n;return this.$a&&t&&(this.$6?this.$9:!this.$9)},handleAllItemClicked:function(n){var i=this.$6?!n:n,t;for(this.set_allItemCheckState(n),t=0;this.hasItemAtIndex(t);)i?(this.isChecked(t)||this.togglePendingCss(t),this.setChecked(t,!0)):(this.isChecked(t)&&this.togglePendingCss(t),this.setChecked(t,!1)),t++;this.$a=!0;this.$9=i;this.$7=[]},handleItemClicked:function(n,t){var i,r,u,f;if(n===-1){this.handleAllItemClicked(this.isChecked(n));return}if(this.isChecked(n,t)){if(this.hasAllItem()){for(u=!0,f=0;u&&this.hasItemAtIndex(f);)this.isChecked(f)||(u=!1),f++;this.setAllItemChecked(u)}}else if(this.parent.shouldUseAllItem()&&(this.set_allItemCheckState(!1),this.hasAllItem()&&(this.setAllItemChecked(!1),this.$6))){for(i=!0,r=0;i&&this.hasItemAtIndex(r);)this.isChecked(r)&&(i=!1),r++;this.setAllItemChecked(i)}this.togglePendingCss(n,t);this.$3(n)},hasAllItem:function(){var t=this.parent.fetchAllItem();return ss.isValue(t)&&n.filterItem.isAllItem(t)},hasItemAtIndex:function(n){return n<this.domainActualSize&&ss.isValue(this.parent.fetchChildNodeByIndex(n))},setAllItemChecked:function(t){var i=this.parent.fetchAllItem();ss.isValue(i)&&(n.filterItem.setChecked(i,t),this.set_allItemCheckState(t))},togglePendingCss:function(t,i){var r=ss.isValue(i)?i:this.parent.fetchChildNodeByIndex(t);ss.isValue(r)&&n.filterItem.togglePendingState(r)},setChecked:function(t,i){var r=this.parent.fetchChildNodeByIndex(t);ss.isValue(r)&&n.filterItem.setChecked(r,i)},isChecked:function(t,i){var r;return r=t===-1?this.parent.fetchAllItem():ss.isValue(i)?i:this.parent.fetchChildNodeByIndex(t),n.filterItem.isChecked(r)},isPending:function(n,t){if(this.$a){var i=this.$5&&!this.$6?!0:n.s;return ss.contains(this.$7,t)?i===this.$9:i!==this.$9}return ss.contains(this.$7,t)},$0:function(){this.$a||this.$7.length>0?this.$2():this.$1()},$2:function(){ss.isValue(this.$1$1)&&this.$1$1()},$1:function(){ss.isValue(this.$1$2)&&this.$1$2()},$3:function(n){ss.contains(this.$7,n)?ss.remove(this.$7,n):this.$7.push(n)}}),p=global.tab.QfButtonUtil=ss.mkType(t,"tab.QfButtonUtil",null,null,{focusQfButton:function(n){$(n.domNode).find("button").first().focus()},enableResetButton:function(n,t){if(!ss.isNullOrUndefined(n)){var i=$(n.iconNode);t?(i.removeClass("wcIconNonfiltered"),i.removeClass("wcIconFiltered"),i.removeClass("wcIconSetAllIncluded"),i.removeClass("wcIconSetPartiallyIncluded"),i.addClass("wcIconSetPartiallyIncluded"),n.attr("label",tab.Strings.SetControlIncludeAllEnabled)):(i.removeClass("wcIconNonfiltered"),i.removeClass("wcIconFiltered"),i.removeClass("wcIconSetAllIncluded"),i.removeClass("wcIconSetPartiallyIncluded"),i.addClass("wcIconFiltered"),n.attr("label",tab.Strings.QuickFilterClearEnabled));n.setDisabled(!1);$(n.domNode.firstChild.firstChild).removeClass("tab-quickFilterButtonDisabled")}},disableResetButton:function(n,t){if(!ss.isNullOrUndefined(n)){var i=$(n.iconNode);t?(i.removeClass("wcIconNonfiltered"),i.removeClass("wcIconFiltered"),i.removeClass("wcIconSetAllIncluded"),i.removeClass("wcIconSetPartiallyIncluded"),i.addClass("wcIconSetAllIncluded"),n.attr("label",tab.Strings.SetControlIncludeAllDisabled)):(i.removeClass("wcIconNonfiltered"),i.removeClass("wcIconFiltered"),i.removeClass("wcIconSetAllIncluded"),i.removeClass("wcIconSetPartiallyIncluded"),i.addClass("wcIconNonfiltered"),n.attr("label",tab.Strings.QuickFilterClearDisabled));n.setDisabled(!0);i.removeClass("dijitButtonHover");i.removeClass("dijitHover");$(n.domNode.firstChild.firstChild).addClass("tab-quickFilterButtonDisabled")}}}),yi=global.tab.QuickFilterDisplayTemplate=ss.mkType(t,"tab.QuickFilterDisplayTemplate",function(){spiff.Template.call(this,$("<div class='tab-quick-filter'><\/div>"))}),pi=global.tab.QuickFilterPanel=ss.mkType(t,"tab.QuickFilterPanel",function(){this.templateString="<div class='QuickFilterPanel' dojoAttachPoint='containerNode' dojoAttachEvent='onmousedown:onMouseDown'><\/div>";this.session=null;this.field="";this.membershipTarget="filter";this.filter=null;this.width=0;this.metricsOnly=!1;this.layoutSession=null;this.quickFilterDisplayViewModel=null;this.$8=null;this.requestSetAttributes=null;this.titleHTML=null;this.$b=0;this.$c=0;this.attributes={};this.$a=null;this.textStyle=null;this.backgroundColor=null;this.blendedZoneContentColor=null;this.$9=!1;Object.call(this);this.$8=new tab.DisposableHolder},{$7:function(){return this.quickFilterDisplayViewModel.get_quickFilterDisplayModel()},get_getFilterModeMatrix:function(){return ss.isValue(this.$7())&&ss.isValue(this.$7().get_quickFilterModeMatrix())?this.$7().get_quickFilterModeMatrix():null},postCreate:function(){this.metricsOnly},dispose:function(){this.requestSetAttributes=null;this.$8.dispose()},updateFilterProperties:function(n){this.titleHTML=n.titleHTML;this.attributes=n.attributes;this.layoutSession=n.layoutSession;this.width=n.width;this.textStyle=n.textStyle;this.backgroundColor=n.backgroundColor;this.blendedZoneContentColor=n.blendedZoneContentColor},destroy:function(){this.dispose();this.inherited(arguments)},makeQuantitativeFilter:function(n){return new tableau.base.widget.LegacyQuantitativeQuickFilter(n)},makeQuantitativeDateFilter:function(n){return new tableau.base.widget.LegacyQuantitativeDateQuickFilter(n)},makeHierarchicalFilter:function(n){return new tableau.base.widget.LegacyHierarchicalQuickFilter(n)},makeCategoricalFilter:function(n){return new tableau.base.widget.LegacyCategoricalQuickFilter(n)},makeRelativeDateFilter:function(n){return new tableau.base.widget.LegacyRelativeDateQuickFilter(n)},makeRelativeDatePickFilter:function(n){return new tableau.base.widget.RelativeDatePickFilter(n)},setupEventHandlers:function(){var r=spiff.TableauClickHandler.targetAndClick(this.domNode,ss.mkdel(this,this.$5)),n,t,i;r.set_stopPropagationOnEvent(!1);this.$8.add$1(r);n=$(this.filter.domNode);this.$8.add$1(spiff.EventUtil.bindWithDispose(n,"mouseenter",ss.mkdel(this,this.$2)));this.$8.add$1(spiff.EventUtil.bindWithDispose(n,"mouseleave",ss.mkdel(this,this.$3)));t=ss.mkdel(this,function(){this.$5()});i=ss.mkdel(this,function(){window.setTimeout(ss.mkdel(this,function(){tab.DomUtil.isAncestorOf(this.domNode,document.activeElement)||this.hideControls()}),200)});this.domNode.addEventListener("focus",t,!0);this.domNode.addEventListener("blur",i,!0);this.$8.add(ss.mkdel(this,function(){this.domNode.removeEventListener("focus",t,!0);this.domNode.removeEventListener("blur",i,!0)}))},$1:function(n){var t={},i;return t.presModel=this.$7().get_quickFilterDisplayPresModel(),t.backgroundColor=this.$7().get_contentStyle().get_fillColor(),t.blendedZoneContentColor=this.$7().get_blendedZoneContentColor(),t.textStyle=this.textStyle,t.field=this.field,t.membershipTarget=n.membershipTarget,t.oFilter=n,t.filterViewModel=this.quickFilterDisplayViewModel.get_filterTypeViewModel(),t.layoutSession=this.layoutSession,t.attributes=this.attributes||{},t.requestSetAttributes=this.requestSetAttributes,t.titleH=this.$b,t.titleW=this.$c,t.titleHTML=this.titleHTML,t.width=this.width,t.getContextMenuCommands=ss.mkdel(this,function(){return this.getContextMenuCommands()}),t.showContextMenu=ss.mkdel(this,function(n){ss.isNullOrUndefined(this.get_getFilterModeMatrix())?this.showContextMenu(n):this.showFilterPicker()}),t.showDomainMenu=ss.mkdel(this,function(n){this.showDomainMenu(n)}),i=t,ss.isValue(this.session)?i.session=this.session:i.metricsOnly=!0,i},updateFilterState:function(n){var i=n.membershipTarget==="set",t;(ss.referenceEquals(this.field,tableau.format.formatQualifiedName(n.name))||i)&&(!this.filter||ss.referenceEquals(this.filter.oFilter.type,n.type)&&(n.type!=="RD"||n.showRelDatePick===this.filter.oFilter.showRelDatePick)&&(n.type!=="C"||ss.referenceEquals(n.mode,this.filter.oFilter.mode))||(this.filter.destroy(!1),this.filter=null),this.textStyle=this.quickFilterDisplayViewModel.get_quickFilterDisplayPresModel().textStyle,t=this.$1(n),ss.isNullOrUndefined(this.filter)?this.createFilterWidget(n,t):(this.filter.attributes=ss.isNullOrUndefined(this.attributes)?{}:this.attributes,this.filter.oFilter=n,this.filter.setTitleSize(this.$b,this.$c),this.filter.initFromState(),this.$0()))},createFilterWidget:function(n,t){ss.isNullOrUndefined(t)&&(t=this.$1(n));switch(n.type){case"Q":this.filter=tab.LegacyFilterModel.isQuantitativeDateFilter(n,null,null)?this.makeQuantitativeDateFilter(t):this.makeQuantitativeFilter(t);break;case"H":this.filter=this.makeHierarchicalFilter(t);break;case"C":this.filter=this.makeCategoricalFilter(t);break;case"RD":this.filter=n.showRelDatePick?this.makeRelativeDatePickFilter(t):this.makeRelativeDateFilter(t);break;default:this.domNode.style.display="none";return}this.addChild(this.filter);this.setupEventHandlers();this.filter.setTitleSize(this.$b,this.$c);this.$0();this.hideControls()},$0:function(){var n=this.$7().get_quickFilterDisplayPresModel().lineHeight;ss.isValue(this.session)&&dojo.marginBox(this.filter.domNode,dojo.contentBox(this.domNode));nt.applyFormatting(this.domNode,this.textStyle,this.blendedZoneContentColor,n,!0);this.filter.layout(null)},$5:function(){this.$b>0&&$(this.filter.domControls).removeClass("HideControls")},hideControls:function(){this.$9||$(this.filter.domControls).addClass("HideControls")},$2:function(){this.$5()},$3:function(n){var t=dojo.coords(this.filter.domNode,!0);(t.x>n.pageX||t.x+t.w<=n.pageX||t.y>n.pageY||t.y+t.h<=n.pageY)&&this.hideControls()},setTitleSize:function(n,t){this.$b=n;this.$c=t},resize:function(){this.$a=dojo.marginBox(this.domNode);this.inherited(arguments)},layout:function(){if(!!this.filter){var n=dojo.marginBox(this.domNode),t=_.isEqual(this.$a,n);t||(dojo.marginBox(this.filter.domNode,dojo.contentBox(this.domNode)),this.filter.setTitleSize(this.$b,this.$c),this.filter.layout(null))}},updateAttributes:function(n){this.attributes=ss.isNullOrUndefined(n)?{}:n},updateSubWidget:function(n){if(ss.isValue(this.filter)){var t=this.$1(n);this.filter.setTitleSize(t.titleH,t.titleW);this.filter.updateFilterProperties(t)}},getContextMenuCommands:function(){return ss.isValue(this.$7())&&ss.isValue(this.$7().get_quickFilterCommands())?((tsConfig.is_mobile||tsConfig.is_mobile_app)&&(tab.RichTextClientCommands.removeRichTextCommands(this.$7().get_quickFilterCommands()),tab.FilterClientCommands.removeFilterDialogCommands(this.$7().get_quickFilterCommands()),tab.FormattingUtil.removeOpenFormattingSidePaneCommands(this.$7().get_quickFilterCommands())),this.$7().get_quickFilterCommands()):{}},getDomainMenuCommands:function(){return ss.isValue(this.$7())&&ss.isValue(this.$7().get_quickFilterDomainCommands())?this.$7().get_quickFilterDomainCommands():{}},showContextMenu:function(n){var t=this.getContextMenuCommands();this.$4(t,n)},showDomainMenu:function(n){var t=this.getDomainMenuCommands();this.$4(t,n)},$4:function(n,t){var r=pi.$0(n),i;this.$6(t.domNode,r);i=null;i=ss.mkdel(this,function(){r.remove_hidden(i);this.$9=!1;this.$5();p.focusQfButton(t)});r.add_hidden(i)},$6:function(n,t){var i=new spiff.ShowMenuOptions($(n),!1),r;i.additionalMenuClass="tabQFContextMenu";r=i;t.show(r);this.$9=!0},showFilterPicker:function(){},getDomNode:function(){return this.domNode},destroyRecursiveShim:function(n){this.destroyRecursive(n)},startupShim:function(){this.startup()},updateAttributesShim:function(n){this.updateAttributes(n)},updateFilterStateShim:function(n){this.updateFilterState(n)},setTitleSizeShim:function(n,t){this.setTitleSize(n,t)},updateFilterPropertiesShim:function(n){this.updateFilterProperties(n)},updateSubWidgetShim:function(n){this.updateSubWidget(n)}},{$0:function(n){return tab.WidgetUtil.menuViewModelFromCommands(n,function(n){tab.WidgetUtil.commandMenuItemClicked(n)},null,null,null)}}),br=global.tab.Radiolist=ss.mkType(t,"tab.Radiolist",function(t,i,r){this.$3=null;this.contentNode=null;s.call(this,t,i,r);this.set_itemFormatter(ss.mkdel(n.filterItem,n.filterItem.formatRadiolistFilterItemHtml))},{get_scrollNode:function(){return this.contentNode},instantiate:function(n,t){var r,i;this.$3=this.parent.get_searchWidget();this.$3.setStyle(2);r=$(this.div).addClass("CFOuterContainer");this.$3.startupAndAppendTo(r);this.$3.hideUI();i=$("<div><\/div>").addClass("CFInnerContainer").addClass("tab-ctrl-formatted-text");BrowserSupport.BrowserSupport.IsFF()&&i.attr("tabindex","-1");r.append(i);this.contentNode=i.get(0);this.resetContent(n,t);this.disposables.add$1(spiff.EventUtil.bindWithDispose($(this.div),"click",ss.mkdel(this.parent,this.parent.onListItemClick)));this.div.addEventListener("focus",this.listItemFocusHandler,!0);this.disposables.add(ss.mkdel(this,function(){this.div.removeEventListener("focus",this.listItemFocusHandler,!0)}))},resetContent:function(t,i){var f=$(this.get_scrollNode()),r,u;if(f.empty(),this.shouldUseAllItem()&&t.length>0&&(a.addAllItem(f,this.parent,i,n.isAllOrAllChecked(this.parent),this.get_itemFormatter()),n.isAllOrAllChecked(this.parent)))for(r=0;r<t.length;r++)t[r].s=!1;ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=it.createRadiolist(this.parent,t,this.get_scrollNode(),i,this.get_lineHeight());u=this.get_scrollNode().querySelector("[role=listbox]");ss.isValue(u)&&u.setAttribute("aria-labelledby",this.parent.get_titleDomId())},updateContent:function(n){var t=$.contains(this.div,document.activeElement),i=n.length>0?n.join(""):this.$3.get_noMatchHtml(),r=$(this.get_scrollNode());ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null);r.html(i);this.updateTabIndexes(this.div,t)},shouldNotReinstantiate:function(){return ss.isValue(this.$3)&&this.$3.isShowingResults()},layout:function(n){if(this.inherited(arguments),ss.isValue(this.tiledWidget)&&this.tiledWidget.updateViewport(n.w,n.h),!tsConfig.is_mobile){var t=ss.isValue(this.$3)&&this.$3.get_isVisible()?dojo.marginBox(this.$3.domNode).h:0;this.get_scrollNode().style.height=this.div.clientHeight-t+"px"}},destroy:function(){this.dispose();ss.isValue(this.$3)&&this.$3.destroy();ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=null},fetchChildNodeByIndex:function(n){return ss.isValue(this.tiledWidget)?this.tiledWidget.getElement(n):this.getNonTiledElement(n,this.get_scrollNode())},fetchAllItem:function(){return this.shouldUseAllItem()&&ss.isValue(this.get_scrollNode())?this.get_scrollNode().firstChild:null},setupEventHandlers:function(){if(tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_CategoricalFilter")){var n=$(this.get_scrollNode());this.disposables.add$1(spiff.EventUtil.bindWithDispose(n,"contextmenu",ss.mkdel(this.parent,this.parent.handleContextMenuForList)))}}}),kr=global.tab.RadiolistContentFormatter=ss.mkType(t,"tab.RadiolistContentFormatter",function(n,t,i){at.call(this,n,t,i);this.tileHtml="<div id='{1}' role='listbox' class=\"tile tab-ctrl-formatted-text\" style=\"top: {0}px; position: absolute; width: 100%;\">"}),lt=global.tab.RawChange=ss.mkType(t,"tab.RawChange",function(){this.range=null;this.index=0;this.type=0;this.checkState=!1},{setRange:function(n,t){this.type=1;this.range=n;this.checkState=t},setSingle:function(n,t){this.type=0;this.index=n;this.checkState=t}}),vu=global.tab.RelativeDateFilterPeriodType=ss.mkEnum(t,"tab.RelativeDateFilterPeriodType",{year:"year",quarter:"quarter",month:"month",week:"week",day:"day",hour:"hour",minute:"minute",second:"second"},!0),yu=global.tab.RelativeDateFilterRangeType=ss.mkEnum(t,"tab.RelativeDateFilterRangeType",{curr:"curr",todate:"todate",last:"last",next:"next",lastn:"lastn",nextn:"nextn",other:"other",othern:"othern",invalid:"invalid"},!0),dr=global.tab.RelativeDateFilterViewModel=ss.mkType(t,"tab.RelativeDateFilterViewModel",function(n){this.$0=null;spiff.BaseViewModel.call(this);this.$0=n},{get_filterType:function(){return this.$0.get_filterType()},get_legacyRelativeDateQuickFilterModel:function(){return this.$0},get_defaultFormat:function(){return this.$0.get_defaultFormat()},get_fiscalYearStart:function(){return this.$0.get_fiscalYearStart()},get_noTime:function(){return this.$0.get_noTime()},get_isRelativeDatePick:function(){return this.$0.get_isRelativeDatePick()},get_text:function(){return this.$0.get_text()},get_relativeDateTable:function(){return this.$0.get_relativeDateTable()},get_periodType:function(){return this.get_relativeDateTable().periodType},get_rangeType:function(){return this.get_relativeDateTable().rangeType},get_rangeN:function(){return this.get_relativeDateTable().rangeN},get_anchor:function(){return ss.isValue(this.get_relativeDateTable().anchor)?this.get_relativeDateTable().anchor:null}}),w=global.tab.RelativeDatePickFilter=ss.mkType(t,"tab.RelativeDatePickFilter",function(){this.templateString="<div class='RelativeDatePickFilter'><div dojoAttachPoint='domBox' class='RelativeDatePickFilterBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='RDFButton RDFMenuButton' name='type' dojoAttachPoint='menuButton'dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'><\/div><div class='PicklistContentDiv tab-ctrl-formatted-coloronly' dojoAttachPoint='domPicker'><\/div><\/div><\/div><\/div>";this.widgetsInTemplate=!0;this.session=null;this.field="";this.stateId=0;this.rid=0;this.timestamp=0;this.currentRange=null;this.layoutSession=null;this.filterViewModel=null;this.currentAbbrev=null;this.showContextMenu=null;this.disposables=null;this.getContextMenuCommands=null;this.periodType=null;this.rangeType=null;this.rangeN=0;this.domPicker=null;this.getSID=null;this.$5=null;this.menuButton=null;h.call(this)},{get_filterViewModel:function(){return this.filterViewModel},get_shouldLayoutTitleAndContentOnSameLine:function(){return!this.hideEmptyTitlebar()&&this.titleW>0},postCreate:function(){this.get_filterViewModel().get_filterType()!=="RelativeDatePick";this.disposables=new tab.DisposableHolder;this.getSID=ss.mkdel(this,function(){return this.stateId});this.timestamp=(new Date).getMilliseconds();this.initFromState();$(this.menuButton.domNode).css("background-color",this.backgroundColor)},shouldHideDomainButton:function(){return!0},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},dispose:function(){this.disposables.dispose();this.showContextMenu=null},destroy:function(){this.dispose();this.domPicker.innerHTML="";this.inherited(arguments)},initFromState:function(){var n,t;this.currentRange=this.oFilter.table;this.currentAbbrev=this.toAbbrev(this.currentRange);this.domPicker.innerHTML="";n=i.formatColumnDisplayName(this.oFilter,!1,!1);this.domTitleBar.setAttribute("title",n);this.updateTitleBar();_.each(w.pickerStrings,ss.mkdel(this,function(n,t){var i=document.createElement("div"),r;i.innerHTML=tab.EscapingUtil.escapeHtml(n);i.classList.add("PickLabel");i.classList.add("tab-ctrl-formatted-border-hover");this.domPicker.appendChild(i);r=$(i);this.disposables.add$1(spiff.EventUtil.bindWithDispose(r,"click",this.$1(t)));tsConfig.is_authoring&&tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_LegacyRelativeDateQuickFilter")&&this.disposables.add$1(spiff.EventUtil.bindWithDispose(r,"contextmenu",this.$2(t)));ss.referenceEquals(this.currentAbbrev,w.pickerDurations[t])&&(this.$3(i),this.$5=i)}));this.layout(null);t=function(n,t){var i=$(n.domNode);t?(i.removeClass("RDFButtonR1"),i.addClass("RDFButtonHide")):(i.removeClass("RDFButtonHide"),i.addClass("RDFButtonR1"))};t(this.menuButton,this.shouldHideContextMenu())},$1:function(n){return ss.mkdel(this,function(t){this.onClick(n,t)})},$2:function(n){return ss.mkdel(this,function(t){spiff.EventUtil.stopEvent$2(t);this.onClick(n,t)})},$3:function(n){var t=$(n);t.addClass("Selected");t.addClass("tab-ctrl-formatted-widget");t.removeClass("tab-ctrl-formatted-border-hover");t.addClass("tab-ctrl-formatted-darker-border-hover")},$4:function(n){var t=$(n);t.removeClass("Selected");t.removeClass("tab-ctrl-formatted-widget");t.addClass("tab-ctrl-formatted-border-hover");t.removeClass("tab-ctrl-formatted-darker-border-hover")},formatTuple:function(n){return i.formatTupleDisplayName(n,!0,this.oFilter.role)},toAbbrev:function(n){var i=n.rangeN.toString(),t;switch(n.rangeType){case"curr":t="0";break;case"lastn":t="-"+i;break;case"nextn":t=i;break;default:return""}switch(n.periodType){case"year":t+="y";break;case"quarter":t+="q";break;case"month":t+="m";break;case"week":t+="w";break;case"day":t+="d";break;case"hour":t+="h";break;default:return""}return t},onClick:function(n,t){var i=w.pickerDurationsInteger[n];ss.referenceEquals(t.target,this.$5)||(ss.isValue(this.$5)&&this.$4(this.$5),this.$3(t.target),tab.FilterClientCommands.doRelativeDateQuickFilter(this.session.get_visualId(),this.field,"day","lastn",i))},doMenu:function(){this.showContextMenu(this.menuButton)},layout:function(){var t,n,r,i;($(this.domNode).removeClass("RDPFHorizontal"),this.updateTitleBar(),n=dojo.marginBox(this.domPicker),ss.isValue(n)&&ss.isValue(n.w)&&n.w!==0)&&(r=this.layoutTitleBar(),i=dojo.contentBox(this.domNode),t=i.w,this.get_shouldLayoutTitleAndContentOnSameLine()?($(this.domNode).addClass("RDPFHorizontal"),$(this.domTitleBar).css("float","left"),$(this.domPicker).css("float","left"),t=i.w-r.w):($(this.domTitleBar).css("float","none"),$(this.domPicker).css("float","none")),dojo.contentBox(this.domPicker,ss.mkdict(["w",t])))}}),gr=global.tab.ScrolledEventArgs=ss.mkType(t,"tab.ScrolledEventArgs",function(n){this.$0=null;ss.EventArgs.call(this);this.$0=n},{get_newPos:function(){return this.$0}}),wi=global.tab.SearchWidget=ss.mkType(t,"tab.SearchWidget",function(){this.templateString="<div class='Search'><div class='SearchBox tab-ctrl-formatted-border tab-ctrl-formatted-darker-border-hover' dojoAttachPoint='domQuerySection'><textarea rows='1' class='QueryBox' spellcheck='false'dojoAttachPoint='domQueryBox'dojoAttachEvent='onkeydown:onQueryBoxKeyDown,onpaste:onQueryBoxPaste'><\/textarea><span class='wcSearchX' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><img class='searchBusyImg' title='${CANCEL_SEARCH_TOOLTIP}' src='${busy_gif_url}'dojoAttachPoint='domSearchBusyImg'dojoAttachEvent='onclick:onSearchBusyImgClick'><\/img><span class='wcIconSearch' title='${SEARCH_TOOLTIP}'dojoAttachPoint='domSearchButton'dojoAttachEvent='onclick:onSearchButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><span class='wcIconSearchAdd' title='${ADD_ITEM_CTRL_ENTER}'dojoAttachPoint='domSearchAddButton'dojoAttachEvent='onclick:onSearchAddButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><\/div><div class='SearchResults' dojoAttachPoint='domResults' dojoAttachEvent='onclick:onListItemClick, onkeydown:onSearchResultsKeyDown'><\/div><\/div>";this.domQuerySection=null;this.domQueryBox=null;this.domSearchAddButton=null;this.domSearchButton=null;this.domSearchBusyImg=null;this.domResults=null;this.$b=null;this.applyDelay=500;this.$d=100;this.$c=-1;this._bSearching=!1;this._queryBoxPasteTimeout=null;this._searchTimer=null;this._isFilterSearchable=!1;this._initializedSearchResults=!1;this._domResultsPBExtents=null;this._lastRemoteSearch=null;f.call(this);this.$b=new ii(this)},{get_applyDelay:function(){return this.applyDelay},get_isPendingMode:function(){return!1},get_filterTable:function(){return!this.get_oResults()?null:this.get_oResults()},get_quickFilter:function(){return this.get_qf()},shouldDeferChanges:function(){return!1},postCreate:function(){this.inherited(arguments);this._isTypeInList&&this.showUI(!0);this._isFilterSearchable=!0;!!this.get_qf()&&this._isTypeInList&&(this._isFilterSearchable=this.get_qf().get_oFilter().is_searchable);this.domSearchAddButton.title=this._isFilterSearchable?this.ADD_ITEM_CTRL_ENTER:this.ADD_ITEM_ENTER;this.setQueryIconsVisibility(!0);d.disableTextSelection(this.domResults)},destroy:function(){ss.isValue(this.domResults)&&$([this.domResults]).remove();this.inherited(arguments)},onQueryBoxPaste:function(){this._queryBoxPasteTimeout=tab.MiscUtil.clearTimeout(this._queryBoxPasteTimeout);this._queryBoxPasteTimeout=window.setTimeout(ss.mkdel(this,this._handleQueryBoxPaste),10)},_handleQueryBoxPaste:function(){var t,n;n=this.getQuery();n=n.replace("/\r\n/g","\n");t=n.split("\n");t.length>1&&this.addManualSearchItems(t)},getOnQueryBoxKeyDownBehavior:function(n){var t,i,r;t=this.inherited(arguments);switch(n.keyCode){case 9:this.clearSearch(!0,!0);break;case 27:BrowserSupport.BrowserSupport.IsFF()&&(t.functionToCall=ss.mkdel(this,this.onXButtonClick));break;case 13:this._isTypeInList&&(t.stopEvent=!0,t.functionToCall=this._getEnterKeyDownBehaviorOnTypeInList(n));break;case 40:ss.isValue(this.domResults)&&this.isShowingResults()&&(i=this.$5(0),i.focus(),r=ss.mkdict(["ShiftKey",!1]),this.$b.handleSimpleSelection(r,0),t.functionToCall=null,t.stopEvent=!0)}return t},_getEnterKeyDownBehaviorOnTypeInList:function(n){return n.ctrlKey?ss.mkdel(this,this.onSearchAddButtonClick):this._isFilterSearchable?ss.mkdel(this,this.onSearchButtonClick):ss.mkdel(this,this.onSearchAddButtonClick)},handleQueryTextChanged:function(){this.inherited(arguments);this._isTypeInList&&this.clearSearch(!0,!0);this._isTypeInList||this.$a()},onSearchAddButtonClick:function(){this.addManualSearchItems(null)},onSearchButtonClick:function(){this.doSearch()},onSearchBusyImgClick:function(){this.$2()},focusQueryBox:function(){this.domQueryBox.focus()},getQuery:function(){return this.domQueryBox.value},setQuery:function(n){this.domQueryBox.value=n},showUI:function(){this.get_isVisible()||(this.get_qf().get_dijitDeclaredClass()!=="tableau.base.widget.LegacyCategoricalQuickFilter"||this.get_qf().get_oFilter().table.tuples.length!==0||this._isTypeInList)&&this.inherited(arguments)},clearSearch:function(){this.domResults.style.display="none";this.domResults.innerHTML="";this.$c=-1;this.clearRangeAnchorAndSelection();this.$2();this.inherited(arguments)},setQueryIconsVisibility:function(n){var t=this._isTypeInList,i=!!n&&n?!1:tableau.util.isElementVisible(this.domResults),r=!ss.isNullOrEmptyString(this.getQuery())&&t&&!i,e=r,u=r&&this._isFilterSearchable,f;this.domSearchBusyImg.style.display=u&&this._bSearching?"block":"none";this.domSearchButton.style.display=u&&!this._bSearching?"block":"none";this.domSearchAddButton.style.display=e?"block":"none";f=t&&!i?"none":"block";this.get_domXButton().style.display=f;this.fixQueryWidth()},fetchChildNodeByIndex:function(t){for(var r=this.domResults.childNodes,i=0,u=r.length;i<u;i++)if(n.filterItem.getIndex(r[i])===t)return r[i];return null},layout:function(n){this.setQueryIconsVisibility();var t=this.$4();this._isTypeInList||this.get_qf().get_mode()==="checkdropdown"?this.$7(t):t!==0&&this.$9(ss.idiv(ss.unbox(n),t),t)},fixQueryWidth:function(){var t=tableau.util.isElementVisible(this.get_domXButton()),i=tableau.util.isElementVisible(this.domSearchAddButton),r=tableau.util.isElementVisible(this.domSearchButton),u=tableau.util.isElementVisible(this.domSearchBusyImg),n=0;t&&(n+=dojo.marginBox(this.get_domXButton()).w);i&&(n+=dojo.marginBox(this.domSearchAddButton).w);r&&(n+=dojo.marginBox(this.domSearchButton).w);u&&(n+=dojo.marginBox(this.domSearchBusyImg).w);dojo.marginBox(this.domQueryBox,ss.mkdict(["w",dojo.contentBox(this.domQuerySection).w-n-1]))},$7:function(n){var r=$(tab.WorkbookView.dashboardSpacerSelector),y,p;this._initializedSearchResults||(this._initializedSearchResults=!0,r.append(this.domResults),$(this.domResults).css({position:"absolute","z-index":"987"}),this._domResultsPBExtents=dojo._getPadBorderExtents(this.domResults));var e=dojo.coords(this.domQuerySection),o=$(this.domQuerySection).offset(),s=r.offset(),u=tab.DoubleUtil.roundToInt(o.top)-tab.DoubleUtil.roundToInt(s.top),h=u+e.h,f=dojo.coords(r.get(0)),w=f.t+f.h,c=n+this._domResultsPBExtents.h,l=this.domResults.childNodes.length*n+this._domResultsPBExtents.h,a=w-h,v=u-f.t,i=!0,t=Math.min(l,a);t<c&&v>a&&(t=Math.min(l,v),i=!1);t=Math.max(t,c);dojo.marginBox(this.domResults,ss.mkdict(["w",e.w,"h",t]));y=i?h:u-t;p=tab.DoubleUtil.roundToInt(o.left)-tab.DoubleUtil.roundToInt(s.left);$(this.domResults).css({top:y+"px",left:p+"px","border-top-width":(i?0:1)+"px","border-bottom-width":(i?1:0)+"px"})},$9:function(n,t){var i=Math.max(this.domResults.childNodes.length,1),r=Math.min(i,Math.floor(n/2));this.domResults.style.height=(r*t).toString()+"px"},$4:function(){if(ss.isNullOrUndefined(this.domResults.firstChild))return 0;var n=$(this.domResults.firstChild);return ss.isValue(n[0].offsetHeight)?n[0].offsetHeight:15},$a:function(){this._searchTimer=tab.MiscUtil.clearTimeout(this._searchTimer);this._searchTimer=window.setTimeout(ss.mkdel(this,this.doSearch),this.searchDelay)},showSearchSpinner:function(n){this._bSearching=n;this.setQueryIconsVisibility()},addManualSearchItems:function(n){var u,t,f,i,r;if(this.get_qf().get_dijitDeclaredClass()==="tableau.base.widget.LegacyCategoricalQuickFilter"&&(tab.MiscUtil.isNullOrUndefined(n)&&(n=this.getQuery().split("\n")),!tab.MiscUtil.isNullOrEmpty(n))){for(u=[],t=0,f=n.length;t<f;t++)i=n[t],tab.MiscUtil.isNullOrEmpty$1(i)||u.push({d:i,s:!0,t:[{t:"s",v:i,s:null}]});r={};r.schema=this.get_qf().get_oFilter().table.schema;r.tuples=u;this.notifyParentFilterOfChanged(r,!0,!1);this.clearSearch(!1,!1)}},doSearch:function(){this.searchWithQuery(this.getQuery())},updateSearch:function(){this.get_isVisible()&&this.resultCount>0&&this.searchWithQuery(this.getQuery())},searchWithQuery:function(n){n.length<=0?this.clearSearch(!1,!1):this.get_qf().get_dijitDeclaredClass().indexOf("LegacyCategoricalQuickFilter")>-1&&!this._isTypeInList?this.get_qf().get_oFilter().isTiled?this.doRemoteSearch(n,!0):this.handleSearchResults(this.doCategoricalSearch(n)):this.doRemoteSearch(n,!1)},doRemoteSearch:function(n,t){this.showSearchSpinner(this._isTypeInList);this._lastRemoteSearch=this.doAjaxRemoteSearch(n,this.$d,t,ss.mkdel(this,this.handleSearchResults),ss.mkdel(this,this.handleSearchResultsError))},$2:function(){!this._lastRemoteSearch||(this._lastRemoteSearch.abort(),this._lastRemoteSearch=null);this.showSearchSpinner(!1)},$1:function(n,t,i){var u=tab.EscapingUtil.escapeHtml,r,f,e;!ss.isNullOrUndefined(i)&&t<i&&(r=i-t,n.push('<div class="searchResultsRemaining">'),r===1?n.push(u(tab.Strings.SearchResultsNotShownSingular)):(f={t:"i",v:r,s:null},e=tableau.format.formatDataValue(f,null,tab.ApplicationModel.get_instance().get_numberFormat(),null,0),n.push(u(tab.Strings.SearchResultsNotShownPlural(e)))),n.push("<\/div>"))},$8:function(t){var i,e,o,s;if(t.length<=0)return[];this.set_OResults(t);var r=this.get_oResults().tuples,f=this.get_oResults().indices,u=[],h=this.makeUniqueSearchItemIdPrefix();for(i=0,e=r.length;i<e;i++)o=!f?i:f[i],s=n.filterItem.getSearchResultHtml(this.get_qf(),r[i],h,o),u.push(s);return this.$1(u,r.length,t.actual_size),u},handleSearchResults:function(n){var i=tab.EscapingUtil.escapeHtml,t=tab.Strings.QuickFilterSearchNoMatches;(this.showSearchSpinner(!1),n&&n.dojoType==="cancel")||(this.domResults.innerHTML="",(this.get_qf().get_dijitDeclaredClass()==="tableau.base.widget.LegacyHierarchicalQuickFilter"||this._isTypeInList||this.get_qf().get_oFilter().isTiled)&&(!n.schema[0].collation||n.schema[0].collation.f!==0||(t="<div>"+i(t)+"<br/>"+i(tab.Strings.QuickFilterSearchDataIsCaseSensitive)+"<\/div>"),n=this.$8(n)),this.resultCount=n.length,this.domResults.innerHTML=this.resultCount>0?n.join(""):t,this.domResults.style.display=this.domResults.innerHTML.length>0?"block":"none",this.$c!==-1&&this.$5(this.$c).focus(),this.setQueryIconsVisibility(),this.get_qf().layout(null),this.$b.refreshRangeAnchorAndSelection())},handleSearchResultsError:function(){this.showSearchSpinner(!1);this.domResults.innerHTML="";this.resultCount=0},applyChanges:function(){var n=null;n=this.get_qf().get_dijitDeclaredClass()!=="tableau.base.widget.LegacyCategoricalQuickFilter"||this._isTypeInList?this.applyChangesHierOrTypeIn():this.applyChangesCat();this.notifyParentFilterOfChanged(n,!1,!1)},applyChangesByChangelist:function(n){this.get_qf().get_dijitDeclaredClass()!=="tableau.base.widget.LegacyCategoricalQuickFilter"||this._isTypeInList?this.applyChanges():this.get_qf().applyChangesByChangelist(n)},notifyParentFilterOfChanged:function(n,t,i){var r,u,f;n.tuples.length!==0&&((this.get_qf().updateStateFromSearch(n),i)||(r=this.get_qf(),r.set_stateId(r.get_stateId()+1),t?tab.FilterClientCommands.addManualFilterItems(this.get_qf().get_session().get_visualId(),this.get_qf().get_identifier(),n,t):(u=this._isTypeInList&&this.get_qf().get_oFilter().all,f=u||this.get_qf().isSingleSelect(),f?this.get_qf().get_dijitDeclaredClass()==="tableau.base.widget.LegacyHierarchicalQuickFilter"?this._doModifyHierarchialFilter(f,n):this.doSetCategoricalFilter(u,n):this.get_qf().get_dijitDeclaredClass()==="tableau.base.widget.LegacyHierarchicalQuickFilter"?this._doModifyHierarchialFilter(!1,n):this.doModifyCategoricalFilter(n))))},doSetCategoricalFilter:function(t,i){var u,f=[],e=i.tuples.length,r;if(t)for(r=0;r<e;r++)u=n.getAliasForTuple(i.tuples[r]),i.tuples[r].s&&f.push(u);else u=n.getAliasForTuple(i.tuples[0]),f.push(u);tab.FilterClientCommands.replaceCategoricalFilterValues(new tab.CancelDialog(null,null,null,!0),this.get_qf().get_session().get_visualId(),this.get_qf().get_identifier(),f)},doModifyCategoricalFilter:function(t){for(var u,f=[],r=[],e=t.tuples.length,i=0;i<e;i++)u=n.getAliasForTuple(t.tuples[i]),t.tuples[i].s?f.push(u):r.push(u);this._isTypeInList&&r.length===0?tab.FilterClientCommands.addManualFilterItems(this.get_qf().get_session().get_visualId(),this.get_qf().get_identifier(),t,!1):tab.FilterClientCommands.modifyCategoricalFilterValues(this.get_qf().get_session().get_visualId(),this.get_qf().get_identifier(),f,r,!0)},_doModifyHierarchialFilter:function(n,t){for(var h,r,u,e,o=[],s=[],c=n?"filter-replace":"filter-delta",l=t.tuples.length,f=t.tuples,i=0;i<l;i++){for(h=f[i].t.length,r="",u=0;u<h;++u)e=f[i].t[u],!e.v||(r=e.v);f[i].s?o.push(r):s.push(r)}tab.FilterClientCommands.doMemberHierarchialFilter(this.get_qf().get_session().get_visualId(),this.get_qf().get_field(),o,s,c)},applyChangesCat:function(){var i={},o,f,s,h,l,e;i.schema=this.get_qf().get_oFilter().table.schema;i.tuples=[];var t=this.domResults.firstChild,c=this.domResults.childNodes.length,r,u=this.get_qf().get_oFilter().table.tuples;if(this.get_qf().isSingleSelect()){for(o=0;o<c;o++,t=t.nextSibling)if(n.filterItem.isChecked(t)){for(r=n.filterItem.getIndex(t),this.recordCheckedChanges(i,t,u[r]),f=0;f<u.length;++f)f!==r&&(u[f].s=!1);break}}else{for(s=[],h=0;h<c;h++,t=t.nextSibling)r=n.filterItem.getIndex(t),this.recordCheckedChanges(i,t,u[r]),s[r]=1;for(t=this.get_qf().get_domContent().firstChild,n.filterItem.isAllItem(t)&&(t=t.nextSibling),l=u.length,e=0;e<l;e++,t=t.nextSibling)s[e]===0&&this.recordCheckedChanges(i,t,u[e])}return i},applyChangesHierOrTypeIn:function(){var n={},t,r,i,u;if(n.schema=this.get_oResults().schema,n.tuples=[],t=this.domResults.firstChild,ss.isNullOrUndefined(t))return n;for(r=this.get_oResults().tuples,i=0,u=r.length;i<u;i++,t=t.nextSibling)this.recordCheckedChanges(n,t,r[i]);return n},updateStateIfNeeded:function(){},handleClickIfPending:function(){},clearRangeAnchorAndSelection:function(){this.$b.clearRangeAnchorAndSelection()},forEachSelected:function(n){this.$b.forEachSelected(n)},onListItemClick:function(n){this.$b.onListItemClick(n)},onSearchResultsKeyDown:function(n){switch(n.which){case 39:case 40:this.$6(1,n);break;case 37:case 38:this.$6(-1,n);break;case 9:this.clearSearch(!0,!1);n.stopPropagation();return;case 27:this.clearSearch(!0,!1);this.focusQueryBox();break;case 32:this.$3();break;default:return}n.preventDefault();n.stopPropagation()},handleItemClick:function(){},recordCheckedChanges:function(t,i,r){n.filterItem.isChecked(i)&&!r.s?t.tuples.push(n.filterItem.setChecked(i,!0,r)):!n.filterItem.isChecked(i)&&r.s&&t.tuples.push(n.filterItem.setChecked(i,!1,r))},$6:function(t,i){var f=n.filterItem.getNodeFromEvent(i),r=n.getIndexFromId(f.getAttribute("id"))+t,u;r>=this.domResults.children.length?r=0:r<0&&(r=this.domResults.children.length-1);u=this.$5(r);u.focus();this.$b.handleSimpleSelection(i,r)},$5:function(n){return this.domResults.children[n]},$3:function(){var t=$(document.activeElement);t.is(".FIItem")&&(t.find("input:first").click(),this.$c=n.getIndexFromId(t.get(0).getAttribute("id")))}}),f=global.tab.SearchWidgetBase=ss.mkType(t,"tab.SearchWidgetBase",function(){this.isContainer=!1;this.domXButton=null;this.CANCEL_SEARCH_TOOLTIP=tab.Strings.QuickFilterSearchCancel;this.SEARCH_TOOLTIP=tab.Strings.QuickFilterSearchTooltip;this.ADD_ITEM_CTRL_ENTER=tab.Strings.QuickFilterSearchAddItemCtrlEnter;this.ADD_ITEM_ENTER=tab.Strings.QuickFilterSearchAddItemEnter;this.XBUTTON_CLOSE_TOOLTIP=tab.Strings.QuickFilterSearchCloseTooltip;this.XBUTTON_CLEAR_TOOLTIP=tab.Strings.QuickFilterSearchClearTooltip;this.NO_MATCHES=tab.Strings.QuickFilterSearchNoMatches;this.isVisible=!1;this.qf=null;this.oResults=null;this.resultCount=-1;this.searchDelay=400;this.busy_gif_url=null;this._isTypeInList=!1;this.$3$1=null;this.$3$2=null;Object.call(this)},{add_hidden:function(n){this.$3$1=ss.delegateCombine(this.$3$1,n)},remove_hidden:function(n){this.$3$1=ss.delegateRemove(this.$3$1,n)},add_escapeKeyPressed:function(n){this.$3$2=ss.delegateCombine(this.$3$2,n)},remove_escapeKeyPressed:function(n){this.$3$2=ss.delegateRemove(this.$3$2,n)},get_domXButton:function(){return this.domXButton},get_isVisible:function(){return this.isVisible},set_IsVisible:function(n){this.isVisible=n},get_qf:function(){return this.qf},set_Qf:function(n){this.qf=n},get_dijitDomNode:function(){return this.domNode},get_oResults:function(){return this.oResults},set_OResults:function(n){this.oResults=n},get_applyDelay:null,get_dijitClassName:function(){return this.declaredClass},postMixInProperties:function(){this.inherited(arguments);this.busy_gif_url=tableau.util.assetUrl("/images/busy.gif",!1)},postCreate:function(){this._isTypeInList=!!this.get_qf()&&this.get_qf().get_isTypeInList()},resize:function(n){dojo.marginBox(this.domNode,n);this.layout(null)},onQueryBoxKeyDown:function(n){var t=this.getOnQueryBoxKeyDownBehavior(n);!t||(t.stopEvent&&spiff.EventUtil.stopEvent(n),!t.functionToCall||window.setTimeout(t.functionToCall,10))},getOnQueryBoxKeyDownBehavior:function(n){var i={},t;i.functionToCall=null;i.stopEvent=!1;t=i;switch(n.keyCode){case 13:t.stopEvent=!0;break;case 27:t.stopEvent=!0;tab.MiscUtil.isNullOrEmpty$1(this.getQuery())&&(ss.staticEquals(this.$3$2,null)||this.$3$2());this.onXButtonClick(null);break;case 16:t.stopEvent=!0;break;case 17:t.stopEvent=!0;break;default:(n.keyCode>=32||n.keyCode===8)&&(t.functionToCall=ss.mkdel(this,this.handleQueryTextChanged))}return t},handleQueryTextChanged:function(){this.$0()},onXButtonClick:function(){if(this._isTypeInList)this.clearSearch(!1,!1);else{var n=this.getQuery();this.hideUI();n!==""&&this.showUI$1()}},onButtonHover:function(n){$(n.target).addClass("Hover")},onButtonUnhover:function(n){$(n.target).removeClass("Hover")},toggleUI:function(){this.get_isVisible()?this.hideUI():this.showUI$1()},applyChangesByChangelist:function(){throw new ss.NotSupportedException;},isShowingResults:function(){return this.isVisible&&this.resultCount>0},focusQueryBox:null,getQuery:null,setQuery:null,updateSearch:null,notifyParentFilterOfChanged:function(){},showUI$1:function(){this.showUI(!1)},showUI:function(n){this.get_isVisible()||($(this.domNode).css("display","block"),this.isVisible=!0,n||this.get_qf().layout(null),this.focusQueryBox())},hideUI:function(){this.get_isVisible()&&(this.clearSearch(!1,!0),$(this.domNode).css("display","none"),ss.staticEquals(this.$3$1,null)||this.$3$1(),this.isVisible=!1,this.get_qf().layout(null))},clearSearch:function(n,t){n||(this.setQuery(""),this.$0());this.resultCount=0;this.get_qf().layout(null);t||this.focusQueryBox()},doCategoricalSearch:function(t){var i=this.get_qf().get_oFilter(),r=this.makeUniqueSearchItemIdPrefix(),u=ss.mkdel(this,function(t,i,u){return n.filterItem.getSearchResultHtml(this.get_qf(),t,r,u)});return si.findMatches(t,i,ss.mkdel(this,this.formatTuple),u)},$0:function(){this.get_domXButton().title=ss.isNullOrEmptyString(this.getQuery())&&!this._isTypeInList?this.XBUTTON_CLOSE_TOOLTIP:this.XBUTTON_CLEAR_TOOLTIP},formatTuple:function(n){return i.formatTupleDisplayName(n,!0,this.get_qf().get_oFilter().role)},isSingleSelect:function(){return this.get_qf().isSingleSelect()},makeUniqueSearchItemIdPrefix:function(){return n.getBaseItemName(this.get_qf(),"SI")},currentDomain:function(){var n=tableau.types.QFDomain.QFD_ALL;return!this.get_qf().get_attributes()||(n=this.get_qf().get_attributes().values),n},doAjaxRemoteSearch:function(n,t,i,r,u){return this.get_qf().get_session().searchFilter(this.get_qf().get_identifier(),n,t,i,this.currentDomain(),r,u)}}),nu=global.tab.SimpleDropdown=ss.mkType(t,"tab.SimpleDropdown",function(t,i,r){o.call(this,t,i,r);this.set_itemFormatter(ss.mkdel(n.filterItem,n.filterItem.formatDropdownListFilterItemHtml))},{createListElement:function(t,i,r){var u=$(t),f,e;this.shouldUseAllItem()&&i.length>0&&a.addAllItem(u,this.parent,r,!1,ss.mkdel(n.filterItem,n.filterItem.formatDropdownListFilterItemHtml));ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=it.createSimpleList(this.parent,i,t,r,this.get_lineHeight());f=spiff.EventUtil.bindWithDispose(u,"click",ss.mkdel(this,this.onSelection));this.disposables.add$1(f);e=spiff.EventUtil.bindWithDispose(u,"touchend",ss.mkdel(this,this.onSelection));this.disposables.add$1(e);tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_RightClickDropdownItem")&&this.disposables.add$1(spiff.EventUtil.bindWithDispose(u,"contextmenu",ss.mkdel(this,this.onSelection)));u.on("keyup",ss.mkdel(this,this.$n));u.parent().toggleClass("CFDropdownNoItems",i.length===0);i.length===0&&u.text(tab.Strings.QuickFilterNoItems)},onSelection:function(t){var u=n.filterItem.getNodeFromEvent(t),i,r;if(!!u){if(i=n.filterItem.getIndex(u),i===-1&&!this.parent.get_oFilter().all){this.parent.doSelectAll(!0);this.hideMenu();return}if(i!==this.currentlySelected||this.multimode){if(i>=this.parent.get_oFilter().table.actual_size||i<0){this.hideMenu();return}this.parent.set_stateId(this.parent.get_stateId()+1);r=[];r.push(i);tab.FilterClientCommands.setCategoricalFilterValuesByIndex(new tab.CancelDialog(null,null,null,!0),this.parent.get_session().get_visualId(),this.parent.get_identifier(),r)}this.hideMenu()}},$n:function(n){switch(n.which){case 13:case 32:this.onSelection(n);break;default:return}n.preventDefault();n.stopPropagation()}}),gt=global.tab.SimpleListContentFormatter=ss.mkType(t,"tab.SimpleListContentFormatter",function(n,t,i){this.$0=null;this.$2=null;this.$1=null;this.tileHtml="<div id='{1}' role='listbox' class=\"tile tab-ctrl-formatted-text\" style=\"top: {0}px; left: 0; right: 0; position: absolute; width: 100%;\">";this.$0=n;this.$2=t;this.$1=i},{destroy:function(){},format:function(n,t,i){var r="",f=ss.safeCast(n,Array),u,e;if(ss.isNullOrUndefined(t)||ss.isNullOrUndefined(i)||!this.isValid(f))return r;for(r+=ss.formatString(this.tileHtml,t.y.toString(),tab.DomUtil.generateUniqueId()),u=0,e=i.get_from();u<f.length;++u,++e)r+=this.$1(this.$0,f[u],this.$2,e);return r+"<\/div>"},isValid:function(){return!0}}),ot=global.tab.Slider=ss.mkType(t,"tab.Slider",function(n,t,i,r,u,f,e){this.$i=null;this.styleid=0;this.$w=null;this.$B=-1;this.$s=["show-readout","hide-readout"];this.$v=["show-slider","hide-slider"];this.$f=["show-step-btns","hide-buttons"];this.$A=["show-ticks","hide-ticks"];this.div=null;this.$g=null;this.currentlySelected=0;this.numValues=0;this.$x=null;this.$y=null;this.slider=null;this.readout=null;this.$n=!1;this.$z=null;this.$D=null;this.$p=null;this.$t=null;this.$o=!1;this.$l=null;this.$E=null;this.$u=!1;this.$k=null;this.$m=!1;this.$j=null;this.$q=null;this.$h=null;this.$r=!1;this.$C=null;this.div=n;this.$g=t;this.$m=i;this.$j=r;this.$l=u;this.$k=f;this.$q=e;$(this.div).addClass("tableauWidgetUiSlider");this.$i=new tab.DisposableHolder;this.currentlySelected=-1},{get_oneLineLayout:function(){return this.$r},$b:function(n){return this.$g[n[0]]!=="false"&&this.$g[n[1]]!=="true"},calculateStyleid:function(){this.styleid=0;this.$b(this.$s)||(this.styleid+=4);this.$b(this.$v)||(this.styleid+=2);this.$b(this.$f)||(this.styleid+=1);this.styleid>5&&(this.styleid=3)},dispose:function(){this.$i.dispose()},destroy:function(){dojo.unsubscribe(this.$x);dojo.unsubscribe(this.$y);this.$6();this.dispose();ss.isValue(this.$C)&&(this.$C.domNode.parentNode.removeChild(this.$C.domNode),this.$C=null);ss.isValue(this.slider)&&typeof this.slider.destroy=="function"&&this.slider.destroy();ss.isValue(this.$w)&&typeof this.$w.destroy=="function"&&this.$w.destroy();var n=$(this.div);n.removeClass("tableauWidgetUiSlider");n.empty()},instantiateFromDomain:function(n,t){for(var r=[],u=n.length,i=0;i<u;i++)r[i]={d:n[i],s:ss.referenceEquals(t,n[i]),t:[]};this.instantiateFromTuples(r,null)},instantiateFromTuples:function(n,t){var r=-1,u=tab.Strings.QuickFilterUnknown,f,i;if(n.length>0)for(f=n.length,i=0;i<f;i++)n[i].s&&!this.$m&&(r>-1?u=tab.Strings.QuickFilterMultipleValues:(r=i,u=this.$k(i)));r<0&&(r=0,ss.isValue(t)&&(u=t));this.instantiate(n.length,r,u)},instantiate:function(n,t,i){var e=null,u,o,r,f,s;(this.currentlySelected=t,this.calculateStyleid(),this.$b(this.$s)&&(this.readout=document.createElement("div"),this.readout.classList.add("sliderTextReadout"),this.readout.classList.add("tab-ctrl-formatted-widget"),this.readout.classList.add("tab-ctrl-formatted-fixedsize"),this.$z=document.createElement("div"),this.$z.classList.add("sliderText"),this.$z.innerHTML=tab.EscapingUtil.escapeHtml(i),this.readout.appendChild(this.$z),this.div.appendChild(this.readout)),this.styleid!==3)&&(u=document.createElement("div"),this.$b(this.$v)&&(e=document.createElement("div"),u.appendChild(e)),this.div.appendChild(u),(!ss.isValue(n)||ss.unbox(n)<1)&&(n=1),this.$n=!isFinite(ss.unbox(n)),this.$b(this.$v)&&ss.Nullable$1.lt(n,1200)&&this.$b(this.$A)&&(o=ss.mkdict(["count",n]),this.$w=new dijit.form.HorizontalRule(o,e)),r={templateString:"<div class='dijit dijitReset'><div class='dijitReset tableauSlider' dojoAttachPoint='tableauSlider'><table class='dijit dijitReset' cellspacing='0' cellpadding='0' border='0' rules='none' wairole='presentation'><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,topDecoration' class='dijitReset' style='text-align:center;width:100%;'><\/td><td class='dijitReset'><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper' dojoAttachEvent='onclick:_onClkDecBumper'><\/div><\/td><td class='dijitReset'><input dojoAttachPoint='valueNode' type='hidden' name='${name}'><div class='dijitReset dijitSliderBarContainerH' waiRole='presentation' dojoAttachPoint='sliderBarContainer'><div waiRole='presentation' dojoAttachPoint='progressBar' class='dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH' dojoAttachEvent='onclick:_onBarClick'><div class='dijitSliderMoveable dijitSliderMoveableH'><div dojoAttachPoint='sliderHandle,focusNode' class='dijitSliderImageHandle dijitSliderImageHandleH' dojoAttachEvent='onmousedown:_onHandleClick' waiRole='slider' valuemin='${minimum}' valuemax='${maximum}'><\/div><\/div><\/div><div waiRole='presentation' dojoAttachPoint='remainingBar' class='dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH' dojoAttachEvent='onclick:_onBarClick'><\/div><\/div><\/td><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper' dojoAttachEvent='onclick:_onClkIncBumper'><\/div><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,bottomDecoration' class='dijitReset'><\/td><td class='dijitReset'><\/td><\/tr><\/table><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowDec' style='display:none' dojoAttachPoint='decrementButton'><div class='dijitSliderDecrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>-<\/span><\/div><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowInc' style='display:none' dojoAttachPoint='incrementButton'><div class='dijitSliderIncrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>+<\/span><\/div><\/div><\/div>",onChange:ss.mkdel(this,this.$1),value:this.currentlySelected,slideDuration:0,intermediateChanges:!0,showButtons:this.$b(this.$f),pageIncrement:1},isFinite(ss.unbox(n))&&(r.minimum=0,r.maximum=ss.unbox(n)-1,r.discreteValues=ss.unbox(n)),this.slider=new dijit.form.HorizontalSlider(r,u),f=$(this.slider.sliderHandle),this.$i.add$1(spiff.EventUtil.bindWithDispose(f,"keydown",ss.mkdel(this,this.handleKeyDown))),this.$x=dojo.subscribe("/dnd/move/start",ss.mkdel(this,this.startDrag)),this.$y=dojo.subscribe("/dnd/move/stop",ss.mkdel(this,this.stopDrag)),this.slider.startup(),ss.isValue(this.$w)&&this.$w.startup(),this.$u=!1,this.$b(this.$s)||(this.$D=document.createElement("div"),this.slider.sliderHandle.appendChild(this.$D),s=dijit._MasterTooltip.prototype,s.templateString="<div class='dijitTooltip dijitTooltipLeft' id='dojoTooltip'><div class='dijitTooltipContainer' dojoAttachpoint='coreArea'><div class='dijitTooltipContents' dojoAttachPoint='containerNode' waiRole='alert'><\/div><\/div><div class='dijitTooltipConnector'><\/div><\/div>",this.$C=new dijit._MasterTooltip,this.$C.dojoOrient=this.$C.orient,this.$C.orient=ss.mkdel(this,function(n,t,i,r){this.$C.dojoOrient(n,t,i,r);$(this.$C.domNode).addClass("sliderThumbTooltip")}),this.$i.add$1(spiff.EventUtil.bindWithDispose(f,"mouseenter",ss.mkdel(this,this.$8))),this.$i.add$1(spiff.EventUtil.bindWithDispose(f,"mouseleave",ss.mkdel(this,this.$7)))),this.$p=this.slider.decrementButton.childNodes[0],this.$t=this.slider.incrementButton.childNodes[0],this.$0(),this.$d(),this.$5())},$0:function(){var n=new EventUtils.TableauEventHandler(this.slider.sliderHandle,new EventUtils.EventHandleSpec),t=new EventUtils.TableauEventHandler(this.$p,new EventUtils.EventHandleSpec),i=new EventUtils.TableauEventHandler(this.$t,new EventUtils.EventHandleSpec);this.$i.add$1(n);this.$i.add$1(t);this.$i.add$1(i);this.slider.decrementButton.addEventListener("mousedown",ss.mkdel(this,this.$4),!0);this.slider.incrementButton.addEventListener("mousedown",ss.mkdel(this,this.$4),!0);this.$i.add(ss.mkdel(this,function(){this.slider.decrementButton.removeEventListener("mousedown",ss.mkdel(this,this.$4),!0);this.slider.incrementButton.removeEventListener("mousedown",ss.mkdel(this,this.$4),!0)}))},$d:function(){this.$9(this.$p,"Left",this.currentlySelected===0);ss.isValue(this.slider)&&this.$9(this.$t,"Right",this.currentlySelected===this.slider.maximum)},$9:function(n,t,i){var r=$(n);r.removeClass("cp"+t+"Arrow"+(i?"Black":"Grey"));r.addClass("cp"+t+"Arrow"+(i?"Grey":"Black"))},setNewState:function(n){this.currentlySelected=n;ss.isValue(this.slider)&&this.slider._setValueAttr(this.currentlySelected)},$4:function(n){tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_Parameters")&&n.button===2&&spiff.EventUtil.stopEvent(n)},handleKeyDown:function(n){n.charOrCode=n.which;this.slider._onKeyPress(n)},startDrag:function(n){ss.isValue(this.slider)&&ss.isValue(n)&&ss.referenceEquals(n.node,this.slider.sliderHandle)&&(this.$o=!0,this.$B>0&&this.$6())},stopDrag:function(n){ss.isValue(this.slider)&&ss.isValue(n)&&ss.referenceEquals(n.node,this.slider.sliderHandle)&&(this.$o=!1,this.$B>0&&this.$6(),this.$a(),this.$2())},$8:function(){this.$b(this.$s)||(this.$E=tab.MiscUtil.clearTimeout(this.$E),this.$u=!0,this.$E=window.setTimeout(ss.mkdel(this,this.$2),50))},$7:function(){this.$E=tab.MiscUtil.clearTimeout(this.$E);ss.isValue(this.$C)&&this.$C.hide(this.$D);this.$u=!1},$2:function(){var n,t,i;this.$b(this.$s)||(this.$C.hide(this.$D),(this.$u||this.$o)&&(n=this.$h,ss.isNullOrUndefined(n)&&(n=ss.trunc(this.currentlySelected)),t=n,i=this.$k(t),this.$C.show(i,this.$D,["above","below"])))},$3:function(){var n;return!ss.isValue(this.$h)||isNaN(ss.unbox(this.$h))?0:(n=this.$n?ss.unbox(this.$h):parseInt(ss.unbox(this.$h).toString(),10),n<0&&(n=0),n)},$e:function(){if(!ss.isNullOrUndefined(this.$h)&&!ss.isNullOrUndefined(this.currentlySelected)&&this.$h!==this.currentlySelected){var n=this.$3();ss.isValue(this.$j)&&this.$j(n);this.$h=n;this.currentlySelected=n;this.$d()}},updateReadout:function(n){this.styleid<4&&(this.$z.innerHTML=n)},$1:function(n){isNaN(n)||(this.updateReadout(this.$k(n)),this.$h=n,ss.isValue(this.$q)&&this.$q(),this.$o?this.$B>0&&this.$6():(this.$B>0&&this.$6(),this.$a()),this.$2())},$5:function(){this.$b(this.$f)?(this.div.classList.remove("HideArrows"),this.div.classList.remove("ShowArrows")):this.div.classList.add("HideArrows");this.$b(this.$v)?this.div.classList.remove("HideSlider"):this.div.classList.add("HideSlider");this.styleid>3&&$(this.div).css("height","15px")},$a:function(){this.$B=window.setTimeout(ss.mkdel(this,this.$c),500)},$6:function(){this.$B>0&&(window.clearTimeout(this.$B),this.$B=-1)},$c:function(){this.$e()},layout:function(){var t=0,r=34,u,f,n,i;(this.$r=!1,u=$(this.div),u.css("overflow","hidden"),f=dojo.marginBox(this.div).h,n=parseFloat(u.css("width"))-5,u.css("overflow",""),n<r)||(ss.isValue(this.readout)&&($(this.readout).css("width",""),$(this.readout).css("float","none")),ss.isValue(this.slider)&&($(this.slider.tableauSlider).css("width",""),$(this.slider.tableauSlider).css("float","none")),ss.isValue(this.$w)&&this.$w.count*4>n&&$(this.$w.domNode).css("display","none"),f<38&&this.styleid<=1?(i=this.styleid===0?n-r:n,i=Math.floor((i-14)/2),$(this.readout).css("width",i+"px"),ss.isValue(this.slider)&&$(this.slider.tableauSlider).css("width",i+"px"),$(this.readout).css("float","left"),ss.isValue(this.slider)&&$(this.slider.tableauSlider).css("float","left"),this.$r=!0):(this.styleid===0||this.styleid===4)&&ss.isValue(this.slider)?$(this.slider.tableauSlider).css("width",n-r+"px"):(this.styleid===1||this.styleid===5)&&ss.isValue(this.slider)?$(this.slider.tableauSlider).css("width",n+"px"):this.styleid===2&&$(this.readout).css("width",n-r-4+"px"),this.$b(this.$f)&&((this.styleid===2||this.styleid===4)&&(t=1),this.styleid===0&&(t=this.$r?1:20),t+=this.$l(),ss.isValue(this.slider)&&($(this.slider.incrementButton).css("top",t+"px"),$(this.slider.decrementButton).css("top",t+"px"))))}}),tu=global.tab.SliderCatmode=ss.mkType(t,"tab.SliderCatmode",function(n,t,i){this.$3=null;this.$4=null;s.call(this,n,t,i)},{instantiate:function(t){this.$3=t;var i=n.isAllOrAllChecked(this.parent);this.shouldUseAllItem()?this.$3=n.addAllItemToTuples(this.$3,i):i=!1;this.$4=new tableau.base.widget.ui.Slider(this.div,this.attributes,i,ss.mkdel(this,this.updateViz),ss.mkdel(this.parent,this.parent.getTitleOffset),ss.mkdel(this,this.getCurrentText),ss.mkdel(this,this.onIntermediateChange));this.$4.instantiateFromTuples(this.$3,this.getSummaryText())},destroy:function(){this.$4.destroy()},resetContent:function(n,t){var i=ss.referenceEquals(this.$4.slider.sliderHandle,document.activeElement);this.$4.destroy();this.instantiate(n,t);i&&this.$4.slider.sliderHandle.focus()},layout:function(){this.inherited(arguments);this.$4.layout()},showOrHide:function(n,t){n.style.display=t?"":"none"},onSmallSearchUI:function(n,t){var r=!n,i=this.$4;(i.styleid===2||i.styleid===4)&&(this.showOrHide(i.slider.decrementButton,r),this.showOrHide(i.slider.incrementButton,r));i.styleid===3?(this.showOrHide(i.div,r),t.style.marginBottom="2px"):i.styleid<3?(this.showOrHide(i.readout,r),i.get_oneLineLayout()&&this.showOrHide(i.div,r)):this.showOrHide(i.slider.tableauSlider,r)},getRealIndex:function(n){if(typeof n=="undefined"||isNaN(n))return 0;var t=parseInt(n.toString(),10);return t<0&&(t=0),t},updateViz:function(t){var r={},f;r.schema=this.parent.get_oFilter().table.schema;r.tuples=[];var e=r,i=this.getRealIndex(t),u=new Array(0);if(this.shouldUseAllItem()&&i===0){this.parent.doSelectAll(!0);return}this.$3[i].s=!0;e.tuples.push(this.$3[i]);this.parent.set_stateId(this.parent.get_stateId()+1);f=n.getAliasForTuple(this.$3[i]);u.push(f);tab.FilterClientCommands.replaceCategoricalFilterValues(new tab.CancelDialog(null,null,null,!0),this.parent.get_session().get_visualId(),this.parent.get_identifier(),u)},onIntermediateChange:function(){this.parent.get_searchWidget().get_isVisible()&&this.parent.get_searchWidget().toggleUI()},getCurrentText:function(n){var t=this.getRealIndex(n),r=this.$3[t];return i.formatTupleDisplayName(r,!0,this.parent.get_oFilter().role)}}),c=global.tab.SliderConstants=ss.mkType(t,"tab.SliderConstants",function(){}),iu=global.tab.SmallSearchWidget=ss.mkType(t,"tab.SmallSearchWidget",function(){this.templateString="<div class='SmallSearch'><div class='SmallSearchBox' dojoAttachPoint='domSearchBox'><div class='Autocompleter' dojoAttachPoint='domAutocompleter'><\/div><div class='wcSearchX dijitInlineTable' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/div><\/div><\/div>";this.domSearchBox=null;this.domAutocompleter=null;this.autocompleter=null;f.call(this)},{get_applyDelay:function(){return window.alert(tab.Strings.noLoc("Bad call of ApplyDelay on SmallSearchWidget")),0},startup:function(){var n,t;this.inherited(arguments);n={};n.store=null;n.autoComplete=!1;n.hasDownArrow=!1;n.highlightMatch="none";n.searchDelay=this.searchDelay;n.onChange=ss.mkdel(this,this.applyChanges);n.onKeyDown=ss.mkdel(this,this.onQueryBoxKeyDown);this.autocompleter=new dijit.form.ComboBox(n,this.domAutocompleter);this.autocompleter.startup();this.autocompleter._getQueryString=function(n){var i=n.length,t;return i<1?"":n.charCodeAt(0)===39&&n.charCodeAt(i-1)===39?n.substr(1,i-2):(t=n,t.length>1&&t.charCodeAt(0)===92&&t.charCodeAt(1)===42&&(t="*"+t.substr(2)),t.length>1&&t.charCodeAt(t.length-2)===92&&t.charCodeAt(t.length-1)===42&&(t=t.substr(0,t.length-2)+"*"),t.charCodeAt(0)!==42&&t.charCodeAt(t.length-1)!==42&&(t="*"+t+"*"),t)};t=this.NO_MATCHES;this.autocompleter.DOJO_openResultList=this.autocompleter._openResultList;this.autocompleter._openResultList=ss.mkdel(this,function(n,i){this.resultCount=n.length;this.autocompleter.DOJO_openResultList(n,i);!n.length?(this.autocompleter.tooltipPosition=["above","below"],this.autocompleter.displayMessage(t)):dijit.hideTooltip(this.autocompleter.domNode);BrowserSupport.BrowserSupport.IsIE()&&this.focusQueryBox()})},getOnQueryBoxKeyDownBehavior:function(n){var t,i,r;t=this.inherited(arguments);switch(n.keyCode){case 13:t.functionToCall=null;t.stopEvent=!1;break;case 40:t.functionToCall=null;t.stopEvent=!1;BrowserSupport.BrowserSupport.IsIE()&&(i=this.$1(),i.attr("tabindex","1").keydown(ss.mkdel(this,this.$2)),i.eq(0).get(0).focus(),r=$(this.domNode.parentElement),r.find("input").eq(0).val(i.eq(0).html()),t.stopEvent=!0);$(n.target).hasClass("dijitReset")||(t.stopEvent=!0);break;case 37:case 39:case 38:t.functionToCall=null;t.stopEvent=!1;break;default:t.functionToCall=ss.mkdel(this,this.onSmallSearchKeyDown);t.stopEvent=!1}return t},onSmallSearchKeyDown:function(){this.autocompleter._startSearchFromInput()},$2:function(n){switch(n.which){case 40:case 38:this.$3(n.currentTarget,n.which===38);n.preventDefault();break;case 9:n.preventDefault();break;case 13:this.applyChanges($(this.domNode).find("input").val())}},$3:function(n,t){for(var r,e,o,u=this.$1(),i=0,f=u.length;i<f;i++)if(ss.referenceEquals(u.eq(i).get(0).getAttribute("id"),n.getAttribute("id"))){if(r=null,t||i===f-1){if(t&&i!==0)r=u.eq(i-1);else if(t&&i===0){e=$(this.domNode.parentElement);e.find("input").eq(0).get(0).focus();return}}else r=u.eq(i+1);ss.isValue(r)&&(r.focus(),o=$(this.domNode.parentElement),o.find("input").eq(0).val(r.html()));return}},$1:function(){return $(".dijitPopup .dijitMenu li.dijitReset")},getDataStore:function(){for(var t=[],r=this.get_qf().get_oFilter().table.tuples,n=0,i=r.length;n<i;n++)t.push(ss.mkdict(["name",this.formatTuple(r[n])]));return new dojo.data.ItemFileWriteStore(ss.mkdict(["data",ss.mkdict(["items",t])]))},destroy:function(){this.domSearchBox.innerHTML="";this.autocompleter.destroy();this.autocompleter=null;this.inherited(arguments)},focusQueryBox:function(){this.autocompleter.focus()},getQuery:function(){return this.autocompleter.attr("value")},setQuery:function(n){this.autocompleter.attr("value",n)},fixQueryWidth:function(){var t=dojo.marginBox(this.domNode).w,n;t>25&&(n=ss.mkdict(["w",t-25]),dojo.marginBox(this.autocompleter.comboNode,n),dojo.marginBox(this.autocompleter.comboNode.firstChild,n),dojo.marginBox(this.autocompleter.textbox,n));this.autocompleter.comboNode.style.cssFloat="left"},showUI:function(n){if(!this.get_isVisible()){f.prototype.showUI.call(this,n);this.get_qf().get_modeContents().onSmallSearchUI(!0,this.domNode)}},hideUI:function(){if(this.get_isVisible()){f.prototype.hideUI.call(this);this.get_qf().get_modeContents().onSmallSearchUI(!1,this.domNode)}},layout:function(){this.fixQueryWidth()},updateSearch:function(){this.autocompleter.store=this.getDataStore();this.get_qf().get_modeContents().onSmallSearchUI(this.get_isVisible(),this.domNode)},applyChanges:function(t){var u,r,i,f,e,o;if(!!t){for(u=[],r=this.get_qf().get_oFilter().table.tuples,i=0,f=r.length;i<f;i++)ss.referenceEquals(t,this.formatTuple(r[i]))?(u.push(r[i]),r[i].s=!0):r[i].s&&delete r[i].s;if(u.length!==0){this.get_qf().updateStateFromSearch(null);e=n.getAliasForTuple(u[0]);o=[e];tab.FilterClientCommands.replaceCategoricalFilterValues(new tab.CancelDialog(null,null,null,!0),this.get_qf().get_session().get_visualId(),this.get_qf().get_identifier(),o);this.clearSearch(!1,!0);this.onXButtonClick(null)}}}}),b=global.tab.TabbedNavigation=ss.mkType(t,"tab.TabbedNavigation",function(n){var r,t,i;this.baseClass="tableauTabbedNavigation";this.templateString="<div style='width:${innerWidth};' class='tabbedNavigationOuterWrapper' role='navigation'><div id='container' dojoType='dijit.layout.LayoutContainer' style='width:100%; height:100%;' dojoAttachPoint='_innerWrapper'><button dojoType='dijit.form.Button' class='tabsMenuBtn' layoutAlign='left' id='menuBtn' dojoAttachPoint='_menuBtn' style='display:none;'><\/button><button dojoType='dijit.form.Button' class='tabsLeftBtn' layoutAlign='left' dojoAttachPoint='_leftBtn' style='display:none;'><\/button><button dojoType='dijit.form.Button' class='tabsRightBtn' layoutAlign='right' dojoAttachPoint='_rightBtn' style='display:none;'><\/button><div dojoType='dijit.layout.LayoutContainer' layoutAlign='client' dojoAttachPoint='_containerNode'><div class='dijitTabContainerTop-tabs' dojoAttachPoint='_scrollNode' role='tablist'><\/div><\/div><\/div><\/div>";this.widgetsInTemplate=!0;this.innerWidth="100%";this.selectedTabArrayIndex=0;this.$k=0;this.$o=null;this.$l=null;this.$m=new tab.DisposableHolder;this.$n=null;this.currentTab=null;this._scrollNode=null;this._leftBtn=null;this._rightBtn=null;this._menuBtn=null;this._containerNode=null;this._innerWrapper=null;this.$p=null;this._anim=null;this._buttons=null;Object.call(this);this.$o=[];this.$l=[];this.$o=tsConfig.visible_sheets||this.$o;r=this._indexOf(this.$o,tsConfig.current_sheet_name);t=r;ss.isNullOrUndefined(t)&&(t=this.selectedTabArrayIndex);this.selectedTabArrayIndex=t;this.innerWidth=n.innerWidth||this.innerWidth;i=ss.mkdel(this,function(){this.$g(this.currentTab)});tab.ServerFontLoader.get_instance().add_fontPreparationComplete(i);this.$m.add$1(new tab.CallOnDispose(function(){tab.ServerFontLoader.get_instance().remove_fontPreparationComplete(i)}))},{get_widgetDomNode:function(){return this.domNode},startup:function(){$(this._leftBtn.domNode).find("button").addClass("tnLeftButton");$(this._rightBtn.domNode).find("button").addClass("tnRightButton");$(this._menuBtn.domNode).find("button").addClass("tnMenuButton");this.containerNode=this.domNode;this.inherited(arguments)},destroy:function(){var n,t;for(tab.MiscUtil.dispose$1(this.$p),n=0;n<this.$l.length;n++)t=this.$l[n],t.destroyRecursive();this.$m.dispose();this.inherited(arguments)},layout:function(n){if(this.$o.length!==0){var i=dojo.contentBox(this._containerNode.domNode),t=this.$i(i.w);this._buttons.css("display",t?"":"none");this._innerWrapper.layout(n);this._containerNode.domNode.style.top="-1px";this._rightBtn.domNode.style.height="auto";t||(this._containerNode.domNode.scrollLeft=0);this.$a(this.currentTab);this.$j();this.$f();tabBootstrap.VizLayoutConstants.get_shouldShowTabs()?($(".tabbedNavigationWrapper").css("visibility","visible"),$(".tabbedNavigationOuterWrapper").css("display","")):$(".tabbedNavigationOuterWrapper").css("display","none")}},postCreate:function(){var n,t;for(tab.Application.add_onTabSelect(ss.mkdel(this,this.$d)),tab.CommandController.get().add_newLayoutId(ss.mkdel(this,this.$b)),this.$m.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){tab.Application.remove_onTabSelect(ss.mkdel(this,this.$d));tab.CommandController.get().remove_newLayoutId(ss.mkdel(this,this.$b))}))),this.inherited(arguments),this.$0(),this.$n=[],n=0;n<this.$o.length;n++)t=this.$o[n],this.addTab(t,n,tsConfig.repository_urls[n]),this.addToMenu(this.$n,t);this._buttons=$(this.domNode).find(".dijitButton");this.layout(null);this.$k=this.selectedTabArrayIndex;this.currentTab=this.$l[this.selectedTabArrayIndex];ss.isValue(this.currentTab)&&b.$1(this.currentTab.domNode,!0)},chooseTabByName:function(n){if(!ss.isNullOrUndefined(n)){var t=this.$3(n);ss.isValue(t)&&this.chooseTab(t)}},chooseTab:function(n){ss.isNullOrUndefined(n)||this.$1(n)},addTab:function(n,t,i){var o=document.createElement("span"),u,r,f,e,s,h;this._scrollNode.appendChild(o);u=this.baseClass+"_tab_"+t;r={};r.id=u;r.label=tab.EscapingUtil.escapeHtml(n);r.value=n;r.showLabel=!0;r.repository_url=i;r.onKeyDown=ss.mkdel(this,function(n){switch(n.keyCode){case 13:case 32:this.$h(u);spiff.EventUtil.stopEvent(n);break;case 39:case 40:this.$4();spiff.EventUtil.stopEvent(n);break;case 37:case 38:this.$5();spiff.EventUtil.stopEvent(n);break;case 9:var i=this._indexOf(this.$o,tsConfig.current_sheet_name),t=i;ss.isNullOrUndefined(t)&&(t=this.selectedTabArrayIndex);this.$k=t}});f=new dijit.layout._TabButton(r,o);e=new EventUtils.EventHandleSpec;e.tap=ss.mkdel(this,function(){this.$h(u)});s=e;h=new EventUtils.TableauEventHandler(f.domNode,s);this.$m.add$1(h);b.$2(f);this.$l.push(f)},addToMenu:function(n,t){var i=spiff.MenuItem.newActionItem(t,ss.mkdel(this,function(){this.chooseTabByName(t)}),!0,"");n.push(i)},resize$1:function(){this._innerWrapper.resize();this.layout(null)},$e:function(n){var t=this.$3(n);this.$a(t)},$d:function(n){this.$e(n.sheetName)},$b:function(n){this.$e(n.sheetName)},$3:function(n){for(var t=0;t<this.$l.length;t++)if(ss.referenceEquals(this.$l[t].value,n))return this.$l[t];return null},$4:function(){this.$k++;this.$k>this.$l.length-1&&(this.$k=0);var n=this.$6(),t=dijit.byId(n);t.domNode.focus();this.$j()},$5:function(){this.$k--;this.$k<0&&(this.$k=this.$l.length-1);var n=this.$6(),t=dijit.byId(n);t.domNode.focus();this.$j()},$6:function(){return this.baseClass+"_tab_"+this.$k},$h:function(n){var t=dijit.byId(n);this.chooseTab(t)},$9:function(){var n=$(this._scrollNode).find(".dijitTab"),i,t;return n.length?(i=n[0],t=n[n.length-1],t.offsetLeft+parseFloat($(t).css("width"))-i.offsetLeft):0},$i:function(n){var t=this.$9();return t>0&&n<t},_indexOf:function(n,t){for(var i=0;i<n.length;i++)if(ss.referenceEquals(n[i],t))return i;return-1},_indexOf:function(n,t){for(var i=0;i<n.length;i++)if(ss.referenceEquals(n[i],t))return i;return-1},$7:function(){var n=$(this._scrollNode).find(".dijitTab"),i=this._containerNode.domNode.offsetWidth,r=this.$9(),t={};return!!n.length&&r>i?(t.min=0,t.max=n[n.length-1].offsetLeft+parseFloat($(n[n.length-1]).css("width"))+2-i):(t.min=0,t.max=0),t},$1:function(n){if(!ss.isValue(this.currentTab)||!ss.referenceEquals(this.currentTab.value,n.value)){ss.isValue(this.currentTab)&&(this.currentTab.attr("checked",!1),b.$1(this.currentTab.domNode,!1));this.$k=this._indexOf(this.$l,n);var t={};t.sheetName=n.value;t.repositoryUrl=n.repository_url;t.oldRepositoryUrl=ss.isValue(this.currentTab)?this.currentTab.repository_url:null;tab.Application.fireOnTabSelect(t)}},$a:function(n){(ss.isValue(this.currentTab)?(this.currentTab.attr("checked",!1),b.$1(this.currentTab.domNode,!1)):n=this.currentTab=this.$l[this.selectedTabArrayIndex],ss.isNullOrUndefined(n))||(n.attr("checked",!0),b.$1(n.domNode,!0),this.currentTab=n,this.$g(n))},$g:function(n){var t,i,r;ss.isNullOrUndefined(n)?(r=new ss.Exception("No defined tab to use for scrolling"),r.name="TabbedNavigation Error for ScrollToTab",tab.ErrorTrace.report(r,!1)):(t=n.domNode,i=this._getScroll(),(i>t.offsetLeft||i+parseFloat($(this._containerNode.domNode).css("width"))<t.offsetLeft+parseFloat($(t).css("width")))&&this._createSmoothScroll(n).play())},$8:function(n){var t=n.domNode,u=parseFloat($(this._containerNode.domNode).css("width")),i=this.$7(),r;return r=t.offsetLeft+parseFloat($(t).css("width"))/2-u/2,Math.min(Math.max(r,i.min),i.max)},$0:function(){this.connect(this._rightBtn,"onClick",ss.mkdel(this,function(){this.$c(this._rightBtn)}));this.connect(this._leftBtn,"onClick",ss.mkdel(this,function(){this.$c(this._leftBtn)}));this.connect(this._menuBtn,"onClick",ss.mkdel(this,this.onMenuButtonClicked))},onMenuButtonClicked:function(){ss.isValue(this.$p)&&this.$p.dispose();this.$p=spiff.MenuViewModel.createForMenu(new spiff.Menu(this.$n),spiff.MenuViewModel.handleMenuActionItemClicked,null,null);this.$p.show(new spiff.ShowMenuOptions($(this._menuBtn.domNode),!1))},$c:function(n){n.dojoAttachPoint==="_leftBtn"?this.$2(-1):this.$2(1);n.domNode.focus()},$2:function(n){var t=parseFloat($(this._containerNode.domNode).css("width")),i=t*.5*n,r=this._getScroll()+i;this._createSmoothScroll(null,r).play()},_getScroll:function(){return this._containerNode.domNode.scrollLeft},_createSmoothScroll:function(n,t){var u,r,i;return ss.isValue(n)?t=this.$8(n):(u=this.$7(),t=Math.min(Math.max(t,u.min),u.max)),ss.isValue(this._anim)&&this._anim.status()==="playing"&&this._anim.stop(),r=null,i={},i.duration=100,i.beforeBegin=ss.mkdel(this,function(){var n=this._containerNode.domNode.scrollLeft;r.curve=new dojo._Line(n,t)}),i.onAnimate=ss.mkdel(this,function(n){this._containerNode.domNode.scrollLeft=n}),i.onEnd=ss.mkdel(this,function(){this.$j()}),r=new dojo._Animation(i),this._anim=r,r},$j:function(){var r=this._getScroll(),n=this.$7(),t,i;r>n.max&&(this._containerNode.domNode.scrollLeft=tab.DoubleUtil.roundToInt(n.max));i=r>=ss.trunc(n.max);t=r<=ss.trunc(n.min);this._rightBtn.setAttribute("disabled",i);this._leftBtn.setAttribute("disabled",t);$(this._rightBtn.domNode).find("button").toggleClass("tnRightButtonDisabled",i);$(this._leftBtn.domNode).find("button").toggleClass("tnLeftButtonDisabled",t);b.$0(this._rightBtn.domNode,tab.Strings.AccessibilityScrollSheetTabsRight,i);b.$0(this._leftBtn.domNode,tab.Strings.AccessibilityScrollSheetTabsLeft,t)},$f:function(){$(this._menuBtn.domNode).find("button")[0].tabIndex=-1;this._menuBtn.domNode.tabIndex=-1;this._menuBtn.domNode.setAttribute("aria-disabled","true")},startupShim:function(){this.startup()},resizeShim:function(){this.resize$1()},destroyShim:function(){this.destroy()}},{$2:function(n){var t=$(n.domNode);n.domNode.setAttribute("role","tab");n.domNode.setAttribute("aria-controls","tab-dashboard-region");t.find(".dijitTabButtonSpacer").attr("role","presentation");t.find(".tabLabel").removeAttr("wairole").removeAttr("role");t.find(".closeImage").removeAttr("wairole").removeAttr("role");b.$1(n.domNode,!1)},$0:function(n,t,i){n.setAttribute("role","button");n.setAttribute("aria-label",t);n.setAttribute("aria-disabled",i.toString());$(n).find("button")[0].tabIndex=-1},$1:function(n,t){n.setAttribute("aria-selected",t.toString());n.tabIndex=t?0:-1;$(n).find(".tabLabel").removeAttr("aria-pressed")}}),ru=global.tab.TiledWidget=ss.mkType(t,"tab.TiledWidget",function(n,t,i,r,u,f){this.$6=null;this.$8=null;this.$7=null;this.$b=null;this.$a=null;this.$9=100;this.$6=n;this.$8=t;this.$7=r;this.$b=i;this.$7.isValid(u)&&this.$8.get_tileCount()>0&&this.$5(0,u);this.$6.add_contentFetched(ss.mkdel(this,this.$2));f?this.$4():this.$b.add_scrolled(ss.mkdel(this,this.$3))},{get_lastScrollTop:function(){return this.$b.get_lastScrollTop()},get_itemHeight:function(){return this.$8.get_itemHeight()},get_tileCount:function(){return this.$8.get_tileCount()},destroy:function(){this.$b.remove_scrolled(ss.mkdel(this,this.$3));this.$b.destroy();this.$b=null;this.$6.remove_contentFetched(ss.mkdel(this,this.$2));this.$6.remove_contentFetched(this.$a);this.$6.destroy();this.$6=null;this.$8.destroy();this.$8=null;this.$7.destroy();this.$7=null},updateViewport:function(n,t){this.$8.updateViewport(n,t)},getElement:function(n){var t,i;return this.$8.get_tileCount()===0?null:(t=this.$8.itemToTileIndex(n),this.$8.getTileStatus(t)?(i=this.$8.globalToLocalItemIndex(n),this.$b.getItemElement(t,i)):null)},fetchWithinScrollRange:function(n,t,i){this.$1(n,t);this.$a=ss.mkdel(this,function(){this.$6.getQueueLength()===0&&(i(),this.$6.remove_contentFetched(this.$a))});this.$6.add_contentFetched(this.$a)},$5:function(n,t){if(this.$8.get_tileCount()!==0){var i=this.$7.format(t,this.$8.getTilePosition(n),this.$8.getTileRange(n));i.length!==0&&(this.$b.setContent(n,i),this.$8.updateTileStatus(n,!0))}},$0:function(n){var t=this.$8.getTileRangeType(n),i=this.$8.getTileRange(n);return new tr(n,i,t)},$4:function(){for(var i,t=[],r=this.$8.get_tileCount(),n=1;n<r;++n)i=this.$0(n),t.push(i);this.$6.fetch(t)},$1:function(n,t){var i,r;if(this.$8.get_tileCount()!==0){var e=t-1,o=new tab.IntegerRange(Math.floor(n),Math.ceil(e)),u=this.$8.pixelToTileRange(o),f=[],s=u.get_from(),h=u.get_to();for(i=s;i<=h;++i)this.$8.getTileStatus(i)||this.$6.isTilePending(i)||(r=this.$0(i),ss.isNullOrUndefined(r.get_range())||f.push(r));this.$6.fetch(f)}},$3:function(n,t){var u=this.$9*this.$8.get_itemHeight(),r=t.get_newPos().y-u,i;r<0&&(r=0);i=t.get_newPos().y+u+this.$8.get_viewportHeight();i>this.$8.get_totalHeight()&&(i=this.$8.get_totalHeight());this.$1(r,i)},$2:function(n,t){var i=t.get_tileIndex(),r=t.get_data();this.$5(i,r)}}),it=global.tab.TiledWidgetFactory=ss.mkType(t,"tab.TiledWidgetFactory",null,null,{createChecklist:function(n,t,i,r,u){var f=new at(n,r,n.get_modeContents().get_itemFormatter());return it.createListTiledWidget(n,t,i,f,u)},createRadiolist:function(n,t,i,r,u){var f=new kr(n,r,n.get_modeContents().get_itemFormatter());return it.createListTiledWidget(n,t,i,f,u)},createSimpleList:function(n,t,i,r,u){var f=new gt(n,r,n.get_modeContents().get_itemFormatter());return it.createListTiledWidget(n,t,i,f,u)},createListTiledWidget:function(n,t,i,r,u){var f=n.get_oFilter().isTiled&&tsConfig.filterTileSize>0?tsConfig.filterTileSize:n.get_oFilter().table.actual_size;i.style.position="relative";var e=n.get_oFilter().table.actual_size*u,o=!f?0:Math.ceil(n.get_oFilter().table.actual_size/f),s=new wt(i,e,o),h=tab.DomUtil.getMarginBox(i),c=new lr(n.get_oFilter().table.actual_size,u,f,h.h),l=new ir(n.get_session(),n.get_identifier(),n.get_domain()),a=t.slice(0,f);return new ru(l,c,s,r,a,!1)}}),uu=global.tab.Tree=ss.mkType(t,"tab.Tree",function(){this.model=null;this.anchor=null;this.prev_anchor=null;this.anchorIsStart=!1;this.$3$1=null;dijit.Tree.call(this)},{add_notifyChangeCalled:function(n){this.$3$1=ss.delegateCombine(this.$3$1,n)},remove_notifyChangeCalled:function(n){this.$3$1=ss.delegateRemove(this.$3$1,n)},_createTreeNode:function(n){n.isChecked=this.model.isChecked(n.item);var t=new tableau.base.widget.hsm._TreeNode(n);return n.item.node=t,t},$0:function(n){return this.model.mayHaveChildren(n)},getIconClass:function(){return"HFTreeNodeIcon"},getLabelClass:function(n){var t=this.model.isSingleSelect?"HFTreeNodeLabelSS":"HFTreeNodeLabel";return t+(n.isRaggedOrSkipped?" HFTreeNodeRaggedOrSkipped":"")},focusNode:function(n){var t=$(n.labelNode),i=t.attr("tabindex");!i||t.removeAttr("tabindex");this.inherited(arguments);!i||t.attr("tabindex",i)},notifyChange:function(n){ss.isValue(this.$3$1)&&this.$3$1(n)},getDepth:function(n){for(var t=0;!ss.referenceEquals(n,this.rootNode);)t+=1,n=n.getParent();return t},findEarlierNode:function(n,t,i){return this.rEarlierContained(this.rootNode,0,n,t,i)},rEarlierContained:function(n,t,i,r,u){var e,s,f,o;if(t>u)return null;if(t<u){for(e=n.getChildren(),s=e.length,f=0;f<s;f++)if(o=this.rEarlierContained(e[f],t+1,i,r,u),ss.isValue(o))return o}else return ss.referenceEquals(n,i)?i:ss.referenceEquals(n,r)?r:null;return null}}),fu=global.tab.TreeNode=ss.mkType(t,"tab.TreeNode",function(){this.isChecked=!1;this.$1=null;this.tree=null;this.item=null;dijit._TreeNode.call(this)},{dispose:function(){this.$1.dispose();this.$1=null},destroy:function(){this.dispose();this.inherited(arguments)},updateCheckState:function(){this.isChecked=this.tree.model.isChecked(this.item);var n=$(this.labelNode).find("input");n.prop("checked",this.isChecked)},setLabelNode:function(n){var i,t,r;this.isChecked=this.tree.model.isChecked(this.item);i=this.isChecked?" checked='checked'":"";t="<input type=";this.tree.model.isSingleSelect?(r=this.tree.model.identifier.get_fieldName(),ss.isValue(this.tree.model.session)&&(r+=this.tree.model.session.get_viewId()),t+="'radio' name='FI_"+r+"'"+i+"/><div class='fakeRadio'><\/div>"):t+="'checkbox'"+i+"/><div class='fakeCheckBox'><\/div>";t+="<a title='"+n+"'>"+n+"<\/a>";this.labelNode.innerHTML=t;ss.isValue(this.$1)&&this.$1.dispose();this.$1=new tab.DisposableHolder;this.$1.add$1(spiff.EventUtil.bindWithDispose($(this.labelNode.firstChild),"click",ss.mkdel(this,this.$0)))},$0:function(n){this.isChecked=this.labelNode.firstChild.checked;this.tree.notifyChange(n);n.stopPropagation()}}),eu=global.tab.TreeSupport=ss.mkType(t,"tab.TreeSupport",function(n,t,i,r){this.root=null;this.session=null;this.identifier=null;this.levels=0;this.isSingleSelect=!1;this.session=n;this.identifier=t;this.levels=i;this.isSingleSelect=r;this.root={};this.root.schema=null;this.root.tuple={d:null,s:!1,t:null};this.root.label="$ROOT$";this.root.level=-1;this.root.children=null},{$0:function(n){var t=n.t;if(tab.MiscUtil.isNullOrEmpty(t))return!1;var r=t[t.length-1],i=r.s;return ss.referenceEquals(i,"r")||ss.referenceEquals(i,"s")},itemsFromTable:function(n,t){var e=[],f=ss.isValue(n.table)?n.table.tuples:null,u,s,o,r;if(ss.isNullOrUndefined(n.table))return e;for(u=0;u<f.length;u++)s=i.formatTupleDisplayName(f[u]),o=null,!n.children||(o=this.itemsFromTable(n.children[u],t+1)),r={},r.id=i.formatTupleUniqueName(f[u],null),r.schema=n.table.schema,r.tuple=f[u],r.label=s,r.level=t,r.children=o,r.isRaggedOrSkipped=this.$0(f[u]),e.push(r);return e},$1:function(n){var t=n.node;t.updateCheckState();ss.isValue(n.node2)&&n.node2.updateCheckState()},onChildrenChange:function(n,t){n.children=t},getIdentity:function(n){return n.id},getLabel:function(n){return n.label},isChecked:function(n){return n.tuple.s},mayHaveChildren:function(n){return n.level+1<this.levels},getRoot:function(n){n(this.root)},getChildren:function(n,t,i){if(ss.isValue(n.children)||ss.referenceEquals(n,this.root))t(n.children);else{var u=ss.mkdel(this,function(i){n.children=!i[0].table?null:this.itemsFromTable(i[0],n.level+1);t(n.children)}),r={};r.schema=n.schema;r.tuples=[n.tuple];this.session.requestHSMChildren(this.identifier,r,u,i)}},refresh:function(n){this.$2(this.root,n)},$2:function(n,t){tab.MiscUtil.isNullOrEmpty$2(n.children)||(this.$3(n.children,t[0].table),_.each(n.children,ss.mkdel(this,function(n,i){if(!!n.children)if(ss.isValue(t[0].children)&&i<t[0].children.length)this.$2(n,[t[0].children[i]]);else{var u=ss.mkdel(this,function(t){this.$2(n,t)}),r={};r.schema=n.schema;r.tuples=[n.tuple];this.session.requestHSMChildren(this.identifier,r,u,null)}})))},$3:function(n,t){for(var r=t.tuples,i=0;i<r.length;i++)n[i].tuple.s!==r[i].s&&(n[i].tuple.s=r[i].s,this.$1(n[i]));return n}}),l=global.tab.TypeIn=ss.mkType(t,"tab.TypeIn",function(n,t,i){this.queryBox=null;this.div=null;this.outerDiv=null;this.querySpan=null;this.$r=null;this.$v=null;this.goButton=null;this.$2=null;this.$1=null;this.$w=!1;this.$t=null;this.$q=null;this.$o=!1;this.$n=null;this.$x=!1;this.$A=null;this.$u=!1;this.$y=0;this.$s=null;this.$p=null;this.$z=null;this.div=n;this.$s=t;this.$A=i;this.div.classList.add("tableauWidgetUiTypeIn");this.$r=new tab.DisposableHolder},{instantiate:function(n,t,i,r,u,f){var s,h,e,o;this.$2=n;this.$v=t;this.$1=i;this.$z=f;ss.isNullOrUndefined(this.$2)&&(this.$2="");s=tab.DomUtil.generateUniqueId();this.div.innerHTML="<div id='typein_"+tab.EscapingUtil.escapeHtml(t)+"' class='TypeInDiv tab-ctrl-formatted-border tab-ctrl-formatted-darker-border-hover'><span class='TypeInQuerySpan'><input aria-describedby='"+s+"' type='text' class='QueryBox' value='"+tab.EscapingUtil.escapeHtml(this.$2)+"'/><\/span><span class='goButton' style='display:none'><\/span><span class='sr-only' id='"+s+"'>"+tab.Strings.AccessibilityTypeInFieldPrompt+"<\/span><\/div>";this.outerDiv=this.div.firstChild;this.querySpan=this.outerDiv.childNodes[0];this.queryBox=this.querySpan.childNodes[0];this.goButton=this.outerDiv.childNodes[1];h=function(n){n.stopPropagation()};e=$(this.queryBox);this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"keydown",ss.mkdel(this,this.$c)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"keyup",ss.mkdel(this,this.$d)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"blur",ss.mkdel(this,this.onInputBlur)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"focus",ss.mkdel(this,this.onQueryBoxFocus)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"click",ss.mkdel(this,this.$e)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"mousemove",h));o=$(this.goButton);this.$r.add$1(spiff.EventUtil.bindWithDispose(o,"mousedown",ss.mkdel(this,this.$7)));this.$r.add$1(spiff.EventUtil.bindWithDispose(o,"click",ss.mkdel(this,this.$6)));this.$r.add$1(spiff.EventUtil.bindWithDispose(o,"mouseenter",ss.mkdel(this,this.$a)));this.$r.add$1(spiff.EventUtil.bindWithDispose(o,"mouseleave",ss.mkdel(this,this.$b)));EventUtils.GlobalUIEvents.add_FirstTouch(ss.mkdel(this,this.$9));this.$r.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){EventUtils.GlobalUIEvents.remove_FirstTouch(ss.mkdel(this,this.$9))})));EventUtils.GlobalUIEvents.add_DismissTemporaryElements(ss.mkdel(this,this.$8));this.$r.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){EventUtils.GlobalUIEvents.remove_DismissTemporaryElements(ss.mkdel(this,this.$8))})));this.$w=!1;this.$g()},$9:function(n){this.isInsideWidget(n)||this.$3()},$8:function(){this.$3()},$3:function(){this.$f()&&(this.setNewPattern(),this.queryBox.blur())},isInsideWidget:function(n){return tab.DomUtil.isEqualOrAncestorOf(this.outerDiv,n.target)},destroy:function(){this.dispose()},dispose:function(){this.div.classList.remove("tableauWidgetUiTypeIn");this.$r.dispose()},layout:function(){},editableValue:function(){return tableau.format.formatDataValue(tab.LegacyFilterModel.buildDataValueFromFilterValue(this.$1),null,tableau.format.deriveNumberEditingFormat(this.$z),null,2)},setNewState:function(n,t,i){if(this.$2=n,this.queryBox.value=n,ss.isValue(i))this.$1=i;else if(ss.isValue(this.$1)){var r=this.$1;this.$1={};this.$1.s="n";this.$1.t=r.t}this.$j();this.$t=t||[];this.$q=""},$l:function(){return tab.LegacyFilterModel.isNormalValue(this.$1)&&!this.$o},$0:function(n,t){this.$q="";this.$o=!0;this.$t=n||[];this.$p=t;tab.FeatureFlags.isEnabled("AccessibilityTypeInFilters")&&$(this.queryBox).attr("aria-autocomplete","inline")},$h:function(n){this.clearTimeout();this.$n=window.setTimeout(n,500)},clearTimeout:function(){this.$n=tab.MiscUtil.clearTimeout(this.$n)},$m:function(){var t,i,n;if(this.$o&&!tab.MiscUtil.isNullOrEmpty$1(this.queryBox.value)){if(this.$q.toLowerCase().indexOf(this.queryBox.value.toLowerCase())===0){this.onAutocompleteDone(this.$q);return}if(this.$t.length>0){for(t=this.queryBox.value.toLowerCase(),i=this.$t.length,n=0;n<i;n++)if(this.$t[n].toLowerCase().indexOf(t)===0){this.onAutocompleteDone(this.$t[n]);return}}else ss.isValue(this.$p)&&this.$h(ss.mkdel(this,function(){this.$p(this.queryBox.value,ss.mkdel(this,this.onAutocompleteDone),this.$v)}))}},onAutocompleteDone:function(n){var t=n,i;tab.MiscUtil.isNullOrEmpty$1(t)||(this.$q=t,i=this.queryBox.value,this.queryBox.value=t,l.selectText(this.queryBox,i.length,t.length))},onQueryBoxFocus:function(){this.queryBox.isFocused=!0;this.$l()&&(this.queryBox.value=this.editableValue(),this.$u=!0)},$e:function(){this.queryBox.isFocused&&this.queryBox.select();this.queryBox.isFocused=!1},$a:function(){$(this.goButton).addClass("Hover")},$b:function(){$(this.goButton).removeClass("Hover")},$f:function(){return this.$u&&this.$l()?!ss.referenceEquals(this.editableValue(),this.queryBox.value):!ss.referenceEquals(this.$2,this.queryBox.value)},$k:function(){var n=this.$A==="TypeIn"?this.$f():!ss.isNullOrEmptyString(this.queryBox.value);n?this.$i():this.$j()},$i:function(){$(this.goButton).css("display","");$(this.goButton).addClass(this.$A+"Active");$(this.querySpan).addClass("ShortQuerySpan")},$j:function(){$(this.querySpan).removeClass("ShortQuerySpan");$(this.goButton).removeClass(this.$A+"Active");$(this.goButton).css("display","none")},onInputBlur:function(){this.queryBox.isFocused=!1;this.$w||this.$x||this.setNewPattern();this.$x=!1},$7:function(){this.$w=!0},$6:function(){this.$4();this.$w=!1},$5:function(n){this.$g();BrowserSupport.BrowserSupport.IsFF()&&window.setTimeout(ss.mkdel(this,this.$g),10);this.$k();spiff.EventUtil.stopEvent$2(n)},$c:function(n){switch(n.which){case 27:this.$5(n)}this.$y=n.which},enterKeyHandler:function(n){this.clearTimeout();this.setNewPattern();this.queryBox.blur();spiff.EventUtil.stopEvent$2(n)},$d:function(n){switch(n.which){case 13:this.$y===13&&this.enterKeyHandler(n);break;case 27:this.clearTimeout();this.$5(n);this.$x=!0;tab.FeatureFlags.isEnabled("AccessibilityTypeInFilters")||this.queryBox.blur();break;case 8:case 46:this.clearTimeout();this.$k();break;case 16:this.$k();break;default:this.$y===n.which&&(this.$m(),this.$k())}},setPattern:function(n){this.queryBox.value=n;this.clearTimeout();this.setNewPattern();this.queryBox.blur()},setNewPattern:function(){this.$f()?(this.$s(this.queryBox.value),this.$l()||this.setNewState(this.queryBox.value)):this.$l()&&this.$g();this.$u=!1},$g:function(){this.queryBox.value=this.$2;this.$u=!1;this.$k()},$4:function(){this.$A==="TypeIn"?(this.$g(),this.queryBox.blur()):(this.queryBox.value="",this.setNewPattern());this.$k()}},{selectText:function(n,t,i){if(!ss.isNullOrUndefined(n)){if(typeof n.createTextRange=="function"){var r=n.createTextRange();r.collapse(!0);r.moveStart("character",t);r.moveEnd("character",i-t);r.select()}else typeof n.setSelectionRange=="function"?n.setSelectionRange(t,i):typeof n.selectionStart=="function"&&(n.selectionStart=t,n.selectionEnd=i);n.focus()}}}),ou=global.tab.TypeInCatmode=ss.mkType(t,"tab.TypeInCatmode",function(n,t,i){this.isContainer=!0;this.$6=null;s.call(this,n,t,i)},{instantiate:function(n,t){this.$6=new tableau.base.widget.TypeInFilterContents(ss.mkdict(["parentFilter",this.parent,"tuples",n,"itemName",t,"role",this.parent.get_oFilter().role]));this.div.appendChild(this.$6.domNode);this.$6.startup();this.$5()},$5:function(){var n=ss.mkdel(this,function(n){var t=this.parent.get_searchWidget().domResults;tab.DomUtil.isEqualOrAncestorOf(t,n.target)||(ss.referenceEquals(n.target,this.parent.get_searchWidget().get_domXButton())?this.parent.get_searchWidget().clearSearch(!1,!1):this.parent.get_searchWidget().clearSearch(!0,!0))});this.disposables.add$1(spiff.EventUtil.bindWithDispose($(document.body),"mousedown",n))},destroy:function(){this.dispose();ss.isValue(this.$6)&&this.$6.destroyRecursive(!1);this.$6=null},layout:function(n,t){this.inherited(arguments);var i={w:n.w-6,h:n.h};this.$6.layout$1(i,t)},fetchChildNodeByIndex:function(n){var t=this.$6.domItemsList.childNodes;return n<0||n>=t.length?null:t[n]},applyChanges:function(){var n=this.$3(),t=this.$6.getUIState(),i=this.$4(t,n),r=this.$4(n,t);(i.length>0||r.length>0)&&(this.parent.set_stateId(this.parent.get_stateId()+1),tab.FilterClientCommands.modifyCategoricalFilterValues(this.parent.get_session().get_visualId(),this.parent.get_identifier(),i,r,!0))},resetContent:function(n,t){ss.isValue(this.$6)&&this.$6.destroyRecursive(!1);this.$6=null;this.instantiate(n,t)},$3:function(){for(var t,i=this.parent.get_oFilter().table.tuples,r={},u=i.length,n=0;n<u;n++)t=i[n],r[this.$6.getFormattedAlias(t)]=t.s;return r},$4:function(n,t){var u=[],r=ss.getEnumerator(Object.keys(n)),i;try{while(r.moveNext())i=r.current(),n.hasOwnProperty(i)&&n[i]&&!t[i]&&u.push(i)}finally{r.dispose()}return u}}),k=global.tab.TypeInDateField=ss.mkType(t,"tab.TypeInDateField",function(n,t,i,r){this.$G=null;this.$F=null;this.$I=null;this.$H=null;this.$L=null;this.$K=null;this.$J=null;this.$2$1=null;l.call(this,n,t,i);this.$G=r;ss.isNullOrUndefined(this.$G)&&(this.$G=function(n){return new tab.DatePicker(n)})},{get_calendarElement:function(){return ss.isValue(this.$F)?this.$F.element:null},get_customCalendarDateSelectionAction:function(){return this.$2$1},set_customCalendarDateSelectionAction:function(n){this.$2$1=n},dispose:function(){l.prototype.dispose.call(this);this.$F=tab.MiscUtil.dispose$1(this.$F)},instantiate:function(n,t,i,r,u,f,e,o,s){l.prototype.instantiate.call(this,n,t,i,this.$L,this.$K,f,e,o,s);this.$I=e;this.$H=o;this.$L=r;this.$K=u;this.$J=s;k.lazilyCreateCalendar||this.$B()},editableValue:function(){var n=tab.LegacyFilterModel.buildDataValueFromFilterValue(this.$1);return tableau.format.formatDataValue(n,"m",this.$H,null,2)},$C:function(){return ss.isValue(this.$1)&&ss.isValue(this.$1.t)?this.$1.t:"t"},setNewState:function(n,t,i,r,u){l.prototype.setNewState.call(this,n,t,i,r,u);ss.isValue(this.$F)&&this.$F.setDateRange(k.$0(r),k.$0(u))},isInsideWidget:function(n){return l.prototype.isInsideWidget.call(this,n)||this.$E(n)},$E:function(n){if(ss.isNullOrUndefined(this.$F))return!1;var t=this.$F.element.get(0);return tab.DomUtil.isEqualOrAncestorOf(t,n.target)},onQueryBoxFocus:function(n){if(l.prototype.onQueryBoxFocus.call(this,n),ss.isNullOrUndefined(this.$F)||this.$F.element.is(":hidden")){this.$B();var t=k.$0(this.$1);this.$F.show(t);this.$F.positionCalendarByElement($(this.queryBox).closest(".TypeInDiv"))}},$B:function(){var i,r,f;if(!ss.isValue(this.$F)){var n=this.$I.locale_formatting_strings,e=n.narrowDay.filter(function(n){return!ss.isNullOrEmptyString(n)}),u=k.$0(this.$1),t=this.$J;ss.isValue(t)&&(t=ss.Nullable$1.sub(t,1));i={};i.format=tableau.format.mapIcuToOleFormat(this.$I.yearMonthFormat);i.locale_formatting_strings=n;r={};r.format=this.$H.format;r.locale_formatting_strings=n;f=new tab.DatePickerSettings(u,u,k.$0(this.$L),k.$0(this.$K),t,e,n.todayFormatTemplate,function(n){return tableau.format.formatCustomJsDateTime(n,i,0,"d")},function(n){return tableau.format.formatCustomJsDateTime(n,r,0,"d")});this.$F=this.$G(f);this.$F.element.on("dateSelected",ss.mkdel(this,this.$D)).appendTo(document.body)}},$D:function(n,t){ss.isValue(this.$F)&&this.$F.hide();ss.staticEquals(this.get_customCalendarDateSelectionAction(),null)||(t=this.get_customCalendarDateSelectionAction()(t));this.setPattern(tableau.format.formatJsDateTime(t,this.$H,2,this.$C()))},onInputBlur:function(n){ss.isValue(this.$F)&&this.$F.hide();l.prototype.onInputBlur.call(this,n)}},{$0:function(n){return tab.LegacyFilterModel.isNormalValue(n)?new Date(tableau.types.JsDateFromOleDate(ss.unbox(n.v))):null}}),su=global.tab.TypeInFilterContents=ss.mkType(t,"tab.TypeInFilterContents",function(){this.templateString="<div class='TypeInFilter'><div class='TIFItemsList tab-ctrl-formatted-text' dojoAttachPoint='domItemsList'dojoAttachEvent='onclick:_onItemsListClick,onmouseover:_onItemsListMouseOver,onmouseout:_onItemsListMouseOut,onkeydown:_onItemsKeyDown'><div class='wcIconSearchRemove' dojoAttachPoint='domXButton'dojoAttachEvent='onclick:_onXButtonClick,onmouseover:_onXButtonMouseOver,onmouseout:_onXButtonMouseOut'><\/div><\/div><div class='TIFButtonDiv' dojoAttachPoint='domClearListButtonDiv'><button class='TIFButton'dojoAttachEvent='onclick:_onClearListButtonClick' dojoAttachPoint='buttonClearList'>Clear List<\/button><\/div><\/div>";this.isContainer=!1;this.parentFilter=null;this.tuples=null;this.itemName="";this.role=null;this.domItemsList=null;this.domXButton=null;this.domClearListButtonDiv=null;this.$0=null;this.buttonClearList=null;Object.call(this)},{postCreate:function(){for(var r,e,o,s=i.formatTupleDisplayName,h=ss.mkdel(n.filterItem,n.filterItem.getTypeInHtml),u=[],f=0,t=0;t<this.tuples.length;t++)r=this.tuples[t],r.s&&(e=this.itemName+"_"+t,o=h(e,s(r,!0,this.role)),u.push(o),f++);this.domItemsList.innerHTML=u.join("");this.buttonClearList.innerHTML=tab.Strings.getString("ClearAllButtonText");this.domClearListButtonDiv.style.display=f>3?"block":"none"},_onItemsListClick:function(n){this.parentFilter.onListItemClick(n)},_onItemsListMouseOver:function(t){if(ss.isValue(t.target)&&$(t.target).hasClass("FITypeInItem")){$(t.target).addClass("Hover");var i=this.$0=n.filterItem.getNodeFromEvent(t);i.appendChild(this.domXButton);$(this.domXButton).css("top","calc(50% - 7px)");$(this.domXButton).css("display","block")}},_onItemsListMouseOut:function(n){ss.isValue(n.relatedTarget)&&ss.referenceEquals(n.relatedTarget,this.domXButton)||(ss.isValue(this.$0)&&$(this.$0).removeClass("Hover"),this.$0=null,$(this.domXButton).css("display","none"))},_onItemsKeyDown:function(n){n.keyCode===46&&(this._removeSelectedItemsFromFilter(),spiff.EventUtil.stopEvent(n))},_onXButtonClick:function(t){var i=null,r,u;(spiff.EventUtil.stopEvent$2(t),r=n.filterItem.getNodeFromEvent(t),ss.isValue(r))&&(n.filterItem.setChecked(r,!1),ss.isValue(this.parentFilter.get_oFilter())&&(i=this.parentFilter.get_oFilter().table),tab.ApplicationModel.get_instance().get_isLocalRenderMode()&&ss.isValue(i)&&i.actual_size===i.tuples.length&&(u=new tab.LegacyCategoricalQuickFilterData(this.parentFilter.get_oFilter().targetSheets,this.parentFilter.get_identifier(),this.parentFilter.get_oFilter().exclude,this.getCheckedAliases(this.getUIState())),tab.FilterClientCommands.updateCategoricalFilter(u)),this.parentFilter.clearRangeAnchorAndSelection(),this.parentFilter.notifyChange(ss.mkdel(this.parentFilter,this.parentFilter.applyChanges)))},_onXButtonMouseOver:function(){$(this.domXButton).addClass("Hover")},_onXButtonMouseOut:function(){$(this.domXButton).removeClass("Hover")},_onClearListButtonClick:function(){var t,i=null,r;for(this.parentFilter.get_searchWidget().clearSearch(!0,!1),t=this.domItemsList.firstChild;ss.isValue(t);t=t.nextSibling)n.filterItem.setChecked(t,!1);this.parentFilter.set_stateId(this.parentFilter.get_stateId()+1);ss.isValue(this.parentFilter.get_oFilter())&&(i=this.parentFilter.get_oFilter().table);tab.ApplicationModel.get_instance().get_isLocalRenderMode()&&ss.isValue(i)&&i.actual_size===i.tuples.length&&(r=new tab.LegacyCategoricalQuickFilterData(this.parentFilter.get_oFilter().targetSheets,this.parentFilter.get_identifier(),this.parentFilter.get_oFilter().exclude,this.getCheckedAliases(this.getUIState())),tab.FilterClientCommands.updateCategoricalFilter(r));this.parentFilter.clearRangeAnchorAndSelection();this.parentFilter.applyChanges();$(this.domClearListButtonDiv).css("display","none")},layout$1:function(n){if(tableau.util.isElementVisible(this.domClearListButtonDiv)){var t=dojo.marginBox(this.domClearListButtonDiv);n.h=Math.max(0,n.h-t.h)}dojo.marginBox(this.domItemsList,n)},_removeSelectedItemsFromFilter:function(){this.parentFilter.forEachSelected(function(t,i){n.filterItem.setChecked(i,!1)});this.parentFilter.clearRangeAnchorAndSelection();this.parentFilter.notifyChange(ss.mkdel(this.parentFilter,this.parentFilter.applyChanges))},getUIState:function(){for(var u=this.domItemsList.firstChild,i={},r,t=u;ss.isValue(t);t=t.nextSibling)r=this.getFormattedAlias(this.tuples[n.filterItem.getIndex(t)]),i[r]=n.filterItem.isChecked(t);return i},getCheckedAliases:function(n){var r=[],i=ss.getEnumerator(Object.keys(n)),t;try{while(i.moveNext())t=i.current(),n.hasOwnProperty(t)&&n[t]&&r.push(t)}finally{i.dispose()}return r},getFormattedAlias:function(n){return i.formatTupleDisplayName(n,!0,this.role)}}),hu=global.tab.UICheckedMenuItem=ss.mkType(t,"tab.UICheckedMenuItem",function(){g.call(this)}),ni=global.tab.UIMenuItem=ss.mkType(t,"tab.UIMenuItem",function(){g.call(this)}),nt=global.tab.WidgetStyle=ss.mkType(t,"tab.WidgetStyle",null,null,{applyFormatting:function(n,t,i,r,u){nt.$0(n.id,t,i,r,nt.$2,u)},applyFormattingByClassName:function(n,t,i){nt.$0(n,t.get_textStyleModel(),t.get_backgroundColor(),t.get_lineHeight(),nt.$1,i)},$0:function(n,t,i,r,u,f){var s=n+"-style",e,h,o,c,l;tab.StyleUtil.clearStyleSheet(s);e=tab.FormattingConverters.makeFormatStyleDict(t,null);ss.isValue(r)&&(e["line-height"]=r+"px");ss.isNullOrUndefined(e["font-style"])&&(e["font-style"]="normal");ss.isNullOrUndefined(e["font-weight"])&&(e["font-weight"]="normal");ss.isNullOrUndefined(e["text-decoration"])&&(e["text-decoration"]="none");tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-text"),e);e["font-size"]=null;e["line-height"]=null;tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-fixedsize"),e);ss.isValue(t.color)&&(h={color:t.color},tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-coloronly"),h));o={};ss.isValue(t.color)&&(o["border-color"]=tab.ColorModel.fromColorModelPlusAlpha(tab.ColorModel.fromColorCode(t.color),200/255).toString(),tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-darker-border-hover:hover"),o),tab.FeatureFlags.isEnabled("BEAuthoring_ContextMenus_CategoricalFilter")&&tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-darker-border-focus:focus"),o),o["border-color"]=tab.ColorModel.fromColorModelPlusAlpha(tab.ColorModel.fromColorCode(t.color),105/255).toString(),tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-border"),o),tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-border-hover:hover"),o));f&&ss.isValue(i)&&(c=tab.ColorModel.fromColorModelPlusAlpha(tab.ColorModel.fromColorCode(i),140/255),l=tab.ColorModel.alphaCompositeSolidDest(c,new tab.ColorModel(255,255,255,1)),o["background-color"]=l.toRgb(),tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-widget"),o),o["border-color"]=null,tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-widget:hover"),o))},$2:function(n,t){return'[id="'+n+'"].'+t+',[id="'+n+'"] .'+t},$1:function(n,t){return"."+n+"."+t+",."+n+" ."+t}});ss.initClass(ti,spiff.Template,[ss.IDisposable]);ss.initClass(bi);ss.initClass(s,Object,[ss.IDisposable]);ss.initClass(o,s,[ss.IDisposable]);ss.initClass(cu,null,[tab.ILegacyDojoUIModule]);ss.initClass(ii);ss.initClass(st);ss.initClass(ki,o,[ss.IDisposable]);ss.initClass(a,s,[ss.IDisposable]);ss.initInterface(bt,{destroy:null,format:null,isValid:null});ss.initClass(gt,null,[bt]);ss.initClass(at,gt,[bt]);ss.initClass(di);ss.initClass(gi);ss.initClass(nr,ss.EventArgs);ss.initClass(ri,ss.makeGenericType(spiff.BaseView$1,[tt]),[tab.IWidget,ss.makeGenericType(tab.IView$1,[tt]),ss.IDisposable,tab.IAppendableView,tab.IContinuousSlider]);ss.initClass(tt,spiff.BaseViewModel,[tab.IContinuousSliderViewModel,tab.IViewModel,ss.IDisposable,spiff.IHasEnabledState]);ss.initClass(ui,Object,[tab.ICurrentPagePanelWidgetShim,tab.ILegacyWidgetShim]);ss.initClass(h,Object);ss.initClass(vt,h);ss.initClass(d);ss.initClass(ht);ss.initClass(tr);ss.initInterface(fr,{add_contentFetched:null,remove_contentFetched:null,destroy:null,fetch:null,isTilePending:null,getQueueLength:null});ss.initClass(ir,null,[fr]);ss.initClass(i);ss.initClass(f,Object);ss.initClass(yt,f);ss.initClass(ct);ss.initClass(rr,ct);ss.initClass(pt,ct);ss.initClass(n);ss.initInterface(sr,{add_scrolled:null,remove_scrolled:null,get_lastScrollTop:null,destroy:null,setContent:null,getTileElement:null,getItemElement:null});ss.initClass(wt,null,[sr]);ss.initClass(ur);ss.initInterface(fi,{get_filterTable:null,get_quickFilter:null,shouldDeferChanges:null,updateStateIfNeeded:null,clearRangeAnchorAndSelection:null,forEachSelected:null,onListItemClick:null,fetchChildNodeByIndex:null,handleItemClick:null,handleClickIfPending:null});ss.initClass(er,Object);ss.initClass(g,dijit.MenuItem);ss.initClass(ni,g);ss.initClass(lu,ni);ss.initInterface(or,{get_totalHeight:null,get_viewportHeight:null,get_itemHeight:null,get_tileCount:null,destroy:null,updateViewport:null,getTileStatus:null,updateTileStatus:null,getTilePosition:null,getTileRange:null,getTileRangeType:null,pixelToTileRange:null,itemToTileIndex:null,globalToLocalItemIndex:null});ss.initClass(r,h,[fi]);ss.initClass(hr,spiff.BaseViewModel,[tab.IViewModel,tab.IFilterTypeViewModel,ss.IDisposable]);ss.initClass(kt);ss.initClass(e,h);ss.initClass(cr,spiff.BaseViewModel,[tab.IViewModel,tab.IFilterTypeViewModel,ss.IDisposable]);ss.initClass(v,h);ss.initClass(ei,v);ss.initClass(oi,spiff.BaseViewModel,[tab.IViewModel,tab.IFilterTypeViewModel,ss.IDisposable]);ss.initClass(au,ss.makeGenericType(spiff.BaseView$1,[rt]),[tab.IWidget,ss.makeGenericType(tab.ILegacyQuickFilterDisplayView$1,[rt]),ss.makeGenericType(tab.IView$1,[rt]),ss.IDisposable,tab.IAppendableView]);ss.initClass(rt,spiff.BaseViewModel,[tab.ILegacyQuickFilterDisplayViewModel,tab.IViewModel,ss.IDisposable,tab.ICanRequireHandlingOfContextMenuEvents]);ss.initClass(u,vt,[ss.IDisposable]);ss.initClass(lr,null,[or]);ss.initClass(si);ss.initClass(hi,spiff.Template,[ss.IDisposable]);ss.initClass(ci,ss.makeGenericType(spiff.BaseView$1,[ut]),[tab.IWidget,ss.makeGenericType(tab.IPageView$1,[ut]),ss.makeGenericType(tab.IView$1,[ut]),ss.IDisposable,tab.IAppendableView]);ss.initClass(ut,spiff.BaseViewModel,[tab.IPageViewModel,tab.IViewModel,ss.IDisposable]);ss.initClass(li,Object,[tab.IParameterControlWidgetShim,tab.ILegacyWidgetShim]);ss.initClass(ai,spiff.Template,[ss.IDisposable]);ss.initClass(vi,ss.makeGenericType(spiff.BaseView$1,[ft]),[tab.IWidget,ss.makeGenericType(tab.IParameterControlView$1,[ft]),ss.makeGenericType(tab.IView$1,[ft]),ss.IDisposable,tab.IAppendableView]);ss.initClass(ft,spiff.BaseViewModel,[tab.IParameterControlViewModel,tab.IViewModel,ss.IDisposable,tab.ICanRequireHandlingOfContextMenuEvents]);ss.initClass(y,Object,[ss.IDisposable]);ss.initClass(ar,y,[ss.IDisposable]);ss.initClass(vr,y,[ss.IDisposable]);ss.initClass(dt,y,[ss.IDisposable]);ss.initClass(et,y,[ss.IDisposable]);ss.initClass(yr,et,[ss.IDisposable]);ss.initClass(pr,s,[ss.IDisposable]);ss.initClass(wr);ss.initClass(p);ss.initClass(yi,spiff.Template,[ss.IDisposable]);ss.initClass(pi,Object,[tab.IFilterPanelWidgetShim,tab.ILegacyWidgetShim,ss.IDisposable]);ss.initClass(br,s,[ss.IDisposable]);ss.initClass(kr,at,[bt]);ss.initClass(lt);ss.initClass(dr,spiff.BaseViewModel,[tab.IViewModel,tab.IFilterTypeViewModel,ss.IDisposable]);ss.initClass(w,h,[ss.IDisposable]);ss.initClass(gr,ss.EventArgs);ss.initClass(wi,f,[fi]);ss.initClass(nu,o,[ss.IDisposable]);ss.initClass(ot,null,[tab.ISlider,ss.IDisposable]);ss.initClass(tu,s,[ss.IDisposable]);ss.initClass(c);ss.initClass(iu,f);ss.initClass(b,Object,[tab.ITabbedNavigation]);ss.initClass(ru);ss.initClass(it);ss.initClass(uu,dijit.Tree);ss.initClass(fu,dijit._TreeNode,[ss.IDisposable]);ss.initClass(eu);ss.initClass(l,null,[ss.IDisposable]);ss.initClass(ou,s,[ss.IDisposable]);ss.initClass(k,l,[ss.IDisposable]);ss.initClass(su,Object);ss.initClass(hu,g);ss.initClass(nt),function(){ti.$0="<div class='tabHorizontalSlider'>\n<\/div>'"}(),function(){wt.$1=100}(),function(){r.$6="keydown."+ss.getTypeName(r)}(),function(){n.unknownItemIndex=-2;n.allItemIndex=-1;n.$2=tab.Strings.QuickFilterAll;n.filterItem=null;n.filterItem=tsConfig.is_mobile?new pt:new rr}(),function(){a.getFilterItemHtml=ss.mkdel(n.filterItem,n.filterItem.formatChecklistFilterItemHtml)}(),function(){o.$3=3;o.$2=30;o.$1="keydown."+ss.getTypeName(o)}(),function(){tt.$1=1e3;tt.$0=200}(),function(){tab.ObjectRegistry.registerType(ri,ri).call(null)}(),function(){ui.$0=-1}(),function(){u.$2=null;u.$3=null}(),function(){ot.tableauSliderTemplate="<div class='dijit dijitReset'><div class='dijitReset tableauSlider' dojoAttachPoint='tableauSlider'><table class='dijit dijitReset' cellspacing='0' cellpadding='0' border='0' rules='none' wairole='presentation'><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,topDecoration' class='dijitReset' style='text-align:center;width:100%;'><\/td><td class='dijitReset'><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper' dojoAttachEvent='onclick:_onClkDecBumper'><\/div><\/td><td class='dijitReset'><input dojoAttachPoint='valueNode' type='hidden' name='${name}'><div class='dijitReset dijitSliderBarContainerH' waiRole='presentation' dojoAttachPoint='sliderBarContainer'><div waiRole='presentation' dojoAttachPoint='progressBar' class='dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH' dojoAttachEvent='onclick:_onBarClick'><div class='dijitSliderMoveable dijitSliderMoveableH'><div dojoAttachPoint='sliderHandle,focusNode' class='dijitSliderImageHandle dijitSliderImageHandleH' dojoAttachEvent='onmousedown:_onHandleClick' waiRole='slider' valuemin='${minimum}' valuemax='${maximum}'><\/div><\/div><\/div><div waiRole='presentation' dojoAttachPoint='remainingBar' class='dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH' dojoAttachEvent='onclick:_onBarClick'><\/div><\/div><\/td><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper' dojoAttachEvent='onclick:_onClkIncBumper'><\/div><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,bottomDecoration' class='dijitReset'><\/td><td class='dijitReset'><\/td><\/tr><\/table><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowDec' style='display:none' dojoAttachPoint='decrementButton'><div class='dijitSliderDecrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>-<\/span><\/div><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowInc' style='display:none' dojoAttachPoint='incrementButton'><div class='dijitSliderIncrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>+<\/span><\/div><\/div><\/div>";ot.$2="<div class='dijitTooltip dijitTooltipLeft' id='dojoTooltip'><div class='dijitTooltipContainer' dojoAttachpoint='coreArea'><div class='dijitTooltipContents' dojoAttachPoint='containerNode' waiRole='alert'><\/div><\/div><div class='dijitTooltipConnector'><\/div><\/div>";ot.$0=1;ot.$1=20}(),function(){k.lazilyCreateCalendar=!0}(),function(){g.$0=75}(),function(){e.$9=new tab.ColorModel(255,255,255,1);e.$7=60/255;e.$8=105/255;e.$4=100/255;e.$2=140/255;e.$6=95;e.$5=new tab.ColorModel(234,234,234,1);e.$3=new tab.ColorModel(241,241,241,1)}(),function(){w.pickerDurationsInteger=[1,7,30,90,365,1825];w.pickerDurations=["0d","-7d","-30d","-90d","-365d","-1825d"];w.pickerStrings=[tab.Strings.RelDatePickerOneDayAbbrev,tab.Strings.RelDatePickerOneWeekAbbrev,tab.Strings.RelDatePickerOneMonthAbbrev,tab.Strings.RelDatePickerThreeMonthsAbbrev,tab.Strings.RelDatePickerOneYearAbbrev,tab.Strings.RelDatePickerFiveYearsAbbrev];w.$2="RDFButtonR1";w.$1="RDFButtonHide"}(),function(){et.$0=!1}(),function(){dt.$1=ss.mkdict(["year",365.25,"quarter",365.25/4,"month",365.25/12,"week",7,"day",1,"hour",1/24,"minute",1/1440,"second",1/86400])}(),function(){f.noSearchPerformed=-1}(),function(){yt.$0=500;yt.minimumDomainSize=5}(),function(){ht.$2="<div class='CategoricalFilter' role='application'><div class='CategoricalFilterBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='CFButton CFResetButton' showlabel='false'dojoAttachPoint='resetButton'iconClass='wcIconNonfiltered'>Showing all values<\/div><div dojoType='dijit.form.Button' class='CFButton CFSearchButton' showlabel='false'dojoAttachPoint='searchButton'iconClass='wcIconSearch'>Search<\/div><div dojoType='dijit.form.Button' class='CFButton CFDomainButton' showlabel='false'dojoAttachPoint='domainButton'iconClass='wcIconDomainAll'>Show Fewer Values<\/div><div dojoType='dijit.form.Button' iconClass='wcIconContextMenu'class='CFButton CFMenuButton' dojoAttachPoint='menuButton' name='type'><\/div><\/div><div dojoAttachPoint='searchDiv'><\/div><div class='CFContent' dojoAttachPoint='domContent'><\/div><div class='CFHorizScroll' dojoAttachPoint='domHorizScroll' dojoAttachEvent='onscroll:doscrollHoriz'><div dojoAttachPoint='domHorizScrollContent'><\/div><\/div><\/div>";ht.$3="<div class='ParameterControl' role='form'><div class='ParameterControlBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='ParamTitle' dojoAttachPoint='domTitleBar'><\/h3><div class='PCMenuButton' dojoAttachPoint='paramMenuButton'><\/div><\/div><div class='PCContent' dojoAttachPoint='domContent'><\/div><\/div><\/div>";ht.$4="<div class='Search' role='form'><div class='SearchBox' dojoAttachPoint='domQuerySection'><textarea rows='1' class='QueryBox' spellcheck='false'dojoAttachPoint='domQueryBox'dojoAttachEvent='onkeydown:onQueryBoxKeyDown,onpaste:onQueryBoxPaste'><\/textarea><span class='wcSearchX' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><img class='searchBusyImg' title='${CANCEL_SEARCH_TOOLTIP}' src='${busy_gif_url}'dojoAttachPoint='domSearchBusyImg'dojoAttachEvent='onclick:onSearchBusyImgClick'><\/img><span class='wcIconSearch' title='${SEARCH_TOOLTIP}'dojoAttachPoint='domSearchButton'dojoAttachEvent='onclick:onSearchButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><span class='wcIconSearchAdd' title='${ADD_ITEM_CTRL_ENTER}'dojoAttachPoint='domSearchAddButton'dojoAttachEvent='onclick:onSearchAddButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><\/div><div class='SearchResults' dojoAttachPoint='domResults' dojoAttachEvent='onclick:onListItemClick'><\/div><\/div>";dojo.addOnLoad(ht.$0)}(),function(){yi.$0="<div class='tab-quick-filter'><\/div>"}(),function(){hi.$0="<div class='tab-page'><\/div>"}(),function(){tab.ObjectRegistry.registerType(ci,ci).call(null)}(),function(){ai.$0="<div class='tab-parameter'><\/div>"}(),function(){tab.ObjectRegistry.registerType(vi,vi).call(null)}(),function(){c.showStepButtonsAttr="show-step-btns";c.hideStepButtonsAttr="hide-buttons";c.showTicksAttr="show-ticks";c.hideTicksAttr="hide-ticks";c.showReadoutAttr="show-readout";c.hideReadoutAttr="hide-readout";c.showSliderAttr="show-slider";c.hideSliderAttr="hide-slider";c.hideArrowClass="HideArrows";c.hideSliderClass="HideSlider";c.showArrowClass="ShowArrows"}()})();
/*! BEGIN LegacyDojoUIWeb */
(function(){"dont use strict";var n={};global.tab=global.tab||{};ss.initAssembly(n,"vqllegacydojouiweb");var t=global.tab.ContinuousSliderWeb=ss.mkType(n,"tab.ContinuousSliderWeb",function(n){var i;if(this.$b=null,this.$d=null,this.$e=null,this.$c=!1,tab.ContinuousSlider.call(this,n),this.viewModel.add_enabledChanged(ss.mkdel(this,this.applyEnabledState)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.viewModel.remove_enabledChanged(ss.mkdel(this,this.applyEnabledState))}))),i={templateString:"<div class='dijit dijitReset'><div class='dijitReset tableauSlider' dojoAttachPoint='tableauSlider'><table class='dijit dijitReset' cellspacing='0' cellpadding='0' border='0' rules='none'><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,topDecoration' class='dijitReset' style='text-align:center;width:100%;'><\/td><td class='dijitReset'><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper' dojoAttachEvent='onclick:_onClkDecBumper'><\/div><\/td><td class='dijitReset'><input dojoAttachPoint='valueNode' type='hidden' name='${name}'><div class='dijitReset dijitSliderBarContainerH' waiRole='presentation' dojoAttachPoint='sliderBarContainer'><div waiRole='presentation' dojoAttachPoint='progressBar' class='dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH' dojoAttachEvent='onclick:_onBarClick'><div class='dijitSliderMoveable dijitSliderMoveableH'><div dojoAttachPoint='sliderHandle,focusNode' class='dijitSliderImageHandle dijitSliderImageHandleH' dojoAttachEvent='onmousedown:_onHandleClick' waiRole='slider' valuemin='${minimum}' valuemax='${maximum}'><\/div><\/div><\/div><div waiRole='presentation' dojoAttachPoint='remainingBar' class='dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH' dojoAttachEvent='onclick:_onBarClick'><\/div><\/div><\/td><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper' dojoAttachEvent='onclick:_onClkIncBumper'><\/div><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,bottomDecoration' class='dijitReset'><\/td><td class='dijitReset'><\/td><\/tr><\/table><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowDec' style='display:none' dojoAttachPoint='decrementButton'><div class='dijitSliderDecrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>-<\/span><\/div><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowInc' style='display:none' dojoAttachPoint='incrementButton'><div class='dijitSliderIncrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>+<\/span><\/div><\/div><\/div>",onChange:ss.mkdel(this,this.$7),value:n.get_sliderCurrentValue(),minimum:n.get_sliderMinimumValue(),maximum:n.get_sliderMaximumValue(),slideDuration:0,intermediateChanges:!0,style:"width:"+n.get_pixelWidth()+"px;",showButtons:!1},this.$b=new dijit.form.HorizontalSlider(i,this.get_template().domRoot.get(0)),this.$d=dojo.subscribe("/dnd/move/start",ss.mkdel(this,this.$8)),this.$e=dojo.subscribe("/dnd/move/stop",ss.mkdel(this,this.$9)),this.viewModel.add_sliderValueChange(ss.mkdel(this,this.$a)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.viewModel.remove_sliderValueChange(ss.mkdel(this,this.$a))}))),this.get_template().domRoot.append(this.$b.domNode),this.viewModel.get_ruleTickCount()>0){var t=$("<div class='tabSliderRule'><\/div>"),u=ss.mkdict(["count",this.viewModel.get_ruleTickCount()]),r=new dijit.form.HorizontalRule(u,t.get(0));t.append(r.domNode);r.startup();this.get_template().domRoot.append(t)}this.$c=!1;this.applyEnabledState()},{$a:function(){this.$b._setValueAttr(this.viewModel.get_sliderCurrentValue())},$8:function(n){this.viewModel.get_enabled()&&ss.isValue(n)&&ss.referenceEquals(n.node,this.$b.sliderHandle)&&(this.$c=!0)},$9:function(n){this.viewModel.get_enabled()&&ss.isValue(n)&&ss.referenceEquals(n.node,this.$b.sliderHandle)&&(this.$c=!1,this.applyChanges(this.viewModel.get_sliderIntermediateValue()))},$7:function(n){this.viewModel.get_enabled()&&(this.viewModel.applyIntermediateChange(n),this.$c||this.applyChanges(this.viewModel.get_sliderIntermediateValue()))},dispose:function(){dojo.unsubscribe(this.$d);dojo.unsubscribe(this.$e);tab.ContinuousSlider.prototype.dispose.call(this)},applyEnabledState:function(){this.$b.setDisabled(!this.viewModel.get_enabled())}}),r=global.tab.DojoWidgetsWeb=ss.mkType(n,"tab.DojoWidgetsWeb"),u=global.tab.LegacyDojoUIWebFactory=ss.mkType(n,"tab.LegacyDojoUIWebFactory",function(){tab.BaseLegacyDojoUIModule.call(this)},{createPageView:function(n){return new tab.PageView(n)},createLegacyQuickFilterDisplayView:function(n){return new tab.LegacyQuickFilterDisplayView(n)},createParameterControlView:function(n){return new tab.ParameterControlView(n)},createContinuousSlider:function(n){return new t(n)}}),i=global.tab.LegacyDojoWidgetMakerWeb=ss.mkType(n,"tab.LegacyDojoWidgetMakerWeb",function(){},{makeCurrentPagePanelWidget:function(n){return new tableau.base.widget.CurrentPagePanel(n)},makeFilterPanelWidget:function(n){return new tableau.base.widget.QuickFilterPanel(n)},makeControlWidget:function(n){return new tableau.base.widget.ParameterControl(n)}});ss.initClass(t,tab.ContinuousSlider,[tab.IWidget,ss.makeGenericType(tab.IView$1,[tab.ContinuousSliderViewModel]),ss.IDisposable,tab.IAppendableView,tab.IContinuousSlider]);ss.initClass(r);ss.initClass(u,tab.BaseLegacyDojoUIModule,[tab.ILegacyDojoUIModule]);ss.initClass(i,null,[tab.ILegacyDojoWidgetMaker]),function(){t.tableauSliderTemplate="<div class='dijit dijitReset'><div class='dijitReset tableauSlider' dojoAttachPoint='tableauSlider'><table class='dijit dijitReset' cellspacing='0' cellpadding='0' border='0' rules='none'><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,topDecoration' class='dijitReset' style='text-align:center;width:100%;'><\/td><td class='dijitReset'><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper' dojoAttachEvent='onclick:_onClkDecBumper'><\/div><\/td><td class='dijitReset'><input dojoAttachPoint='valueNode' type='hidden' name='${name}'><div class='dijitReset dijitSliderBarContainerH' waiRole='presentation' dojoAttachPoint='sliderBarContainer'><div waiRole='presentation' dojoAttachPoint='progressBar' class='dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH' dojoAttachEvent='onclick:_onBarClick'><div class='dijitSliderMoveable dijitSliderMoveableH'><div dojoAttachPoint='sliderHandle,focusNode' class='dijitSliderImageHandle dijitSliderImageHandleH' dojoAttachEvent='onmousedown:_onHandleClick' waiRole='slider' valuemin='${minimum}' valuemax='${maximum}'><\/div><\/div><\/div><div waiRole='presentation' dojoAttachPoint='remainingBar' class='dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH' dojoAttachEvent='onclick:_onBarClick'><\/div><\/div><\/td><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper' dojoAttachEvent='onclick:_onClkIncBumper'><\/div><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,bottomDecoration' class='dijitReset'><\/td><td class='dijitReset'><\/td><\/tr><\/table><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowDec' style='display:none' dojoAttachPoint='decrementButton'><div class='dijitSliderDecrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>-<\/span><\/div><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowInc' style='display:none' dojoAttachPoint='incrementButton'><div class='dijitSliderIncrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>+<\/span><\/div><\/div><\/div>"}(),function(){dojo.addOnLoad(function(){dojo.require("tableau.web.WebClient")})}(),function(){tab.ObjectRegistry.registerType(tab.ILegacyDojoWidgetMaker,i).call(null)}()})();